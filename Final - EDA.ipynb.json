{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import dask\n",
    "import dask.dataframe as dd\n",
    "import sklearn\n",
    "import pickle"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_pickle('iowa_liquor_retail')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 16909195 entries, 0 to 16909194\n",
      "Data columns (total 24 columns):\n",
      "Invoice/Item Number      object\n",
      "Date                     object\n",
      "Store Number             int64\n",
      "Store Name               object\n",
      "Address                  object\n",
      "City                     object\n",
      "Zip Code                 object\n",
      "Store Location           object\n",
      "County Number            float64\n",
      "County                   object\n",
      "Category                 float64\n",
      "Category Name            object\n",
      "Vendor Number            float64\n",
      "Vendor Name              object\n",
      "Item Number              object\n",
      "Item Description         object\n",
      "Pack                     int64\n",
      "Bottle Volume (ml)       int64\n",
      "State Bottle Cost        float64\n",
      "State Bottle Retail      float64\n",
      "Bottles Sold             int64\n",
      "Sale (Dollars)           float64\n",
      "Volume Sold (Liters)     float64\n",
      "Volume Sold (Gallons)    float64\n",
      "dtypes: float64(8), int64(4), object(12)\n",
      "memory usage: 3.0+ GB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "# display only 15 rows of results at maximum in each cell\n",
    "# display all columns in each cell\n",
    "pd.options.display.max_rows = 20\n",
    "pd.set_option('display.max_columns', 50)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### <font color='orange'>Feature Explanation</font>\n",
    "[Original Link to The Dataset](https://data.iowa.gov/Sales-Distribution/Iowa-Liquor-Sales/m3tr-qhgy) <br>\n",
    "[Link to Google Cloud Platform](https://console.cloud.google.com/marketplace/details/iowa-department-of-commerce/iowa-liquor-sales?filter=category:machine-learning&id=18f0a495-8e20-4124-a349-0c4c167b60ab)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<font color='red'>'Invoice/Item Number'</font> - Concatenated invoice and line number associated with the liquor order. This provides a unique identifier for the individual liquor products included in the store order. <br>\n",
    "<font color='red'>'Date'</font> - Date of order. <br>\n",
    "<font color='red'>'Store Number'</font> - Unique number assigned to the store who ordered the liquor. <br>\n",
    "<font color='red'>'Store Name'</font> - Name of store who ordered the liquor. <br>\n",
    "<font color='red'>'Address'</font> - Address of store who ordered the liquor. <br>\n",
    "<font color='red'>'City'</font> - City where the store who ordered the liquor is located. <br>\n",
    "<font color='red'>'Zip Code'</font> - Zip code where the store who ordered the liquor is located. <br>\n",
    "<font color='red'>'Store Location'</font> - Location of store who ordered the liquor. The Address, City, State and Zip Code are geocoded to provide geographic coordinates. Accuracy of geocoding is dependent on how well the address is interpreted and the completeness of the reference data used. <br>\n",
    "<font color='red'>'County Number'</font> - Iowa county number for the county where store who ordered the liquor is located. <br>\n",
    "<font color='red'>'County'</font> - County where the store who ordered the liquor is located. <br>\n",
    "<font color='red'>'Category'</font> - Category code associated with the liquor ordered. <br>\n",
    "<font color='red'>'Category Name'</font> - Category of the liquor ordered. <br>\n",
    "<font color='red'>'Vendor Number'</font> - The vendor number of the company for the brand of liquor ordered. <br>\n",
    "<font color='red'>'Vendor Name'</font> - The vendor name of the company for the brand of liquor ordered. <br>\n",
    "<font color='red'>'Item Number'</font> - Item number for the individual liquor product ordered. <br>\n",
    "<font color='red'>'Item Description'</font> - Description of the individual liquor product ordered.<br>\n",
    "<font color='red'>'Pack'</font> - The number of bottles in a case for the liquor ordered.<br>\n",
    "<font color='red'>'Bottle Volume (ml)'</font> - Volume of each liquor bottle ordered in milliliters.<br>\n",
    "<font color='red'>'State Bottle Cost'</font> - The amount that Alcoholic Beverages Division paid for each bottle of liquor ordered.<br>\n",
    "<font color='red'>'State Bottle Retail'</font> - The amount the store paid for each bottle of liquor ordered.<br>\n",
    "<font color='red'>'Bottles Sold'</font> - The number of bottles of liquor ordered by the store.<br>\n",
    "<font color='red'>'Sale (Dollars)'</font> - Total cost of liquor order (number of bottles multiplied by the state bottle retail).<br>\n",
    "<font color='red'>'Volume Sold (Liters)'</font> - Total volume of liquor ordered in liters. (i.e. (Bottle Volume (ml) x Bottles Sold)/1,000).<br>\n",
    "<font color='red'>'Volume Sold (Gallons)'</font> - Total volume of liquor ordered in gallons. (i.e. (Bottle Volume (ml) x Bottles Sold)/3785.411784).<br>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### <font color='orange'>Data Cleansing</font>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Validate The Calculation\n",
    "Importance about the dataset: some discrenpencies -> sales != state bottle retail*bottles sold.\n",
    "We have discussed this discrepancy with our DBA who manages the data being sent. They found that the Unit volume was sent instead of bottles. Units can be cases, bottles, or sleeves. We are working to append the sales data to reflect actual bottles. Until then please take Sales/state bottle retail= Bottles sold. This new Bottles sold can be used to find the true liters and gallons sold. The data from September 16' to Current 2018 is affected. We will comment an update when the bottles column has been fixed and the data has been appended.\n",
    "\n",
    "\n",
    "In 2016 ABD invested into a new all in one system to keep up with demands in technology and sales. Our products team took this as an opportunity to fix our product categories in the database since they hadn't been updated. Many of the categories where there was only few products or were materially close to another category where combined. In summary the old categories were outdated and needed to be re-assessed at the time by management."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # try to detect any false match between sale(dollars) and state bottle retail*bottles_sold\n",
    "# but the code didn't work as I expected\n",
    "# false_calculation = df[['State Bottle Retail','Sale (Dollars)','Bottles Sold']].assign(Not_Equal = df['Sale (Dollars)'] != df['State Bottle Retail'] * df['Bottles Sold'])\n",
    "# false_calculation.loc[false_calculation['Not_Equal'] == True]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "flt1 = 0.040000000000000009\n",
    "flt2 = 0.040000000000000007\n",
    "~np.isclose(flt1, flt2)\n",
    "~np.isclose(df_dollars, df_retail * df_sold)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Invoice/Item Number</th>\n",
       "      <th>Date</th>\n",
       "      <th>Store Number</th>\n",
       "      <th>Store Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Store Location</th>\n",
       "      <th>County Number</th>\n",
       "      <th>County</th>\n",
       "      <th>Category</th>\n",
       "      <th>Category Name</th>\n",
       "      <th>Vendor Number</th>\n",
       "      <th>Vendor Name</th>\n",
       "      <th>Item Number</th>\n",
       "      <th>Item Description</th>\n",
       "      <th>Pack</th>\n",
       "      <th>Bottle Volume (ml)</th>\n",
       "      <th>State Bottle Cost</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th>Bottles Sold</th>\n",
       "      <th>Sale (Dollars)</th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Volume Sold (Gallons)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>13742</th>\n",
       "      <td>INV-15258000028</td>\n",
       "      <td>10/24/2018</td>\n",
       "      <td>4135</td>\n",
       "      <td>Fareway Stores #925 / Altoona</td>\n",
       "      <td>620 SE 8th St</td>\n",
       "      <td>Altoona</td>\n",
       "      <td>50009</td>\n",
       "      <td>POINT (-93.458606 41.644082000000004)</td>\n",
       "      <td>77.0</td>\n",
       "      <td>POLK</td>\n",
       "      <td>1071100.0</td>\n",
       "      <td>Cocktails /RTD</td>\n",
       "      <td>55.0</td>\n",
       "      <td>SAZERAC NORTH AMERICA</td>\n",
       "      <td>57158</td>\n",
       "      <td>Chi-Chi's Strawberry Margarita W/tequila</td>\n",
       "      <td>6</td>\n",
       "      <td>1750</td>\n",
       "      <td>6.50</td>\n",
       "      <td>9.75</td>\n",
       "      <td>6</td>\n",
       "      <td>55.44</td>\n",
       "      <td>10.5</td>\n",
       "      <td>2.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13745</th>\n",
       "      <td>INV-15106100016</td>\n",
       "      <td>10/17/2018</td>\n",
       "      <td>5135</td>\n",
       "      <td>Fareway Stores #155 / Huxley</td>\n",
       "      <td>911 Hwy 69</td>\n",
       "      <td>Huxley</td>\n",
       "      <td>50124</td>\n",
       "      <td>NaN</td>\n",
       "      <td>85.0</td>\n",
       "      <td>STORY</td>\n",
       "      <td>1011200.0</td>\n",
       "      <td>Straight Bourbon Whiskies</td>\n",
       "      <td>55.0</td>\n",
       "      <td>SAZERAC NORTH AMERICA</td>\n",
       "      <td>21598</td>\n",
       "      <td>Ten High</td>\n",
       "      <td>6</td>\n",
       "      <td>1750</td>\n",
       "      <td>8.58</td>\n",
       "      <td>12.87</td>\n",
       "      <td>6</td>\n",
       "      <td>83.16</td>\n",
       "      <td>10.5</td>\n",
       "      <td>2.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15396</th>\n",
       "      <td>INV-15250100013</td>\n",
       "      <td>10/24/2018</td>\n",
       "      <td>2606</td>\n",
       "      <td>Hy-Vee Wine and Spirits / Humboldt</td>\n",
       "      <td>1011  13th St North</td>\n",
       "      <td>Humboldt</td>\n",
       "      <td>50548</td>\n",
       "      <td>POINT (-94.227116 42.733221)</td>\n",
       "      <td>46.0</td>\n",
       "      <td>HUMBOLDT</td>\n",
       "      <td>1022100.0</td>\n",
       "      <td>Mixto Tequila</td>\n",
       "      <td>434.0</td>\n",
       "      <td>LUXCO INC</td>\n",
       "      <td>89387</td>\n",
       "      <td>Juarez Tequila Gold</td>\n",
       "      <td>12</td>\n",
       "      <td>1000</td>\n",
       "      <td>7.83</td>\n",
       "      <td>11.75</td>\n",
       "      <td>24</td>\n",
       "      <td>288.00</td>\n",
       "      <td>24.0</td>\n",
       "      <td>6.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15400</th>\n",
       "      <td>INV-15321100009</td>\n",
       "      <td>10/29/2018</td>\n",
       "      <td>2539</td>\n",
       "      <td>Hy-Vee Food Store / Iowa Falls</td>\n",
       "      <td>Highway 65 South</td>\n",
       "      <td>Iowa Falls</td>\n",
       "      <td>50126</td>\n",
       "      <td>NaN</td>\n",
       "      <td>42.0</td>\n",
       "      <td>HARDIN</td>\n",
       "      <td>1031100.0</td>\n",
       "      <td>American Vodkas</td>\n",
       "      <td>55.0</td>\n",
       "      <td>SAZERAC NORTH AMERICA</td>\n",
       "      <td>35948</td>\n",
       "      <td>Fleischmann's Royal Vodka 80 Prf</td>\n",
       "      <td>6</td>\n",
       "      <td>1750</td>\n",
       "      <td>7.18</td>\n",
       "      <td>10.77</td>\n",
       "      <td>6</td>\n",
       "      <td>58.68</td>\n",
       "      <td>10.5</td>\n",
       "      <td>2.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16521</th>\n",
       "      <td>INV-15277300011</td>\n",
       "      <td>10/25/2018</td>\n",
       "      <td>4901</td>\n",
       "      <td>Fareway Stores #137 / Polk City</td>\n",
       "      <td>1101 S 5th St</td>\n",
       "      <td>Polk City</td>\n",
       "      <td>50226</td>\n",
       "      <td>POINT (-93.719323 41.763876)</td>\n",
       "      <td>77.0</td>\n",
       "      <td>POLK</td>\n",
       "      <td>1012100.0</td>\n",
       "      <td>Canadian Whiskies</td>\n",
       "      <td>55.0</td>\n",
       "      <td>SAZERAC NORTH AMERICA</td>\n",
       "      <td>12406</td>\n",
       "      <td>Canadian Ltd Whisky</td>\n",
       "      <td>12</td>\n",
       "      <td>750</td>\n",
       "      <td>4.01</td>\n",
       "      <td>6.02</td>\n",
       "      <td>12</td>\n",
       "      <td>78.12</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.37</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Invoice/Item Number        Date  Store Number  \\\n",
       "13742     INV-15258000028  10/24/2018          4135   \n",
       "13745     INV-15106100016  10/17/2018          5135   \n",
       "15396     INV-15250100013  10/24/2018          2606   \n",
       "15400     INV-15321100009  10/29/2018          2539   \n",
       "16521     INV-15277300011  10/25/2018          4901   \n",
       "\n",
       "                               Store Name              Address        City  \\\n",
       "13742       Fareway Stores #925 / Altoona        620 SE 8th St     Altoona   \n",
       "13745        Fareway Stores #155 / Huxley           911 Hwy 69      Huxley   \n",
       "15396  Hy-Vee Wine and Spirits / Humboldt  1011  13th St North    Humboldt   \n",
       "15400      Hy-Vee Food Store / Iowa Falls     Highway 65 South  Iowa Falls   \n",
       "16521     Fareway Stores #137 / Polk City        1101 S 5th St   Polk City   \n",
       "\n",
       "      Zip Code                         Store Location  County Number  \\\n",
       "13742    50009  POINT (-93.458606 41.644082000000004)           77.0   \n",
       "13745    50124                                    NaN           85.0   \n",
       "15396    50548           POINT (-94.227116 42.733221)           46.0   \n",
       "15400    50126                                    NaN           42.0   \n",
       "16521    50226           POINT (-93.719323 41.763876)           77.0   \n",
       "\n",
       "         County   Category              Category Name  Vendor Number  \\\n",
       "13742      POLK  1071100.0             Cocktails /RTD           55.0   \n",
       "13745     STORY  1011200.0  Straight Bourbon Whiskies           55.0   \n",
       "15396  HUMBOLDT  1022100.0              Mixto Tequila          434.0   \n",
       "15400    HARDIN  1031100.0            American Vodkas           55.0   \n",
       "16521      POLK  1012100.0          Canadian Whiskies           55.0   \n",
       "\n",
       "                 Vendor Name Item Number  \\\n",
       "13742  SAZERAC NORTH AMERICA       57158   \n",
       "13745  SAZERAC NORTH AMERICA       21598   \n",
       "15396              LUXCO INC       89387   \n",
       "15400  SAZERAC NORTH AMERICA       35948   \n",
       "16521  SAZERAC NORTH AMERICA       12406   \n",
       "\n",
       "                               Item Description  Pack  Bottle Volume (ml)  \\\n",
       "13742  Chi-Chi's Strawberry Margarita W/tequila     6                1750   \n",
       "13745                                  Ten High     6                1750   \n",
       "15396                       Juarez Tequila Gold    12                1000   \n",
       "15400          Fleischmann's Royal Vodka 80 Prf     6                1750   \n",
       "16521                       Canadian Ltd Whisky    12                 750   \n",
       "\n",
       "       State Bottle Cost  State Bottle Retail  Bottles Sold  Sale (Dollars)  \\\n",
       "13742               6.50                 9.75             6           55.44   \n",
       "13745               8.58                12.87             6           83.16   \n",
       "15396               7.83                11.75            24          288.00   \n",
       "15400               7.18                10.77             6           58.68   \n",
       "16521               4.01                 6.02            12           78.12   \n",
       "\n",
       "       Volume Sold (Liters)  Volume Sold (Gallons)  \n",
       "13742                  10.5                   2.77  \n",
       "13745                  10.5                   2.77  \n",
       "15396                  24.0                   6.34  \n",
       "15400                  10.5                   2.77  \n",
       "16521                   9.0                   2.37  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# try to detect any false match between sale(dollars) and state bottle retail*bottles_sold\n",
    "# from the commets above (originally from Iowa gov data portal), it says that Sales/state bottle retail= Bottles sold\n",
    "# but with the obs I found below, it's not the case...\n",
    "# some are due to missing values of state bottle retail\n",
    "# some sales(dollars)/state bottle retail doesn't appear to be integer (aka bottle sold as the data owner said)\n",
    "# so I will just regard these records for now for time constraint reason\n",
    "df = df.astype({'Sale (Dollars)': np.float64})\n",
    "problem_df = df[df['Sale (Dollars)'] != np.round(df['State Bottle Retail'] * df['Bottles Sold'], 2)]\n",
    "problem_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# for now just remove all the discrepencies\n",
    "# but after the presentation, may come back and work more on cleansing data\n",
    "problem_indices = set(problem_df[['Sale (Dollars)', 'State Bottle Retail', 'Bottles Sold']].index)\n",
    "df = df[~df.index.isin(problem_indices)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.04833637340555853"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# calculate the percentage of problem indices over all data\n",
    "len(problem_indices)/len(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Converting Data Type as Needed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# remove the decimals for columns 'County Number','Category', and 'Vendor Number'\n",
    "# these features should be converted to string type as we won't do any calculation on them\n",
    "df['County Number'] = df['County Number'].astype(str).replace('\\.0', '', regex=True)\n",
    "df['Category'] = df['Category'].astype(str).replace('\\.0', '', regex=True)\n",
    "df['Vendor Number'] = df['Vendor Number'].astype(str).replace('\\.0', '', regex=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "# convert the 'Date' column as datetime and sort the dataframe by date\n",
    "df['Date'] =pd.to_datetime(df.Date, infer_datetime_format=True)\n",
    "df = df.sort_values(by='Date').reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# create new columns for month|quarter|year of the date for sales analysis\n",
    "df['Year_Week'] = df['Date'].dt.to_period('W')\n",
    "df['Year_Month'] = df['Date'].dt.to_period('M')\n",
    "df['Year_Quarter'] = df['Date'].dt.to_period('Q')\n",
    "df['Year'] = df['Date'].dt.to_period('A')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Count of Unique Values of Each Column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Count of Invoice/Item Number is 16129551\n",
      "Count of Date is 1846\n",
      "Count of Store Number is 2244\n",
      "Count of Store Name is 2392\n",
      "Count of Address is 3503\n",
      "Count of City is 825\n",
      "Count of Zip Code is 938\n",
      "Count of Store Location is 1794\n",
      "Count of County Number is 100\n",
      "Count of County is 200\n",
      "Count of Category is 107\n",
      "Count of Category Name is 129\n",
      "Count of Vendor Number is 321\n",
      "Count of Vendor Name is 443\n",
      "Count of Item Number is 10512\n",
      "Count of Item Description is 7535\n",
      "Count of Pack is 27\n",
      "Count of Bottle Volume (ml) is 55\n",
      "Count of State Bottle Cost is 2912\n",
      "Count of State Bottle Retail is 3378\n",
      "Count of Bottles Sold is 527\n",
      "Count of Sale (Dollars) is 26414\n",
      "Count of Volume Sold (Liters) is 1186\n",
      "Count of Volume Sold (Gallons) is 1385\n",
      "Count of Year_Week is 400\n",
      "Count of Year_Month is 92\n",
      "Count of Year_Quarter is 31\n",
      "Count of Year is 8\n"
     ]
    }
   ],
   "source": [
    "def unique_count(dataframe):\n",
    "    for item in dataframe:\n",
    "        print ('Count of', item, 'is', dataframe[item].nunique())\n",
    "\n",
    "unique_count(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Detect Duplicate Rows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The number of duplicate rows is 0\n"
     ]
    }
   ],
   "source": [
    "# check that there are no duplicate rows in dataframe\n",
    "print('The number of duplicate rows is', len(df[df.duplicated(subset=None, keep='first') == True]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Detect Missing Values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# replace missing values or 0s with NaN\n",
    "# df.apply(lambda x: np.nan if x == '' else x)\n",
    "# df.apply(lambda x: np.nan if x == 0.0 else x)\n",
    "\n",
    "for column in df.columns:\n",
    "    df[column] = df[column].apply(lambda x: np.nan if x == '' else x)\n",
    "    df[column] = df[column].apply(lambda x: np.nan if x == 0.0 else x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Count of missing Invoice/Item Number is 0\n",
      "Count of missing Date is 0\n",
      "Count of missing Store Number is 0\n",
      "Count of missing Store Name is 0\n",
      "Count of missing Address is 63010\n",
      "Count of missing City is 63010\n",
      "Count of missing Zip Code is 63055\n",
      "Count of missing Store Location is 1554109\n",
      "Count of missing County Number is 0\n",
      "Count of missing County is 139813\n",
      "Count of missing Category is 0\n",
      "Count of missing Category Name is 22517\n",
      "Count of missing Vendor Number is 0\n",
      "Count of missing Vendor Name is 2\n",
      "Count of missing Item Number is 0\n",
      "Count of missing Item Description is 0\n",
      "Count of missing Pack is 0\n",
      "Count of missing Bottle Volume (ml) is 10\n",
      "Count of missing State Bottle Cost is 3084\n",
      "Count of missing State Bottle Retail is 3084\n",
      "Count of missing Bottles Sold is 1\n",
      "Count of missing Sale (Dollars) is 3085\n",
      "Count of missing Volume Sold (Liters) is 10\n",
      "Count of missing Volume Sold (Gallons) is 77\n",
      "Count of missing Year_Week is 0\n",
      "Count of missing Year_Month is 0\n",
      "Count of missing Year_Quarter is 0\n",
      "Count of missing Year is 0\n"
     ]
    }
   ],
   "source": [
    "# print out # of missing values in each column. Need to decide which column need to remove missing values based on future analysis\n",
    "# for instance, if I want to aggregate data by county, then 'County Name' must not be null\n",
    "def missing_count(dataframe):\n",
    "    for col in dataframe.columns:\n",
    "        print('Count of missing', col, 'is', len(dataframe.loc[dataframe[col].isnull()]))\n",
    "\n",
    "missing_count(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "# there is overlap between missing value rows across columns\n",
    "# create a dict to include each column name with indices of corresponding missing rows\n",
    "# create a set to include all unique index of missing value rows\n",
    "missing_dict = {}\n",
    "missing_set = set()\n",
    "for col in df.columns:\n",
    "    problem_indices = df[df[col].isnull()].index\n",
    "    missing_dict[col] = problem_indices\n",
    "    missing_set.update(problem_indices) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The ratio of missing rows over all rows is 0.102139234997924\n"
     ]
    }
   ],
   "source": [
    "# there is about 10% of rows contain NaN values, I need to provide more analysis to evaluate the impact of dropping NaNs\n",
    "len(missing_set)\n",
    "print('The ratio of missing rows over all rows is', len(missing_set)/len(df))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <font color='red'>Placeholder - Evaluate The Impact of Dropping Missing Values</font>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <font color='red'>Placeholder - Decide If Need to Fill in Missing Values</font>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "# removing all rows with missing values\n",
    "# df_copy = df.copy()\n",
    "df_without_null = df[~df.index.isin(list(missing_set))]\n",
    "df_null = df[df.index.isin(list(missing_set))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pickle the dataframe without nulls for future analysis\n",
    "df_without_null.to_pickle('without_null.pickle')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### <font color='orange'>Explortory Data Analysis</font>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "# reload the df_without_null\n",
    "df_cleaned = pd.read_pickle('without_null.pickle')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "# calculate the markup per bottle, markup per transaction, and markup rate for each item\n",
    "# markup is the difference between 'state bottle cost' and 'state bottle retail', \n",
    "# which is the amount that Iowa state alchoholic beverage division makes per bottle of liquor\n",
    "# markup rate per item is the markup per bottle bdivided by 'state bottle cost'\n",
    "df_cleaned['Markup Per Bottle'] = df_cleaned['State Bottle Retail'] - df_cleaned['State Bottle Cost']\n",
    "df_cleaned['Markup Per Transaction'] = df_cleaned['Markup Per Bottle'] * df_cleaned['Bottles Sold']\n",
    "df_cleaned['Cost Per Transaction'] = df_cleaned['State Bottle Cost'] * df_cleaned['Bottles Sold']\n",
    "df_cleaned['Markup Rate Per Item'] = round(df_cleaned['Markup Per Bottle']/df_cleaned['State Bottle Cost']*100,2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Invoice/Item Number</th>\n",
       "      <th>Date</th>\n",
       "      <th>Store Number</th>\n",
       "      <th>Store Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Store Location</th>\n",
       "      <th>County Number</th>\n",
       "      <th>County</th>\n",
       "      <th>Category</th>\n",
       "      <th>Category Name</th>\n",
       "      <th>Vendor Number</th>\n",
       "      <th>Vendor Name</th>\n",
       "      <th>Item Number</th>\n",
       "      <th>Item Description</th>\n",
       "      <th>Pack</th>\n",
       "      <th>Bottle Volume (ml)</th>\n",
       "      <th>State Bottle Cost</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th>Bottles Sold</th>\n",
       "      <th>Sale (Dollars)</th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Volume Sold (Gallons)</th>\n",
       "      <th>Year_Week</th>\n",
       "      <th>Year_Month</th>\n",
       "      <th>Year_Quarter</th>\n",
       "      <th>Year</th>\n",
       "      <th>Markup Per Bottle</th>\n",
       "      <th>Markup Per Transaction</th>\n",
       "      <th>Cost Per Transaction</th>\n",
       "      <th>Markup Rate Per Item</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>S03389400036</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3521</td>\n",
       "      <td>Ameristar Casino / Council Bluffs</td>\n",
       "      <td>2200 RIVER ROAD</td>\n",
       "      <td>COUNCIL BLUFFS</td>\n",
       "      <td>51501</td>\n",
       "      <td>POINT (-95.909384 41.242291)</td>\n",
       "      <td>78</td>\n",
       "      <td>Pottawattamie</td>\n",
       "      <td>1022100</td>\n",
       "      <td>TEQUILA</td>\n",
       "      <td>434</td>\n",
       "      <td>Luxco-St Louis</td>\n",
       "      <td>89447</td>\n",
       "      <td>La Prima Tequila/gold</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>6.69</td>\n",
       "      <td>10.04</td>\n",
       "      <td>12.0</td>\n",
       "      <td>120.48</td>\n",
       "      <td>12.00</td>\n",
       "      <td>3.17</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.35</td>\n",
       "      <td>40.20</td>\n",
       "      <td>80.28</td>\n",
       "      <td>50.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>S03391800016</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4480</td>\n",
       "      <td>Circle K #6602 / Clinton</td>\n",
       "      <td>1530 NORTH 2ND ST</td>\n",
       "      <td>CLINTON</td>\n",
       "      <td>52732</td>\n",
       "      <td>POINT (-90.183722 41.861892)</td>\n",
       "      <td>23</td>\n",
       "      <td>Clinton</td>\n",
       "      <td>1011200</td>\n",
       "      <td>STRAIGHT BOURBON WHISKIES</td>\n",
       "      <td>65</td>\n",
       "      <td>Jim Beam Brands</td>\n",
       "      <td>19063</td>\n",
       "      <td>Jim Beam</td>\n",
       "      <td>48</td>\n",
       "      <td>200.0</td>\n",
       "      <td>2.85</td>\n",
       "      <td>4.28</td>\n",
       "      <td>6.0</td>\n",
       "      <td>25.68</td>\n",
       "      <td>1.20</td>\n",
       "      <td>0.32</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>1.43</td>\n",
       "      <td>8.58</td>\n",
       "      <td>17.10</td>\n",
       "      <td>50.18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>S03390300066</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3728</td>\n",
       "      <td>Brewski's Beverage</td>\n",
       "      <td>726 CREEK TOP</td>\n",
       "      <td>COUNCIL BLUFFS</td>\n",
       "      <td>51503</td>\n",
       "      <td>POINT (-95.854809 41.262316)</td>\n",
       "      <td>78</td>\n",
       "      <td>Pottawattamie</td>\n",
       "      <td>1062310</td>\n",
       "      <td>SPICED RUM</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>43316</td>\n",
       "      <td>Captain Morgan Private Stock Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>11.45</td>\n",
       "      <td>17.18</td>\n",
       "      <td>2.0</td>\n",
       "      <td>34.36</td>\n",
       "      <td>1.50</td>\n",
       "      <td>0.40</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>5.73</td>\n",
       "      <td>11.46</td>\n",
       "      <td>22.90</td>\n",
       "      <td>50.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>S03403600020</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3744</td>\n",
       "      <td>Payless Foods / Dyersville</td>\n",
       "      <td>733 16TH AVE SE</td>\n",
       "      <td>DYERSVILLE</td>\n",
       "      <td>52040</td>\n",
       "      <td>POINT (-91.115769 42.470204)</td>\n",
       "      <td>31</td>\n",
       "      <td>Dubuque</td>\n",
       "      <td>1031200</td>\n",
       "      <td>VODKA FLAVORED</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>41796</td>\n",
       "      <td>Smirnoff Raspberry Vodka</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>7.59</td>\n",
       "      <td>11.56</td>\n",
       "      <td>2.0</td>\n",
       "      <td>23.12</td>\n",
       "      <td>1.50</td>\n",
       "      <td>0.40</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.97</td>\n",
       "      <td>7.94</td>\n",
       "      <td>15.18</td>\n",
       "      <td>52.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>S03390200046</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4109</td>\n",
       "      <td>Best Trip</td>\n",
       "      <td>1516 SE 1ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50315</td>\n",
       "      <td>POINT (-93.613469 41.57592900000001)</td>\n",
       "      <td>77</td>\n",
       "      <td>Polk</td>\n",
       "      <td>1052010</td>\n",
       "      <td>IMPORTED GRAPE BRANDIES</td>\n",
       "      <td>420</td>\n",
       "      <td>Moet Hennessy USA, Inc.</td>\n",
       "      <td>48104</td>\n",
       "      <td>Hennessy Vs Cognac</td>\n",
       "      <td>24</td>\n",
       "      <td>375.0</td>\n",
       "      <td>8.38</td>\n",
       "      <td>12.58</td>\n",
       "      <td>2.0</td>\n",
       "      <td>25.16</td>\n",
       "      <td>0.75</td>\n",
       "      <td>0.20</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>4.20</td>\n",
       "      <td>8.40</td>\n",
       "      <td>16.76</td>\n",
       "      <td>50.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>S03381400074</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3354</td>\n",
       "      <td>Sam's Club 8238 / Davenport</td>\n",
       "      <td>3845 ELMORE AVE.</td>\n",
       "      <td>DAVENPORT</td>\n",
       "      <td>52807</td>\n",
       "      <td>POINT (-90.527081 41.559731)</td>\n",
       "      <td>82</td>\n",
       "      <td>Scott</td>\n",
       "      <td>1032200</td>\n",
       "      <td>IMPORTED VODKA - MISC</td>\n",
       "      <td>277</td>\n",
       "      <td>Stoli Group</td>\n",
       "      <td>34870</td>\n",
       "      <td>Stoli Razberi (raspberry)</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>12.24</td>\n",
       "      <td>18.37</td>\n",
       "      <td>24.0</td>\n",
       "      <td>440.88</td>\n",
       "      <td>18.00</td>\n",
       "      <td>4.76</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>6.13</td>\n",
       "      <td>147.12</td>\n",
       "      <td>293.76</td>\n",
       "      <td>50.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>S03389000062</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3583</td>\n",
       "      <td>Mac's Liquor And Videos</td>\n",
       "      <td>220 EAST JEFFERSON</td>\n",
       "      <td>CORYDON</td>\n",
       "      <td>50060</td>\n",
       "      <td>POINT (-93.315977 40.757158)</td>\n",
       "      <td>93</td>\n",
       "      <td>Wayne</td>\n",
       "      <td>1062200</td>\n",
       "      <td>PUERTO RICO &amp; VIRGIN ISLANDS RUM</td>\n",
       "      <td>434</td>\n",
       "      <td>Luxco-St Louis</td>\n",
       "      <td>45277</td>\n",
       "      <td>Paramount White Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>4.33</td>\n",
       "      <td>6.50</td>\n",
       "      <td>2.0</td>\n",
       "      <td>13.00</td>\n",
       "      <td>2.00</td>\n",
       "      <td>0.53</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>2.17</td>\n",
       "      <td>4.34</td>\n",
       "      <td>8.66</td>\n",
       "      <td>50.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>S03412100096</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>2603</td>\n",
       "      <td>Hy-Vee Wine and Spirits / Bettendorf</td>\n",
       "      <td>2890 DEVILS GLEN ROAD</td>\n",
       "      <td>BETTENDORF</td>\n",
       "      <td>52722</td>\n",
       "      <td>POINT (-90.483701 41.552338)</td>\n",
       "      <td>82</td>\n",
       "      <td>Scott</td>\n",
       "      <td>1071100</td>\n",
       "      <td>AMERICAN COCKTAILS</td>\n",
       "      <td>395</td>\n",
       "      <td>Proximo</td>\n",
       "      <td>58875</td>\n",
       "      <td>Jose Cuervo Golden Margarita</td>\n",
       "      <td>6</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>15.24</td>\n",
       "      <td>6.0</td>\n",
       "      <td>91.44</td>\n",
       "      <td>10.50</td>\n",
       "      <td>2.77</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>5.24</td>\n",
       "      <td>31.44</td>\n",
       "      <td>60.00</td>\n",
       "      <td>52.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>S03402900051</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>2591</td>\n",
       "      <td>Hy-Vee Wine and Spirits / Atlantic</td>\n",
       "      <td>1602 E. 7TH ST.</td>\n",
       "      <td>ATLANTIC</td>\n",
       "      <td>50022</td>\n",
       "      <td>POINT (-94.990031 41.403856)</td>\n",
       "      <td>15</td>\n",
       "      <td>Cass</td>\n",
       "      <td>1081330</td>\n",
       "      <td>PEACH SCHNAPPS</td>\n",
       "      <td>434</td>\n",
       "      <td>Luxco-St Louis</td>\n",
       "      <td>82127</td>\n",
       "      <td>Arrow Peach Schnapps</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>4.61</td>\n",
       "      <td>6.92</td>\n",
       "      <td>2.0</td>\n",
       "      <td>13.84</td>\n",
       "      <td>2.00</td>\n",
       "      <td>0.53</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>2.31</td>\n",
       "      <td>4.62</td>\n",
       "      <td>9.22</td>\n",
       "      <td>50.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>S03402100032</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>2651</td>\n",
       "      <td>Hy-Vee / Waverly</td>\n",
       "      <td>1311 4 STREET SW</td>\n",
       "      <td>WAVERLY</td>\n",
       "      <td>50677</td>\n",
       "      <td>POINT (-92.475403 42.712263)</td>\n",
       "      <td>9</td>\n",
       "      <td>Bremer</td>\n",
       "      <td>1071100</td>\n",
       "      <td>AMERICAN COCKTAILS</td>\n",
       "      <td>395</td>\n",
       "      <td>Proximo</td>\n",
       "      <td>58875</td>\n",
       "      <td>Jose Cuervo Golden Margarita</td>\n",
       "      <td>6</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>15.24</td>\n",
       "      <td>6.0</td>\n",
       "      <td>91.44</td>\n",
       "      <td>10.50</td>\n",
       "      <td>2.77</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>5.24</td>\n",
       "      <td>31.44</td>\n",
       "      <td>60.00</td>\n",
       "      <td>52.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129528</th>\n",
       "      <td>INV-21620500033</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>3461</td>\n",
       "      <td>Hometown Foods / Stuart</td>\n",
       "      <td>607 S Division St</td>\n",
       "      <td>Stuart</td>\n",
       "      <td>50250</td>\n",
       "      <td>POINT (-94.318439 41.497693)</td>\n",
       "      <td>39</td>\n",
       "      <td>GUTHRIE</td>\n",
       "      <td>1081600</td>\n",
       "      <td>Whiskey Liqueur</td>\n",
       "      <td>421</td>\n",
       "      <td>SAZERAC COMPANY  INC</td>\n",
       "      <td>64864</td>\n",
       "      <td>Fireball Cinnamon Whisky</td>\n",
       "      <td>24</td>\n",
       "      <td>375.0</td>\n",
       "      <td>5.33</td>\n",
       "      <td>8.00</td>\n",
       "      <td>3.0</td>\n",
       "      <td>24.00</td>\n",
       "      <td>1.12</td>\n",
       "      <td>0.29</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>2.67</td>\n",
       "      <td>8.01</td>\n",
       "      <td>15.99</td>\n",
       "      <td>50.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129531</th>\n",
       "      <td>INV-21623100026</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>5077</td>\n",
       "      <td>Wal-Mart 3150 / Council Bluffs</td>\n",
       "      <td>1800 N 16th St</td>\n",
       "      <td>Council Bluffs</td>\n",
       "      <td>51501</td>\n",
       "      <td>POINT (-95.867459 41.27737)</td>\n",
       "      <td>78</td>\n",
       "      <td>POTTAWATTA</td>\n",
       "      <td>1031100</td>\n",
       "      <td>American Vodkas</td>\n",
       "      <td>260</td>\n",
       "      <td>DIAGEO AMERICAS</td>\n",
       "      <td>37997</td>\n",
       "      <td>Smirnoff 80prf</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>9.25</td>\n",
       "      <td>13.88</td>\n",
       "      <td>12.0</td>\n",
       "      <td>166.56</td>\n",
       "      <td>12.00</td>\n",
       "      <td>3.17</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>4.63</td>\n",
       "      <td>55.56</td>\n",
       "      <td>111.00</td>\n",
       "      <td>50.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129533</th>\n",
       "      <td>INV-21609600027</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>2618</td>\n",
       "      <td>Hy-Vee Drugstore #6 / Cedar Rapids</td>\n",
       "      <td>505 Boyson Rd NE</td>\n",
       "      <td>Cedar Rapids</td>\n",
       "      <td>52402</td>\n",
       "      <td>POINT (-91.63913 42.04671)</td>\n",
       "      <td>57</td>\n",
       "      <td>LINN</td>\n",
       "      <td>1032100</td>\n",
       "      <td>Imported Vodkas</td>\n",
       "      <td>370</td>\n",
       "      <td>PERNOD RICARD USA</td>\n",
       "      <td>34006</td>\n",
       "      <td>Absolut Swedish Vodka 80prf</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>11.49</td>\n",
       "      <td>17.24</td>\n",
       "      <td>12.0</td>\n",
       "      <td>206.88</td>\n",
       "      <td>9.00</td>\n",
       "      <td>2.37</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>5.75</td>\n",
       "      <td>69.00</td>\n",
       "      <td>137.88</td>\n",
       "      <td>50.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129534</th>\n",
       "      <td>INV-21610200109</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>5236</td>\n",
       "      <td>Giggle Juice Liquor Station, LLC</td>\n",
       "      <td>600 W Main St</td>\n",
       "      <td>Anamosa</td>\n",
       "      <td>52205</td>\n",
       "      <td>POINT (-91.29083400000002 42.108203)</td>\n",
       "      <td>53</td>\n",
       "      <td>JONES</td>\n",
       "      <td>1041100</td>\n",
       "      <td>American Dry Gins</td>\n",
       "      <td>469</td>\n",
       "      <td>TY KU LLC</td>\n",
       "      <td>29119</td>\n",
       "      <td>Aviation American Gin</td>\n",
       "      <td>6</td>\n",
       "      <td>750.0</td>\n",
       "      <td>14.17</td>\n",
       "      <td>21.26</td>\n",
       "      <td>1.0</td>\n",
       "      <td>21.26</td>\n",
       "      <td>0.75</td>\n",
       "      <td>0.19</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>7.09</td>\n",
       "      <td>7.09</td>\n",
       "      <td>14.17</td>\n",
       "      <td>50.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129536</th>\n",
       "      <td>INV-21595700026</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>5471</td>\n",
       "      <td>World Liquor &amp; Tobacco + Vapors</td>\n",
       "      <td>1030 8th St</td>\n",
       "      <td>Boone</td>\n",
       "      <td>50036</td>\n",
       "      <td>POINT (-93.876918 42.063831)</td>\n",
       "      <td>8</td>\n",
       "      <td>BOONE</td>\n",
       "      <td>1701100</td>\n",
       "      <td>Temporary &amp; Specialty Packages</td>\n",
       "      <td>259</td>\n",
       "      <td>Heaven Hill Brands</td>\n",
       "      <td>80145</td>\n",
       "      <td>Fulton's Harvest Pumpkin Liqueur</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>5.43</td>\n",
       "      <td>8.15</td>\n",
       "      <td>3.0</td>\n",
       "      <td>24.45</td>\n",
       "      <td>2.25</td>\n",
       "      <td>0.59</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>2.72</td>\n",
       "      <td>8.16</td>\n",
       "      <td>16.29</td>\n",
       "      <td>50.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129537</th>\n",
       "      <td>INV-21618900029</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>3679</td>\n",
       "      <td>FRANKLIN STREET FLORAL &amp; GIFT</td>\n",
       "      <td>103 Franklin St</td>\n",
       "      <td>Monona</td>\n",
       "      <td>52159</td>\n",
       "      <td>POINT (-91.390767 43.055133)</td>\n",
       "      <td>22</td>\n",
       "      <td>CLAYTON</td>\n",
       "      <td>1012100</td>\n",
       "      <td>Canadian Whiskies</td>\n",
       "      <td>421</td>\n",
       "      <td>SAZERAC COMPANY  INC</td>\n",
       "      <td>11347</td>\n",
       "      <td>Seagrams VO Canadian Whiskey</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>9.99</td>\n",
       "      <td>14.99</td>\n",
       "      <td>2.0</td>\n",
       "      <td>29.98</td>\n",
       "      <td>2.00</td>\n",
       "      <td>0.52</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>5.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>19.98</td>\n",
       "      <td>50.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129538</th>\n",
       "      <td>INV-21599700006</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>5108</td>\n",
       "      <td>Tobacco 4 Less / State St</td>\n",
       "      <td>1032 State St</td>\n",
       "      <td>Bettendorf</td>\n",
       "      <td>52722</td>\n",
       "      <td>POINT (-90.518562 41.5251)</td>\n",
       "      <td>82</td>\n",
       "      <td>SCOTT</td>\n",
       "      <td>1011100</td>\n",
       "      <td>Blended Whiskies</td>\n",
       "      <td>65</td>\n",
       "      <td>Jim Beam Brands</td>\n",
       "      <td>24466</td>\n",
       "      <td>Kessler Blend Whiskey Traveler</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>5.51</td>\n",
       "      <td>8.27</td>\n",
       "      <td>24.0</td>\n",
       "      <td>198.48</td>\n",
       "      <td>18.00</td>\n",
       "      <td>4.75</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>2.76</td>\n",
       "      <td>66.24</td>\n",
       "      <td>132.24</td>\n",
       "      <td>50.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129542</th>\n",
       "      <td>INV-21593900008</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>4478</td>\n",
       "      <td>U S Gas</td>\n",
       "      <td>3000 SW 9th St</td>\n",
       "      <td>Des Moines</td>\n",
       "      <td>50315</td>\n",
       "      <td>POINT (-93.625682 41.557862)</td>\n",
       "      <td>77</td>\n",
       "      <td>POLK</td>\n",
       "      <td>1012100</td>\n",
       "      <td>Canadian Whiskies</td>\n",
       "      <td>115</td>\n",
       "      <td>CONSTELLATION BRANDS INC</td>\n",
       "      <td>11774</td>\n",
       "      <td>Black Velvet</td>\n",
       "      <td>24</td>\n",
       "      <td>375.0</td>\n",
       "      <td>3.07</td>\n",
       "      <td>4.61</td>\n",
       "      <td>24.0</td>\n",
       "      <td>110.64</td>\n",
       "      <td>9.00</td>\n",
       "      <td>2.37</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>1.54</td>\n",
       "      <td>36.96</td>\n",
       "      <td>73.68</td>\n",
       "      <td>50.16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129544</th>\n",
       "      <td>INV-21591500037</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>5843</td>\n",
       "      <td>Leaf Brothers Cigars / WDM</td>\n",
       "      <td>9500 University Ave  #1101</td>\n",
       "      <td>West Des Moines</td>\n",
       "      <td>50266</td>\n",
       "      <td>POINT (-93.839693 41.600235)</td>\n",
       "      <td>25</td>\n",
       "      <td>Dallas</td>\n",
       "      <td>1011200</td>\n",
       "      <td>Straight Bourbon Whiskies</td>\n",
       "      <td>85</td>\n",
       "      <td>Brown Forman Corp.</td>\n",
       "      <td>22215</td>\n",
       "      <td>Woodford Reserve</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>22.49</td>\n",
       "      <td>33.74</td>\n",
       "      <td>1.0</td>\n",
       "      <td>33.74</td>\n",
       "      <td>0.75</td>\n",
       "      <td>0.19</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>11.25</td>\n",
       "      <td>11.25</td>\n",
       "      <td>22.49</td>\n",
       "      <td>50.02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16129549</th>\n",
       "      <td>INV-21597800011</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>4450</td>\n",
       "      <td>Kum &amp; Go #157 / Urbandale</td>\n",
       "      <td>4585 156th St</td>\n",
       "      <td>Urbandale</td>\n",
       "      <td>50323</td>\n",
       "      <td>POINT (-93.833463 41.643162)</td>\n",
       "      <td>77</td>\n",
       "      <td>POLK</td>\n",
       "      <td>1031100</td>\n",
       "      <td>American Vodkas</td>\n",
       "      <td>434</td>\n",
       "      <td>LUXCO INC</td>\n",
       "      <td>36301</td>\n",
       "      <td>Hawkeye Vodka Mini</td>\n",
       "      <td>12</td>\n",
       "      <td>50.0</td>\n",
       "      <td>4.13</td>\n",
       "      <td>6.20</td>\n",
       "      <td>2.0</td>\n",
       "      <td>12.40</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.02</td>\n",
       "      <td>2019-08-26/2019-09-01</td>\n",
       "      <td>2019-08</td>\n",
       "      <td>2019Q3</td>\n",
       "      <td>2019</td>\n",
       "      <td>2.07</td>\n",
       "      <td>4.14</td>\n",
       "      <td>8.26</td>\n",
       "      <td>50.12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6017321 rows  32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Invoice/Item Number       Date  Store Number  \\\n",
       "6               S03389400036 2012-01-03          3521   \n",
       "19              S03391800016 2012-01-03          4480   \n",
       "22              S03390300066 2012-01-03          3728   \n",
       "24              S03403600020 2012-01-03          3744   \n",
       "26              S03390200046 2012-01-03          4109   \n",
       "29              S03381400074 2012-01-03          3354   \n",
       "33              S03389000062 2012-01-03          3583   \n",
       "34              S03412100096 2012-01-03          2603   \n",
       "38              S03402900051 2012-01-03          2591   \n",
       "40              S03402100032 2012-01-03          2651   \n",
       "...                      ...        ...           ...   \n",
       "16129528     INV-21620500033 2019-08-30          3461   \n",
       "16129531     INV-21623100026 2019-08-30          5077   \n",
       "16129533     INV-21609600027 2019-08-30          2618   \n",
       "16129534     INV-21610200109 2019-08-30          5236   \n",
       "16129536     INV-21595700026 2019-08-30          5471   \n",
       "16129537     INV-21618900029 2019-08-30          3679   \n",
       "16129538     INV-21599700006 2019-08-30          5108   \n",
       "16129542     INV-21593900008 2019-08-30          4478   \n",
       "16129544     INV-21591500037 2019-08-30          5843   \n",
       "16129549     INV-21597800011 2019-08-30          4450   \n",
       "\n",
       "                                    Store Name                     Address  \\\n",
       "6            Ameristar Casino / Council Bluffs             2200 RIVER ROAD   \n",
       "19                    Circle K #6602 / Clinton           1530 NORTH 2ND ST   \n",
       "22                          Brewski's Beverage               726 CREEK TOP   \n",
       "24                  Payless Foods / Dyersville             733 16TH AVE SE   \n",
       "26                                   Best Trip                 1516 SE 1ST   \n",
       "29                 Sam's Club 8238 / Davenport            3845 ELMORE AVE.   \n",
       "33                     Mac's Liquor And Videos          220 EAST JEFFERSON   \n",
       "34        Hy-Vee Wine and Spirits / Bettendorf       2890 DEVILS GLEN ROAD   \n",
       "38          Hy-Vee Wine and Spirits / Atlantic             1602 E. 7TH ST.   \n",
       "40                            Hy-Vee / Waverly            1311 4 STREET SW   \n",
       "...                                        ...                         ...   \n",
       "16129528               Hometown Foods / Stuart           607 S Division St   \n",
       "16129531        Wal-Mart 3150 / Council Bluffs              1800 N 16th St   \n",
       "16129533    Hy-Vee Drugstore #6 / Cedar Rapids            505 Boyson Rd NE   \n",
       "16129534      Giggle Juice Liquor Station, LLC               600 W Main St   \n",
       "16129536       World Liquor & Tobacco + Vapors                 1030 8th St   \n",
       "16129537         FRANKLIN STREET FLORAL & GIFT             103 Franklin St   \n",
       "16129538             Tobacco 4 Less / State St               1032 State St   \n",
       "16129542                               U S Gas              3000 SW 9th St   \n",
       "16129544            Leaf Brothers Cigars / WDM  9500 University Ave  #1101   \n",
       "16129549             Kum & Go #157 / Urbandale               4585 156th St   \n",
       "\n",
       "                     City Zip Code                        Store Location  \\\n",
       "6          COUNCIL BLUFFS    51501          POINT (-95.909384 41.242291)   \n",
       "19                CLINTON    52732          POINT (-90.183722 41.861892)   \n",
       "22         COUNCIL BLUFFS    51503          POINT (-95.854809 41.262316)   \n",
       "24             DYERSVILLE    52040          POINT (-91.115769 42.470204)   \n",
       "26             DES MOINES    50315  POINT (-93.613469 41.57592900000001)   \n",
       "29              DAVENPORT    52807          POINT (-90.527081 41.559731)   \n",
       "33                CORYDON    50060          POINT (-93.315977 40.757158)   \n",
       "34             BETTENDORF    52722          POINT (-90.483701 41.552338)   \n",
       "38               ATLANTIC    50022          POINT (-94.990031 41.403856)   \n",
       "40                WAVERLY    50677          POINT (-92.475403 42.712263)   \n",
       "...                   ...      ...                                   ...   \n",
       "16129528           Stuart    50250          POINT (-94.318439 41.497693)   \n",
       "16129531   Council Bluffs    51501           POINT (-95.867459 41.27737)   \n",
       "16129533     Cedar Rapids    52402            POINT (-91.63913 42.04671)   \n",
       "16129534          Anamosa    52205  POINT (-91.29083400000002 42.108203)   \n",
       "16129536            Boone    50036          POINT (-93.876918 42.063831)   \n",
       "16129537           Monona    52159          POINT (-91.390767 43.055133)   \n",
       "16129538       Bettendorf    52722            POINT (-90.518562 41.5251)   \n",
       "16129542       Des Moines    50315          POINT (-93.625682 41.557862)   \n",
       "16129544  West Des Moines    50266          POINT (-93.839693 41.600235)   \n",
       "16129549        Urbandale    50323          POINT (-93.833463 41.643162)   \n",
       "\n",
       "         County Number         County Category  \\\n",
       "6                   78  Pottawattamie  1022100   \n",
       "19                  23        Clinton  1011200   \n",
       "22                  78  Pottawattamie  1062310   \n",
       "24                  31        Dubuque  1031200   \n",
       "26                  77           Polk  1052010   \n",
       "29                  82          Scott  1032200   \n",
       "33                  93          Wayne  1062200   \n",
       "34                  82          Scott  1071100   \n",
       "38                  15           Cass  1081330   \n",
       "40                   9         Bremer  1071100   \n",
       "...                ...            ...      ...   \n",
       "16129528            39        GUTHRIE  1081600   \n",
       "16129531            78     POTTAWATTA  1031100   \n",
       "16129533            57           LINN  1032100   \n",
       "16129534            53          JONES  1041100   \n",
       "16129536             8          BOONE  1701100   \n",
       "16129537            22        CLAYTON  1012100   \n",
       "16129538            82          SCOTT  1011100   \n",
       "16129542            77           POLK  1012100   \n",
       "16129544            25         Dallas  1011200   \n",
       "16129549            77           POLK  1031100   \n",
       "\n",
       "                             Category Name Vendor Number  \\\n",
       "6                                  TEQUILA           434   \n",
       "19               STRAIGHT BOURBON WHISKIES            65   \n",
       "22                              SPICED RUM           260   \n",
       "24                          VODKA FLAVORED           260   \n",
       "26                 IMPORTED GRAPE BRANDIES           420   \n",
       "29                   IMPORTED VODKA - MISC           277   \n",
       "33        PUERTO RICO & VIRGIN ISLANDS RUM           434   \n",
       "34                      AMERICAN COCKTAILS           395   \n",
       "38                          PEACH SCHNAPPS           434   \n",
       "40                      AMERICAN COCKTAILS           395   \n",
       "...                                    ...           ...   \n",
       "16129528                   Whiskey Liqueur           421   \n",
       "16129531                   American Vodkas           260   \n",
       "16129533                   Imported Vodkas           370   \n",
       "16129534                 American Dry Gins           469   \n",
       "16129536    Temporary & Specialty Packages           259   \n",
       "16129537                 Canadian Whiskies           421   \n",
       "16129538                  Blended Whiskies            65   \n",
       "16129542                 Canadian Whiskies           115   \n",
       "16129544         Straight Bourbon Whiskies            85   \n",
       "16129549                   American Vodkas           434   \n",
       "\n",
       "                       Vendor Name Item Number  \\\n",
       "6                   Luxco-St Louis       89447   \n",
       "19                 Jim Beam Brands       19063   \n",
       "22                 Diageo Americas       43316   \n",
       "24                 Diageo Americas       41796   \n",
       "26         Moet Hennessy USA, Inc.       48104   \n",
       "29                     Stoli Group       34870   \n",
       "33                  Luxco-St Louis       45277   \n",
       "34                         Proximo       58875   \n",
       "38                  Luxco-St Louis       82127   \n",
       "40                         Proximo       58875   \n",
       "...                            ...         ...   \n",
       "16129528      SAZERAC COMPANY  INC       64864   \n",
       "16129531           DIAGEO AMERICAS       37997   \n",
       "16129533         PERNOD RICARD USA       34006   \n",
       "16129534                 TY KU LLC       29119   \n",
       "16129536        Heaven Hill Brands       80145   \n",
       "16129537      SAZERAC COMPANY  INC       11347   \n",
       "16129538           Jim Beam Brands       24466   \n",
       "16129542  CONSTELLATION BRANDS INC       11774   \n",
       "16129544        Brown Forman Corp.       22215   \n",
       "16129549                 LUXCO INC       36301   \n",
       "\n",
       "                          Item Description  Pack  Bottle Volume (ml)  \\\n",
       "6                    La Prima Tequila/gold    12              1000.0   \n",
       "19                                Jim Beam    48               200.0   \n",
       "22        Captain Morgan Private Stock Rum    12               750.0   \n",
       "24                Smirnoff Raspberry Vodka    12               750.0   \n",
       "26                      Hennessy Vs Cognac    24               375.0   \n",
       "29               Stoli Razberi (raspberry)    12               750.0   \n",
       "33                     Paramount White Rum    12              1000.0   \n",
       "34            Jose Cuervo Golden Margarita     6              1750.0   \n",
       "38                    Arrow Peach Schnapps    12              1000.0   \n",
       "40            Jose Cuervo Golden Margarita     6              1750.0   \n",
       "...                                    ...   ...                 ...   \n",
       "16129528          Fireball Cinnamon Whisky    24               375.0   \n",
       "16129531                    Smirnoff 80prf    12              1000.0   \n",
       "16129533       Absolut Swedish Vodka 80prf    12               750.0   \n",
       "16129534             Aviation American Gin     6               750.0   \n",
       "16129536  Fulton's Harvest Pumpkin Liqueur    12               750.0   \n",
       "16129537      Seagrams VO Canadian Whiskey    12              1000.0   \n",
       "16129538    Kessler Blend Whiskey Traveler    12               750.0   \n",
       "16129542                      Black Velvet    24               375.0   \n",
       "16129544                  Woodford Reserve    12               750.0   \n",
       "16129549                Hawkeye Vodka Mini    12                50.0   \n",
       "\n",
       "          State Bottle Cost  State Bottle Retail  Bottles Sold  \\\n",
       "6                      6.69                10.04          12.0   \n",
       "19                     2.85                 4.28           6.0   \n",
       "22                    11.45                17.18           2.0   \n",
       "24                     7.59                11.56           2.0   \n",
       "26                     8.38                12.58           2.0   \n",
       "29                    12.24                18.37          24.0   \n",
       "33                     4.33                 6.50           2.0   \n",
       "34                    10.00                15.24           6.0   \n",
       "38                     4.61                 6.92           2.0   \n",
       "40                    10.00                15.24           6.0   \n",
       "...                     ...                  ...           ...   \n",
       "16129528               5.33                 8.00           3.0   \n",
       "16129531               9.25                13.88          12.0   \n",
       "16129533              11.49                17.24          12.0   \n",
       "16129534              14.17                21.26           1.0   \n",
       "16129536               5.43                 8.15           3.0   \n",
       "16129537               9.99                14.99           2.0   \n",
       "16129538               5.51                 8.27          24.0   \n",
       "16129542               3.07                 4.61          24.0   \n",
       "16129544              22.49                33.74           1.0   \n",
       "16129549               4.13                 6.20           2.0   \n",
       "\n",
       "          Sale (Dollars)  Volume Sold (Liters)  Volume Sold (Gallons)  \\\n",
       "6                 120.48                 12.00                   3.17   \n",
       "19                 25.68                  1.20                   0.32   \n",
       "22                 34.36                  1.50                   0.40   \n",
       "24                 23.12                  1.50                   0.40   \n",
       "26                 25.16                  0.75                   0.20   \n",
       "29                440.88                 18.00                   4.76   \n",
       "33                 13.00                  2.00                   0.53   \n",
       "34                 91.44                 10.50                   2.77   \n",
       "38                 13.84                  2.00                   0.53   \n",
       "40                 91.44                 10.50                   2.77   \n",
       "...                  ...                   ...                    ...   \n",
       "16129528           24.00                  1.12                   0.29   \n",
       "16129531          166.56                 12.00                   3.17   \n",
       "16129533          206.88                  9.00                   2.37   \n",
       "16129534           21.26                  0.75                   0.19   \n",
       "16129536           24.45                  2.25                   0.59   \n",
       "16129537           29.98                  2.00                   0.52   \n",
       "16129538          198.48                 18.00                   4.75   \n",
       "16129542          110.64                  9.00                   2.37   \n",
       "16129544           33.74                  0.75                   0.19   \n",
       "16129549           12.40                  0.10                   0.02   \n",
       "\n",
       "                      Year_Week Year_Month Year_Quarter  Year  \\\n",
       "6         2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "19        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "22        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "24        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "26        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "29        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "33        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "34        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "38        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "40        2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "...                         ...        ...          ...   ...   \n",
       "16129528  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129531  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129533  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129534  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129536  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129537  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129538  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129542  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129544  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "16129549  2019-08-26/2019-09-01    2019-08       2019Q3  2019   \n",
       "\n",
       "          Markup Per Bottle  Markup Per Transaction  Cost Per Transaction  \\\n",
       "6                      3.35                   40.20                 80.28   \n",
       "19                     1.43                    8.58                 17.10   \n",
       "22                     5.73                   11.46                 22.90   \n",
       "24                     3.97                    7.94                 15.18   \n",
       "26                     4.20                    8.40                 16.76   \n",
       "29                     6.13                  147.12                293.76   \n",
       "33                     2.17                    4.34                  8.66   \n",
       "34                     5.24                   31.44                 60.00   \n",
       "38                     2.31                    4.62                  9.22   \n",
       "40                     5.24                   31.44                 60.00   \n",
       "...                     ...                     ...                   ...   \n",
       "16129528               2.67                    8.01                 15.99   \n",
       "16129531               4.63                   55.56                111.00   \n",
       "16129533               5.75                   69.00                137.88   \n",
       "16129534               7.09                    7.09                 14.17   \n",
       "16129536               2.72                    8.16                 16.29   \n",
       "16129537               5.00                   10.00                 19.98   \n",
       "16129538               2.76                   66.24                132.24   \n",
       "16129542               1.54                   36.96                 73.68   \n",
       "16129544              11.25                   11.25                 22.49   \n",
       "16129549               2.07                    4.14                  8.26   \n",
       "\n",
       "          Markup Rate Per Item  \n",
       "6                        50.07  \n",
       "19                       50.18  \n",
       "22                       50.04  \n",
       "24                       52.31  \n",
       "26                       50.12  \n",
       "29                       50.08  \n",
       "33                       50.12  \n",
       "34                       52.40  \n",
       "38                       50.11  \n",
       "40                       52.40  \n",
       "...                        ...  \n",
       "16129528                 50.09  \n",
       "16129531                 50.05  \n",
       "16129533                 50.04  \n",
       "16129534                 50.04  \n",
       "16129536                 50.09  \n",
       "16129537                 50.05  \n",
       "16129538                 50.09  \n",
       "16129542                 50.16  \n",
       "16129544                 50.02  \n",
       "16129549                 50.12  \n",
       "\n",
       "[6017321 rows x 32 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# take a quick look at transactions where the markup rate is higher than 50%\n",
    "# these types of liquors are more profitable\n",
    "df_cleaned.loc[df_cleaned['Markup Rate Per Item'] > 50]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "If the number of unique county names match the number of unique county number? -  False\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "['adair',\n",
       " 'adams',\n",
       " 'allamakee',\n",
       " 'appanoose',\n",
       " 'audubon',\n",
       " 'benton',\n",
       " 'black hawk',\n",
       " 'boone',\n",
       " 'bremer',\n",
       " 'buchanan',\n",
       " 'buena vist',\n",
       " 'buena vista',\n",
       " 'butler',\n",
       " 'calhoun',\n",
       " 'carroll',\n",
       " 'cass',\n",
       " 'cedar',\n",
       " 'cerro gord',\n",
       " 'cerro gordo',\n",
       " 'cherokee',\n",
       " 'chickasaw',\n",
       " 'clarke',\n",
       " 'clay',\n",
       " 'clayton',\n",
       " 'clinton',\n",
       " 'crawford',\n",
       " 'dallas',\n",
       " 'davis',\n",
       " 'decatur',\n",
       " 'delaware',\n",
       " 'des moines',\n",
       " 'dickinson',\n",
       " 'dubuque',\n",
       " 'emmet',\n",
       " 'fayette',\n",
       " 'floyd',\n",
       " 'franklin',\n",
       " 'fremont',\n",
       " 'greene',\n",
       " 'grundy',\n",
       " 'guthrie',\n",
       " 'hamilton',\n",
       " 'hancock',\n",
       " 'hardin',\n",
       " 'harrison',\n",
       " 'henry',\n",
       " 'howard',\n",
       " 'humboldt',\n",
       " 'ida',\n",
       " 'iowa',\n",
       " 'jackson',\n",
       " 'jasper',\n",
       " 'jefferson',\n",
       " 'johnson',\n",
       " 'jones',\n",
       " 'keokuk',\n",
       " 'kossuth',\n",
       " 'lee',\n",
       " 'linn',\n",
       " 'louisa',\n",
       " 'lucas',\n",
       " 'lyon',\n",
       " 'madison',\n",
       " 'mahaska',\n",
       " 'marion',\n",
       " 'marshall',\n",
       " 'mills',\n",
       " 'mitchell',\n",
       " 'monona',\n",
       " 'monroe',\n",
       " 'montgomery',\n",
       " 'muscatine',\n",
       " \"o'brien\",\n",
       " 'obrien',\n",
       " 'osceola',\n",
       " 'page',\n",
       " 'palo alto',\n",
       " 'plymouth',\n",
       " 'pocahontas',\n",
       " 'polk',\n",
       " 'pottawatta',\n",
       " 'pottawattamie',\n",
       " 'poweshiek',\n",
       " 'ringgold',\n",
       " 'sac',\n",
       " 'scott',\n",
       " 'shelby',\n",
       " 'sioux',\n",
       " 'story',\n",
       " 'tama',\n",
       " 'taylor',\n",
       " 'union',\n",
       " 'van buren',\n",
       " 'wapello',\n",
       " 'warren',\n",
       " 'washington',\n",
       " 'wayne',\n",
       " 'webster',\n",
       " 'winnebago',\n",
       " 'winneshiek',\n",
       " 'woodbury',\n",
       " 'worth',\n",
       " 'wright']"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# try to find the # of obs of which the unique county names and unique county number don't match\n",
    "# then need to clean up the data for the county column\n",
    "print('If the number of unique county names match the number of unique county number? - ', df_cleaned['County Number'].nunique() == df_cleaned['County'].nunique())\n",
    "df_cleaned['County'] = df_cleaned['County'].str.lower()\n",
    "sorted(df_cleaned['County'].unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "# I can see that there are 4 pairs of duplicates due to typo\n",
    "# 'buena visita vs buena visit', 'cerro gord vs cerro gordo', 'o'brien vs obrien', and 'pottawatta vs pottawattamie'\n",
    "df_cleaned['County'] = df_cleaned['County'].replace('buena vist','buena vista')\n",
    "df_cleaned['County'] = df_cleaned['County'].replace('cerro gord','cerro gordo')\n",
    "df_cleaned['County'] = df_cleaned['County'].replace(\"o'brien\",'obrien')\n",
    "df_cleaned['County'] = df_cleaned['County'].replace('pottawatta','pottawattamie')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "If the number of unique county names match the number of unique county number? -  True\n"
     ]
    }
   ],
   "source": [
    "# validate again if now the # of unique county name equals the # of unique county number\n",
    "print('If the number of unique county names match the number of unique county number? - ', df_cleaned['County Number'].nunique() == df_cleaned['County'].nunique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Markup Per Bottle</th>\n",
       "      <th>Markup Rate Per Item</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Item Number</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>159</th>\n",
       "      <th>23.36</th>\n",
       "      <td>2.250000</td>\n",
       "      <td>7.79</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">258</th>\n",
       "      <th>135.00</th>\n",
       "      <td>6.000000</td>\n",
       "      <td>45.00</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148.50</th>\n",
       "      <td>6.240000</td>\n",
       "      <td>49.50</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>266</th>\n",
       "      <th>41.25</th>\n",
       "      <td>13.695266</td>\n",
       "      <td>13.75</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>287</th>\n",
       "      <th>39.74</th>\n",
       "      <td>9.272727</td>\n",
       "      <td>13.25</td>\n",
       "      <td>50.02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <th>41.24</th>\n",
       "      <td>2.296154</td>\n",
       "      <td>13.75</td>\n",
       "      <td>50.02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>322</th>\n",
       "      <th>4.50</th>\n",
       "      <td>16.800000</td>\n",
       "      <td>1.50</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>399</th>\n",
       "      <th>97.20</th>\n",
       "      <td>108.000000</td>\n",
       "      <td>32.40</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>428</th>\n",
       "      <th>22.61</th>\n",
       "      <td>6.281250</td>\n",
       "      <td>7.54</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>434</th>\n",
       "      <th>15.75</th>\n",
       "      <td>8.971519</td>\n",
       "      <td>5.25</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>995606</th>\n",
       "      <th>27.56</th>\n",
       "      <td>9.000000</td>\n",
       "      <td>9.19</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>995607</th>\n",
       "      <th>29.00</th>\n",
       "      <td>11.250000</td>\n",
       "      <td>9.67</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>995678</th>\n",
       "      <th>27.50</th>\n",
       "      <td>4.500000</td>\n",
       "      <td>9.17</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>996237</th>\n",
       "      <th>19.50</th>\n",
       "      <td>24.000000</td>\n",
       "      <td>6.50</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>997086</th>\n",
       "      <th>39.99</th>\n",
       "      <td>4.500000</td>\n",
       "      <td>13.33</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>997090</th>\n",
       "      <th>25.50</th>\n",
       "      <td>9.000000</td>\n",
       "      <td>8.50</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>997094</th>\n",
       "      <th>30.00</th>\n",
       "      <td>6.000000</td>\n",
       "      <td>10.00</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>997095</th>\n",
       "      <th>90.00</th>\n",
       "      <td>4.500000</td>\n",
       "      <td>30.00</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>997872</th>\n",
       "      <th>29.31</th>\n",
       "      <td>4.500000</td>\n",
       "      <td>9.77</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>999292</th>\n",
       "      <th>22.49</th>\n",
       "      <td>4.500000</td>\n",
       "      <td>7.50</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3684 rows  3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 Volume Sold (Liters)  Markup Per Bottle  \\\n",
       "Item Number State Bottle Retail                                            \n",
       "159         23.36                            2.250000               7.79   \n",
       "258         135.00                           6.000000              45.00   \n",
       "            148.50                           6.240000              49.50   \n",
       "266         41.25                           13.695266              13.75   \n",
       "287         39.74                            9.272727              13.25   \n",
       "308         41.24                            2.296154              13.75   \n",
       "322         4.50                            16.800000               1.50   \n",
       "399         97.20                          108.000000              32.40   \n",
       "428         22.61                            6.281250               7.54   \n",
       "434         15.75                            8.971519               5.25   \n",
       "...                                               ...                ...   \n",
       "995606      27.56                            9.000000               9.19   \n",
       "995607      29.00                           11.250000               9.67   \n",
       "995678      27.50                            4.500000               9.17   \n",
       "996237      19.50                           24.000000               6.50   \n",
       "997086      39.99                            4.500000              13.33   \n",
       "997090      25.50                            9.000000               8.50   \n",
       "997094      30.00                            6.000000              10.00   \n",
       "997095      90.00                            4.500000              30.00   \n",
       "997872      29.31                            4.500000               9.77   \n",
       "999292      22.49                            4.500000               7.50   \n",
       "\n",
       "                                 Markup Rate Per Item  \n",
       "Item Number State Bottle Retail                        \n",
       "159         23.36                               50.03  \n",
       "258         135.00                              50.00  \n",
       "            148.50                              50.00  \n",
       "266         41.25                               50.00  \n",
       "287         39.74                               50.02  \n",
       "308         41.24                               50.02  \n",
       "322         4.50                                50.00  \n",
       "399         97.20                               50.00  \n",
       "428         22.61                               50.03  \n",
       "434         15.75                               50.00  \n",
       "...                                               ...  \n",
       "995606      27.56                               50.03  \n",
       "995607      29.00                               50.03  \n",
       "995678      27.50                               50.03  \n",
       "996237      19.50                               50.00  \n",
       "997086      39.99                               50.00  \n",
       "997090      25.50                               50.00  \n",
       "997094      30.00                               50.00  \n",
       "997095      90.00                               50.00  \n",
       "997872      29.31                               50.00  \n",
       "999292      22.49                               50.03  \n",
       "\n",
       "[3684 rows x 3 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# take year 2019 for e.g., to see if there is any price difference of same item across differnt stores\n",
    "# we can see that there are some liquors are sold with different prices\n",
    "df_cleaned.loc[df_cleaned['Year'] == 2019].groupby(['Item Number','State Bottle Retail']).agg({'Volume Sold (Liters)':'mean','Markup Per Bottle':'mean','Markup Rate Per Item':'mean'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "279557.28"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check out the maximum sales per transaction\n",
    "df_cleaned['Sale (Dollars)'].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Invoice/Item Number</th>\n",
       "      <th>Date</th>\n",
       "      <th>Store Number</th>\n",
       "      <th>Store Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Store Location</th>\n",
       "      <th>County Number</th>\n",
       "      <th>County</th>\n",
       "      <th>Category</th>\n",
       "      <th>Category Name</th>\n",
       "      <th>Vendor Number</th>\n",
       "      <th>Vendor Name</th>\n",
       "      <th>Item Number</th>\n",
       "      <th>Item Description</th>\n",
       "      <th>Pack</th>\n",
       "      <th>Bottle Volume (ml)</th>\n",
       "      <th>State Bottle Cost</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th>Bottles Sold</th>\n",
       "      <th>Sale (Dollars)</th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Volume Sold (Gallons)</th>\n",
       "      <th>Year_Week</th>\n",
       "      <th>Year_Month</th>\n",
       "      <th>Year_Quarter</th>\n",
       "      <th>Year</th>\n",
       "      <th>Markup Per Bottle</th>\n",
       "      <th>Markup Per Transaction</th>\n",
       "      <th>Cost Per Transaction</th>\n",
       "      <th>Markup Rate Per Item</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>824858</th>\n",
       "      <td>S05867400001</td>\n",
       "      <td>2012-06-04</td>\n",
       "      <td>2633</td>\n",
       "      <td>Hy-Vee #3 / BDI / Des Moines</td>\n",
       "      <td>3221 SE 14TH ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50320</td>\n",
       "      <td>POINT (-93.596754 41.554101)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1062310</td>\n",
       "      <td>SPICED RUM</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>43337</td>\n",
       "      <td>Captain Morgan Spiced Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>11.30</td>\n",
       "      <td>16.94</td>\n",
       "      <td>15000.0</td>\n",
       "      <td>254100.00</td>\n",
       "      <td>15000.0</td>\n",
       "      <td>3962.58</td>\n",
       "      <td>2012-06-04/2012-06-10</td>\n",
       "      <td>2012-06</td>\n",
       "      <td>2012Q2</td>\n",
       "      <td>2012</td>\n",
       "      <td>5.64</td>\n",
       "      <td>84600.00</td>\n",
       "      <td>169500.00</td>\n",
       "      <td>49.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1886936</th>\n",
       "      <td>S09275100052</td>\n",
       "      <td>2012-12-03</td>\n",
       "      <td>2633</td>\n",
       "      <td>Hy-Vee #3 / BDI / Des Moines</td>\n",
       "      <td>3221 SE 14TH ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50320</td>\n",
       "      <td>POINT (-93.596754 41.554101)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1062310</td>\n",
       "      <td>SPICED RUM</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>43337</td>\n",
       "      <td>Captain Morgan Spiced Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>11.30</td>\n",
       "      <td>16.94</td>\n",
       "      <td>15000.0</td>\n",
       "      <td>254100.00</td>\n",
       "      <td>15000.0</td>\n",
       "      <td>3962.58</td>\n",
       "      <td>2012-12-03/2012-12-09</td>\n",
       "      <td>2012-12</td>\n",
       "      <td>2012Q4</td>\n",
       "      <td>2012</td>\n",
       "      <td>5.64</td>\n",
       "      <td>84600.00</td>\n",
       "      <td>169500.00</td>\n",
       "      <td>49.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1957919</th>\n",
       "      <td>S09484600001</td>\n",
       "      <td>2012-12-13</td>\n",
       "      <td>3814</td>\n",
       "      <td>Costco Wholesale #788</td>\n",
       "      <td>7205 MILLS CIVIC PKWY</td>\n",
       "      <td>WEST DES MOINES</td>\n",
       "      <td>50266</td>\n",
       "      <td>POINT (-93.806489 41.561342)</td>\n",
       "      <td>25</td>\n",
       "      <td>dallas</td>\n",
       "      <td>1012200</td>\n",
       "      <td>SCOTCH WHISKIES</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>5329</td>\n",
       "      <td>Johnnie Walker Blue</td>\n",
       "      <td>6</td>\n",
       "      <td>750.0</td>\n",
       "      <td>129.00</td>\n",
       "      <td>193.49</td>\n",
       "      <td>600.0</td>\n",
       "      <td>116094.00</td>\n",
       "      <td>450.0</td>\n",
       "      <td>118.88</td>\n",
       "      <td>2012-12-10/2012-12-16</td>\n",
       "      <td>2012-12</td>\n",
       "      <td>2012Q4</td>\n",
       "      <td>2012</td>\n",
       "      <td>64.49</td>\n",
       "      <td>38694.00</td>\n",
       "      <td>77400.00</td>\n",
       "      <td>49.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3025679</th>\n",
       "      <td>S12933100005</td>\n",
       "      <td>2013-06-24</td>\n",
       "      <td>2633</td>\n",
       "      <td>Hy-Vee #3 / BDI / Des Moines</td>\n",
       "      <td>3221 SE 14TH ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50320</td>\n",
       "      <td>POINT (-93.596754 41.554101)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1062310</td>\n",
       "      <td>SPICED RUM</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>43337</td>\n",
       "      <td>Captain Morgan Spiced Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>11.75</td>\n",
       "      <td>17.62</td>\n",
       "      <td>11124.0</td>\n",
       "      <td>196004.88</td>\n",
       "      <td>11124.0</td>\n",
       "      <td>2938.65</td>\n",
       "      <td>2013-06-24/2013-06-30</td>\n",
       "      <td>2013-06</td>\n",
       "      <td>2013Q2</td>\n",
       "      <td>2013</td>\n",
       "      <td>5.87</td>\n",
       "      <td>65297.88</td>\n",
       "      <td>130707.00</td>\n",
       "      <td>49.96</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3705536</th>\n",
       "      <td>S15210800214</td>\n",
       "      <td>2013-10-17</td>\n",
       "      <td>2561</td>\n",
       "      <td>Hy-Vee Food Store / Fleur / DSM</td>\n",
       "      <td>4605 FLEUR DRIVE</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50321</td>\n",
       "      <td>POINT (-93.64494300000001 41.542748)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1701100</td>\n",
       "      <td>DECANTERS &amp; SPECIALTY PACKAGES</td>\n",
       "      <td>370</td>\n",
       "      <td>Pernod Ricard USA/Austin Nichols</td>\n",
       "      <td>3984</td>\n",
       "      <td>Absolut w/4-50mls</td>\n",
       "      <td>1</td>\n",
       "      <td>750.0</td>\n",
       "      <td>137.13</td>\n",
       "      <td>206.07</td>\n",
       "      <td>540.0</td>\n",
       "      <td>111277.80</td>\n",
       "      <td>405.0</td>\n",
       "      <td>106.99</td>\n",
       "      <td>2013-10-14/2013-10-20</td>\n",
       "      <td>2013-10</td>\n",
       "      <td>2013Q4</td>\n",
       "      <td>2013</td>\n",
       "      <td>68.94</td>\n",
       "      <td>37227.60</td>\n",
       "      <td>74050.20</td>\n",
       "      <td>50.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5132466</th>\n",
       "      <td>S19816600002</td>\n",
       "      <td>2014-06-27</td>\n",
       "      <td>2633</td>\n",
       "      <td>Hy-Vee #3 / BDI / Des Moines</td>\n",
       "      <td>3221 SE 14TH ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50320</td>\n",
       "      <td>POINT (-93.596754 41.554101)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1012100</td>\n",
       "      <td>CANADIAN WHISKIES</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>11297</td>\n",
       "      <td>Crown Royal Canadian Whisky</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>18.25</td>\n",
       "      <td>27.37</td>\n",
       "      <td>3456.0</td>\n",
       "      <td>94590.72</td>\n",
       "      <td>3456.0</td>\n",
       "      <td>912.98</td>\n",
       "      <td>2014-06-23/2014-06-29</td>\n",
       "      <td>2014-06</td>\n",
       "      <td>2014Q2</td>\n",
       "      <td>2014</td>\n",
       "      <td>9.12</td>\n",
       "      <td>31518.72</td>\n",
       "      <td>63072.00</td>\n",
       "      <td>49.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6610201</th>\n",
       "      <td>S24426100046</td>\n",
       "      <td>2015-03-09</td>\n",
       "      <td>2633</td>\n",
       "      <td>Hy-Vee #3 / BDI / Des Moines</td>\n",
       "      <td>3221 SE 14TH ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50320</td>\n",
       "      <td>POINT (-93.596754 41.554101)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1011300</td>\n",
       "      <td>TENNESSEE WHISKIES</td>\n",
       "      <td>85</td>\n",
       "      <td>Brown-Forman Corporation</td>\n",
       "      <td>26827</td>\n",
       "      <td>Jack Daniels Old #7 Black Lbl</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>17.90</td>\n",
       "      <td>26.85</td>\n",
       "      <td>3960.0</td>\n",
       "      <td>106326.00</td>\n",
       "      <td>3960.0</td>\n",
       "      <td>1046.12</td>\n",
       "      <td>2015-03-09/2015-03-15</td>\n",
       "      <td>2015-03</td>\n",
       "      <td>2015Q1</td>\n",
       "      <td>2015</td>\n",
       "      <td>8.95</td>\n",
       "      <td>35442.00</td>\n",
       "      <td>70884.00</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9084683</th>\n",
       "      <td>S31923800002</td>\n",
       "      <td>2016-04-25</td>\n",
       "      <td>2633</td>\n",
       "      <td>Hy-Vee #3 / BDI / Des Moines</td>\n",
       "      <td>3221 SE 14TH ST</td>\n",
       "      <td>DES MOINES</td>\n",
       "      <td>50320</td>\n",
       "      <td>POINT (-93.596754 41.554101)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1011300</td>\n",
       "      <td>TENNESSEE WHISKIES</td>\n",
       "      <td>85</td>\n",
       "      <td>Brown-Forman Corporation</td>\n",
       "      <td>26827</td>\n",
       "      <td>Jack Daniels Old #7 Black Lbl</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>18.38</td>\n",
       "      <td>27.57</td>\n",
       "      <td>6600.0</td>\n",
       "      <td>181962.00</td>\n",
       "      <td>6600.0</td>\n",
       "      <td>1743.54</td>\n",
       "      <td>2016-04-25/2016-05-01</td>\n",
       "      <td>2016-04</td>\n",
       "      <td>2016Q2</td>\n",
       "      <td>2016</td>\n",
       "      <td>9.19</td>\n",
       "      <td>60654.00</td>\n",
       "      <td>121308.00</td>\n",
       "      <td>50.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11897789</th>\n",
       "      <td>INV-07709000032</td>\n",
       "      <td>2017-10-05</td>\n",
       "      <td>2663</td>\n",
       "      <td>Hy-Vee / Urbandale</td>\n",
       "      <td>8701 Douglas</td>\n",
       "      <td>Urbandale</td>\n",
       "      <td>50322</td>\n",
       "      <td>POINT (-93.739105 41.629364)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1012100</td>\n",
       "      <td>Canadian Whiskies</td>\n",
       "      <td>260</td>\n",
       "      <td>DIAGEO AMERICAS</td>\n",
       "      <td>11296</td>\n",
       "      <td>Crown Royal</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>15.59</td>\n",
       "      <td>23.39</td>\n",
       "      <td>4908.0</td>\n",
       "      <td>114798.12</td>\n",
       "      <td>3681.0</td>\n",
       "      <td>972.42</td>\n",
       "      <td>2017-10-02/2017-10-08</td>\n",
       "      <td>2017-10</td>\n",
       "      <td>2017Q4</td>\n",
       "      <td>2017</td>\n",
       "      <td>7.80</td>\n",
       "      <td>38282.40</td>\n",
       "      <td>76515.72</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14021227</th>\n",
       "      <td>INV-14774700005</td>\n",
       "      <td>2018-10-02</td>\n",
       "      <td>2663</td>\n",
       "      <td>Hy-Vee Food Store / Urbandale</td>\n",
       "      <td>8701 Douglas</td>\n",
       "      <td>Urbandale</td>\n",
       "      <td>50322</td>\n",
       "      <td>POINT (-93.739105 41.629364)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1012100</td>\n",
       "      <td>Canadian Whiskies</td>\n",
       "      <td>260</td>\n",
       "      <td>DIAGEO AMERICAS</td>\n",
       "      <td>11296</td>\n",
       "      <td>Crown Royal</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>15.59</td>\n",
       "      <td>23.39</td>\n",
       "      <td>11952.0</td>\n",
       "      <td>279557.28</td>\n",
       "      <td>8964.0</td>\n",
       "      <td>2368.03</td>\n",
       "      <td>2018-10-01/2018-10-07</td>\n",
       "      <td>2018-10</td>\n",
       "      <td>2018Q4</td>\n",
       "      <td>2018</td>\n",
       "      <td>7.80</td>\n",
       "      <td>93225.60</td>\n",
       "      <td>186331.68</td>\n",
       "      <td>50.03</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Invoice/Item Number       Date  Store Number  \\\n",
       "824858          S05867400001 2012-06-04          2633   \n",
       "1886936         S09275100052 2012-12-03          2633   \n",
       "1957919         S09484600001 2012-12-13          3814   \n",
       "3025679         S12933100005 2013-06-24          2633   \n",
       "3705536         S15210800214 2013-10-17          2561   \n",
       "5132466         S19816600002 2014-06-27          2633   \n",
       "6610201         S24426100046 2015-03-09          2633   \n",
       "9084683         S31923800002 2016-04-25          2633   \n",
       "11897789     INV-07709000032 2017-10-05          2663   \n",
       "14021227     INV-14774700005 2018-10-02          2663   \n",
       "\n",
       "                               Store Name                Address  \\\n",
       "824858       Hy-Vee #3 / BDI / Des Moines        3221 SE 14TH ST   \n",
       "1886936      Hy-Vee #3 / BDI / Des Moines        3221 SE 14TH ST   \n",
       "1957919             Costco Wholesale #788  7205 MILLS CIVIC PKWY   \n",
       "3025679      Hy-Vee #3 / BDI / Des Moines        3221 SE 14TH ST   \n",
       "3705536   Hy-Vee Food Store / Fleur / DSM       4605 FLEUR DRIVE   \n",
       "5132466      Hy-Vee #3 / BDI / Des Moines        3221 SE 14TH ST   \n",
       "6610201      Hy-Vee #3 / BDI / Des Moines        3221 SE 14TH ST   \n",
       "9084683      Hy-Vee #3 / BDI / Des Moines        3221 SE 14TH ST   \n",
       "11897789               Hy-Vee / Urbandale           8701 Douglas   \n",
       "14021227    Hy-Vee Food Store / Urbandale           8701 Douglas   \n",
       "\n",
       "                     City Zip Code                        Store Location  \\\n",
       "824858         DES MOINES    50320          POINT (-93.596754 41.554101)   \n",
       "1886936        DES MOINES    50320          POINT (-93.596754 41.554101)   \n",
       "1957919   WEST DES MOINES    50266          POINT (-93.806489 41.561342)   \n",
       "3025679        DES MOINES    50320          POINT (-93.596754 41.554101)   \n",
       "3705536        DES MOINES    50321  POINT (-93.64494300000001 41.542748)   \n",
       "5132466        DES MOINES    50320          POINT (-93.596754 41.554101)   \n",
       "6610201        DES MOINES    50320          POINT (-93.596754 41.554101)   \n",
       "9084683        DES MOINES    50320          POINT (-93.596754 41.554101)   \n",
       "11897789        Urbandale    50322          POINT (-93.739105 41.629364)   \n",
       "14021227        Urbandale    50322          POINT (-93.739105 41.629364)   \n",
       "\n",
       "         County Number  County Category                   Category Name  \\\n",
       "824858              77    polk  1062310                      SPICED RUM   \n",
       "1886936             77    polk  1062310                      SPICED RUM   \n",
       "1957919             25  dallas  1012200                 SCOTCH WHISKIES   \n",
       "3025679             77    polk  1062310                      SPICED RUM   \n",
       "3705536             77    polk  1701100  DECANTERS & SPECIALTY PACKAGES   \n",
       "5132466             77    polk  1012100               CANADIAN WHISKIES   \n",
       "6610201             77    polk  1011300              TENNESSEE WHISKIES   \n",
       "9084683             77    polk  1011300              TENNESSEE WHISKIES   \n",
       "11897789            77    polk  1012100               Canadian Whiskies   \n",
       "14021227            77    polk  1012100               Canadian Whiskies   \n",
       "\n",
       "         Vendor Number                       Vendor Name Item Number  \\\n",
       "824858             260                   Diageo Americas       43337   \n",
       "1886936            260                   Diageo Americas       43337   \n",
       "1957919            260                   Diageo Americas        5329   \n",
       "3025679            260                   Diageo Americas       43337   \n",
       "3705536            370  Pernod Ricard USA/Austin Nichols        3984   \n",
       "5132466            260                   Diageo Americas       11297   \n",
       "6610201             85          Brown-Forman Corporation       26827   \n",
       "9084683             85          Brown-Forman Corporation       26827   \n",
       "11897789           260                   DIAGEO AMERICAS       11296   \n",
       "14021227           260                   DIAGEO AMERICAS       11296   \n",
       "\n",
       "                       Item Description  Pack  Bottle Volume (ml)  \\\n",
       "824858        Captain Morgan Spiced Rum    12              1000.0   \n",
       "1886936       Captain Morgan Spiced Rum    12              1000.0   \n",
       "1957919             Johnnie Walker Blue     6               750.0   \n",
       "3025679       Captain Morgan Spiced Rum    12              1000.0   \n",
       "3705536               Absolut w/4-50mls     1               750.0   \n",
       "5132466     Crown Royal Canadian Whisky    12              1000.0   \n",
       "6610201   Jack Daniels Old #7 Black Lbl    12              1000.0   \n",
       "9084683   Jack Daniels Old #7 Black Lbl    12              1000.0   \n",
       "11897789                    Crown Royal    12               750.0   \n",
       "14021227                    Crown Royal    12               750.0   \n",
       "\n",
       "          State Bottle Cost  State Bottle Retail  Bottles Sold  \\\n",
       "824858                11.30                16.94       15000.0   \n",
       "1886936               11.30                16.94       15000.0   \n",
       "1957919              129.00               193.49         600.0   \n",
       "3025679               11.75                17.62       11124.0   \n",
       "3705536              137.13               206.07         540.0   \n",
       "5132466               18.25                27.37        3456.0   \n",
       "6610201               17.90                26.85        3960.0   \n",
       "9084683               18.38                27.57        6600.0   \n",
       "11897789              15.59                23.39        4908.0   \n",
       "14021227              15.59                23.39       11952.0   \n",
       "\n",
       "          Sale (Dollars)  Volume Sold (Liters)  Volume Sold (Gallons)  \\\n",
       "824858         254100.00               15000.0                3962.58   \n",
       "1886936        254100.00               15000.0                3962.58   \n",
       "1957919        116094.00                 450.0                 118.88   \n",
       "3025679        196004.88               11124.0                2938.65   \n",
       "3705536        111277.80                 405.0                 106.99   \n",
       "5132466         94590.72                3456.0                 912.98   \n",
       "6610201        106326.00                3960.0                1046.12   \n",
       "9084683        181962.00                6600.0                1743.54   \n",
       "11897789       114798.12                3681.0                 972.42   \n",
       "14021227       279557.28                8964.0                2368.03   \n",
       "\n",
       "                      Year_Week Year_Month Year_Quarter  Year  \\\n",
       "824858    2012-06-04/2012-06-10    2012-06       2012Q2  2012   \n",
       "1886936   2012-12-03/2012-12-09    2012-12       2012Q4  2012   \n",
       "1957919   2012-12-10/2012-12-16    2012-12       2012Q4  2012   \n",
       "3025679   2013-06-24/2013-06-30    2013-06       2013Q2  2013   \n",
       "3705536   2013-10-14/2013-10-20    2013-10       2013Q4  2013   \n",
       "5132466   2014-06-23/2014-06-29    2014-06       2014Q2  2014   \n",
       "6610201   2015-03-09/2015-03-15    2015-03       2015Q1  2015   \n",
       "9084683   2016-04-25/2016-05-01    2016-04       2016Q2  2016   \n",
       "11897789  2017-10-02/2017-10-08    2017-10       2017Q4  2017   \n",
       "14021227  2018-10-01/2018-10-07    2018-10       2018Q4  2018   \n",
       "\n",
       "          Markup Per Bottle  Markup Per Transaction  Cost Per Transaction  \\\n",
       "824858                 5.64                84600.00             169500.00   \n",
       "1886936                5.64                84600.00             169500.00   \n",
       "1957919               64.49                38694.00              77400.00   \n",
       "3025679                5.87                65297.88             130707.00   \n",
       "3705536               68.94                37227.60              74050.20   \n",
       "5132466                9.12                31518.72              63072.00   \n",
       "6610201                8.95                35442.00              70884.00   \n",
       "9084683                9.19                60654.00             121308.00   \n",
       "11897789               7.80                38282.40              76515.72   \n",
       "14021227               7.80                93225.60             186331.68   \n",
       "\n",
       "          Markup Rate Per Item  \n",
       "824858                   49.91  \n",
       "1886936                  49.91  \n",
       "1957919                  49.99  \n",
       "3025679                  49.96  \n",
       "3705536                  50.27  \n",
       "5132466                  49.97  \n",
       "6610201                  50.00  \n",
       "9084683                  50.00  \n",
       "11897789                 50.03  \n",
       "14021227                 50.03  "
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check out the top 10 maximum sales per transaction, sorted by date\n",
    "df_cleaned.nlargest(10,'Sale (Dollars)').sort_values(by='Date')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Invoice/Item Number</th>\n",
       "      <th>Date</th>\n",
       "      <th>Store Number</th>\n",
       "      <th>Store Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Store Location</th>\n",
       "      <th>County Number</th>\n",
       "      <th>County</th>\n",
       "      <th>Category</th>\n",
       "      <th>Category Name</th>\n",
       "      <th>Vendor Number</th>\n",
       "      <th>Vendor Name</th>\n",
       "      <th>Item Number</th>\n",
       "      <th>Item Description</th>\n",
       "      <th>Pack</th>\n",
       "      <th>Bottle Volume (ml)</th>\n",
       "      <th>State Bottle Cost</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th>Bottles Sold</th>\n",
       "      <th>Sale (Dollars)</th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Volume Sold (Gallons)</th>\n",
       "      <th>Year_Week</th>\n",
       "      <th>Year_Month</th>\n",
       "      <th>Year_Quarter</th>\n",
       "      <th>Year</th>\n",
       "      <th>Markup Per Bottle</th>\n",
       "      <th>Markup Per Transaction</th>\n",
       "      <th>Cost Per Transaction</th>\n",
       "      <th>Markup Rate Per Item</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>7072555</th>\n",
       "      <td>S25859000017</td>\n",
       "      <td>2015-05-27</td>\n",
       "      <td>3842</td>\n",
       "      <td>Bancroft Liquor Store</td>\n",
       "      <td>107 N PORTLAND ST PO BX 222</td>\n",
       "      <td>BANCROFT</td>\n",
       "      <td>50517</td>\n",
       "      <td>POINT (-94.218 43.29355)</td>\n",
       "      <td>55</td>\n",
       "      <td>kossuth</td>\n",
       "      <td>1062200</td>\n",
       "      <td>PUERTO RICO &amp; VIRGIN ISLANDS RUM</td>\n",
       "      <td>55</td>\n",
       "      <td>Sazerac North America</td>\n",
       "      <td>44215</td>\n",
       "      <td>Barton Light Rum</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-05-25/2015-05-31</td>\n",
       "      <td>2015-05</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7079076</th>\n",
       "      <td>S25859000016</td>\n",
       "      <td>2015-05-27</td>\n",
       "      <td>3842</td>\n",
       "      <td>Bancroft Liquor Store</td>\n",
       "      <td>107 N PORTLAND ST PO BX 222</td>\n",
       "      <td>BANCROFT</td>\n",
       "      <td>50517</td>\n",
       "      <td>POINT (-94.218 43.29355)</td>\n",
       "      <td>55</td>\n",
       "      <td>kossuth</td>\n",
       "      <td>1041100</td>\n",
       "      <td>AMERICAN DRY GINS</td>\n",
       "      <td>55</td>\n",
       "      <td>Sazerac North America</td>\n",
       "      <td>29282</td>\n",
       "      <td>Barton Gin</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-05-25/2015-05-31</td>\n",
       "      <td>2015-05</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7080827</th>\n",
       "      <td>S25859000037</td>\n",
       "      <td>2015-05-27</td>\n",
       "      <td>3842</td>\n",
       "      <td>Bancroft Liquor Store</td>\n",
       "      <td>107 N PORTLAND ST PO BX 222</td>\n",
       "      <td>BANCROFT</td>\n",
       "      <td>50517</td>\n",
       "      <td>POINT (-94.218 43.29355)</td>\n",
       "      <td>55</td>\n",
       "      <td>kossuth</td>\n",
       "      <td>1031080</td>\n",
       "      <td>VODKA 80 PROOF</td>\n",
       "      <td>421</td>\n",
       "      <td>Sazerac Co., Inc.</td>\n",
       "      <td>38089</td>\n",
       "      <td>Platinum 7x Vodka</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-05-25/2015-05-31</td>\n",
       "      <td>2015-05</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7081672</th>\n",
       "      <td>S25859000012</td>\n",
       "      <td>2015-05-27</td>\n",
       "      <td>3842</td>\n",
       "      <td>Bancroft Liquor Store</td>\n",
       "      <td>107 N PORTLAND ST PO BX 222</td>\n",
       "      <td>BANCROFT</td>\n",
       "      <td>50517</td>\n",
       "      <td>POINT (-94.218 43.29355)</td>\n",
       "      <td>55</td>\n",
       "      <td>kossuth</td>\n",
       "      <td>1081380</td>\n",
       "      <td>MISCELLANEOUS SCHNAPPS</td>\n",
       "      <td>55</td>\n",
       "      <td>Sazerac North America</td>\n",
       "      <td>84171</td>\n",
       "      <td>99 Bananas</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-05-25/2015-05-31</td>\n",
       "      <td>2015-05</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7084205</th>\n",
       "      <td>S25886100001</td>\n",
       "      <td>2015-05-28</td>\n",
       "      <td>3712</td>\n",
       "      <td>Monte Spirits</td>\n",
       "      <td>109 N 4TH ST</td>\n",
       "      <td>MONTEZUMA</td>\n",
       "      <td>50171</td>\n",
       "      <td>POINT (-92.523692 41.585429)</td>\n",
       "      <td>79</td>\n",
       "      <td>poweshiek</td>\n",
       "      <td>1081600</td>\n",
       "      <td>WHISKEY LIQUEUR</td>\n",
       "      <td>421</td>\n",
       "      <td>Sazerac Co., Inc.</td>\n",
       "      <td>64870</td>\n",
       "      <td>Fireball Cinnamon Whisky</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-05-25/2015-05-31</td>\n",
       "      <td>2015-05</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7097629</th>\n",
       "      <td>S25929600113</td>\n",
       "      <td>2015-06-01</td>\n",
       "      <td>2538</td>\n",
       "      <td>Hy-Vee Food Store #3 / Waterloo</td>\n",
       "      <td>1422 FLAMMANG DR</td>\n",
       "      <td>WATERLOO</td>\n",
       "      <td>50702</td>\n",
       "      <td>POINT (-92.327917 42.459938)</td>\n",
       "      <td>7</td>\n",
       "      <td>black hawk</td>\n",
       "      <td>1052010</td>\n",
       "      <td>IMPORTED GRAPE BRANDIES</td>\n",
       "      <td>330</td>\n",
       "      <td>Gemini Spirits</td>\n",
       "      <td>52653</td>\n",
       "      <td>Hartley Brandy</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-06-01/2015-06-07</td>\n",
       "      <td>2015-06</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7170389</th>\n",
       "      <td>S26161000085</td>\n",
       "      <td>2015-06-11</td>\n",
       "      <td>2587</td>\n",
       "      <td>Hy-Vee Food Store / Johnston</td>\n",
       "      <td>5750 MERLE HAY ROAD</td>\n",
       "      <td>JOHNSTON</td>\n",
       "      <td>50131</td>\n",
       "      <td>POINT (-93.697731 41.665172)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1041100</td>\n",
       "      <td>AMERICAN DRY GINS</td>\n",
       "      <td>55</td>\n",
       "      <td>Sazerac North America</td>\n",
       "      <td>29282</td>\n",
       "      <td>Barton Gin</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-06-08/2015-06-14</td>\n",
       "      <td>2015-06</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7170549</th>\n",
       "      <td>S26161000197</td>\n",
       "      <td>2015-06-11</td>\n",
       "      <td>2587</td>\n",
       "      <td>Hy-Vee Food Store / Johnston</td>\n",
       "      <td>5750 MERLE HAY ROAD</td>\n",
       "      <td>JOHNSTON</td>\n",
       "      <td>50131</td>\n",
       "      <td>POINT (-93.697731 41.665172)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1052010</td>\n",
       "      <td>IMPORTED GRAPE BRANDIES</td>\n",
       "      <td>330</td>\n",
       "      <td>Gemini Spirits</td>\n",
       "      <td>52653</td>\n",
       "      <td>Hartley Brandy</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-06-08/2015-06-14</td>\n",
       "      <td>2015-06</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7171738</th>\n",
       "      <td>S26161000135</td>\n",
       "      <td>2015-06-11</td>\n",
       "      <td>2587</td>\n",
       "      <td>Hy-Vee Food Store / Johnston</td>\n",
       "      <td>5750 MERLE HAY ROAD</td>\n",
       "      <td>JOHNSTON</td>\n",
       "      <td>50131</td>\n",
       "      <td>POINT (-93.697731 41.665172)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1031080</td>\n",
       "      <td>VODKA 80 PROOF</td>\n",
       "      <td>421</td>\n",
       "      <td>Sazerac Co., Inc.</td>\n",
       "      <td>38089</td>\n",
       "      <td>Platinum 7x Vodka</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-06-08/2015-06-14</td>\n",
       "      <td>2015-06</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7172396</th>\n",
       "      <td>S26161000187</td>\n",
       "      <td>2015-06-11</td>\n",
       "      <td>2587</td>\n",
       "      <td>Hy-Vee Food Store / Johnston</td>\n",
       "      <td>5750 MERLE HAY ROAD</td>\n",
       "      <td>JOHNSTON</td>\n",
       "      <td>50131</td>\n",
       "      <td>POINT (-93.697731 41.665172)</td>\n",
       "      <td>77</td>\n",
       "      <td>polk</td>\n",
       "      <td>1062200</td>\n",
       "      <td>PUERTO RICO &amp; VIRGIN ISLANDS RUM</td>\n",
       "      <td>55</td>\n",
       "      <td>Sazerac North America</td>\n",
       "      <td>44215</td>\n",
       "      <td>Barton Light Rum</td>\n",
       "      <td>48</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.89</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2015-06-08/2015-06-14</td>\n",
       "      <td>2015-06</td>\n",
       "      <td>2015Q2</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.89</td>\n",
       "      <td>50.56</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        Invoice/Item Number       Date  Store Number  \\\n",
       "7072555        S25859000017 2015-05-27          3842   \n",
       "7079076        S25859000016 2015-05-27          3842   \n",
       "7080827        S25859000037 2015-05-27          3842   \n",
       "7081672        S25859000012 2015-05-27          3842   \n",
       "7084205        S25886100001 2015-05-28          3712   \n",
       "7097629        S25929600113 2015-06-01          2538   \n",
       "7170389        S26161000085 2015-06-11          2587   \n",
       "7170549        S26161000197 2015-06-11          2587   \n",
       "7171738        S26161000135 2015-06-11          2587   \n",
       "7172396        S26161000187 2015-06-11          2587   \n",
       "\n",
       "                              Store Name                      Address  \\\n",
       "7072555            Bancroft Liquor Store  107 N PORTLAND ST PO BX 222   \n",
       "7079076            Bancroft Liquor Store  107 N PORTLAND ST PO BX 222   \n",
       "7080827            Bancroft Liquor Store  107 N PORTLAND ST PO BX 222   \n",
       "7081672            Bancroft Liquor Store  107 N PORTLAND ST PO BX 222   \n",
       "7084205                    Monte Spirits                 109 N 4TH ST   \n",
       "7097629  Hy-Vee Food Store #3 / Waterloo             1422 FLAMMANG DR   \n",
       "7170389     Hy-Vee Food Store / Johnston          5750 MERLE HAY ROAD   \n",
       "7170549     Hy-Vee Food Store / Johnston          5750 MERLE HAY ROAD   \n",
       "7171738     Hy-Vee Food Store / Johnston          5750 MERLE HAY ROAD   \n",
       "7172396     Hy-Vee Food Store / Johnston          5750 MERLE HAY ROAD   \n",
       "\n",
       "              City Zip Code                Store Location County Number  \\\n",
       "7072555   BANCROFT    50517      POINT (-94.218 43.29355)            55   \n",
       "7079076   BANCROFT    50517      POINT (-94.218 43.29355)            55   \n",
       "7080827   BANCROFT    50517      POINT (-94.218 43.29355)            55   \n",
       "7081672   BANCROFT    50517      POINT (-94.218 43.29355)            55   \n",
       "7084205  MONTEZUMA    50171  POINT (-92.523692 41.585429)            79   \n",
       "7097629   WATERLOO    50702  POINT (-92.327917 42.459938)             7   \n",
       "7170389   JOHNSTON    50131  POINT (-93.697731 41.665172)            77   \n",
       "7170549   JOHNSTON    50131  POINT (-93.697731 41.665172)            77   \n",
       "7171738   JOHNSTON    50131  POINT (-93.697731 41.665172)            77   \n",
       "7172396   JOHNSTON    50131  POINT (-93.697731 41.665172)            77   \n",
       "\n",
       "             County Category                     Category Name Vendor Number  \\\n",
       "7072555     kossuth  1062200  PUERTO RICO & VIRGIN ISLANDS RUM            55   \n",
       "7079076     kossuth  1041100                 AMERICAN DRY GINS            55   \n",
       "7080827     kossuth  1031080                    VODKA 80 PROOF           421   \n",
       "7081672     kossuth  1081380            MISCELLANEOUS SCHNAPPS            55   \n",
       "7084205   poweshiek  1081600                   WHISKEY LIQUEUR           421   \n",
       "7097629  black hawk  1052010           IMPORTED GRAPE BRANDIES           330   \n",
       "7170389        polk  1041100                 AMERICAN DRY GINS            55   \n",
       "7170549        polk  1052010           IMPORTED GRAPE BRANDIES           330   \n",
       "7171738        polk  1031080                    VODKA 80 PROOF           421   \n",
       "7172396        polk  1062200  PUERTO RICO & VIRGIN ISLANDS RUM            55   \n",
       "\n",
       "                   Vendor Name Item Number          Item Description  Pack  \\\n",
       "7072555  Sazerac North America       44215          Barton Light Rum    48   \n",
       "7079076  Sazerac North America       29282                Barton Gin    48   \n",
       "7080827      Sazerac Co., Inc.       38089         Platinum 7x Vodka    48   \n",
       "7081672  Sazerac North America       84171                99 Bananas    48   \n",
       "7084205      Sazerac Co., Inc.       64870  Fireball Cinnamon Whisky    48   \n",
       "7097629         Gemini Spirits       52653            Hartley Brandy    48   \n",
       "7170389  Sazerac North America       29282                Barton Gin    48   \n",
       "7170549         Gemini Spirits       52653            Hartley Brandy    48   \n",
       "7171738      Sazerac Co., Inc.       38089         Platinum 7x Vodka    48   \n",
       "7172396  Sazerac North America       44215          Barton Light Rum    48   \n",
       "\n",
       "         Bottle Volume (ml)  State Bottle Cost  State Bottle Retail  \\\n",
       "7072555               100.0               0.89                 1.34   \n",
       "7079076               100.0               0.89                 1.34   \n",
       "7080827               100.0               0.89                 1.34   \n",
       "7081672               100.0               0.89                 1.34   \n",
       "7084205               100.0               0.89                 1.34   \n",
       "7097629               100.0               0.89                 1.34   \n",
       "7170389               100.0               0.89                 1.34   \n",
       "7170549               100.0               0.89                 1.34   \n",
       "7171738               100.0               0.89                 1.34   \n",
       "7172396               100.0               0.89                 1.34   \n",
       "\n",
       "         Bottles Sold  Sale (Dollars)  Volume Sold (Liters)  \\\n",
       "7072555           1.0            1.34                   0.1   \n",
       "7079076           1.0            1.34                   0.1   \n",
       "7080827           1.0            1.34                   0.1   \n",
       "7081672           1.0            1.34                   0.1   \n",
       "7084205           1.0            1.34                   0.1   \n",
       "7097629           1.0            1.34                   0.1   \n",
       "7170389           1.0            1.34                   0.1   \n",
       "7170549           1.0            1.34                   0.1   \n",
       "7171738           1.0            1.34                   0.1   \n",
       "7172396           1.0            1.34                   0.1   \n",
       "\n",
       "         Volume Sold (Gallons)              Year_Week Year_Month Year_Quarter  \\\n",
       "7072555                   0.03  2015-05-25/2015-05-31    2015-05       2015Q2   \n",
       "7079076                   0.03  2015-05-25/2015-05-31    2015-05       2015Q2   \n",
       "7080827                   0.03  2015-05-25/2015-05-31    2015-05       2015Q2   \n",
       "7081672                   0.03  2015-05-25/2015-05-31    2015-05       2015Q2   \n",
       "7084205                   0.03  2015-05-25/2015-05-31    2015-05       2015Q2   \n",
       "7097629                   0.03  2015-06-01/2015-06-07    2015-06       2015Q2   \n",
       "7170389                   0.03  2015-06-08/2015-06-14    2015-06       2015Q2   \n",
       "7170549                   0.03  2015-06-08/2015-06-14    2015-06       2015Q2   \n",
       "7171738                   0.03  2015-06-08/2015-06-14    2015-06       2015Q2   \n",
       "7172396                   0.03  2015-06-08/2015-06-14    2015-06       2015Q2   \n",
       "\n",
       "         Year  Markup Per Bottle  Markup Per Transaction  \\\n",
       "7072555  2015               0.45                    0.45   \n",
       "7079076  2015               0.45                    0.45   \n",
       "7080827  2015               0.45                    0.45   \n",
       "7081672  2015               0.45                    0.45   \n",
       "7084205  2015               0.45                    0.45   \n",
       "7097629  2015               0.45                    0.45   \n",
       "7170389  2015               0.45                    0.45   \n",
       "7170549  2015               0.45                    0.45   \n",
       "7171738  2015               0.45                    0.45   \n",
       "7172396  2015               0.45                    0.45   \n",
       "\n",
       "         Cost Per Transaction  Markup Rate Per Item  \n",
       "7072555                  0.89                 50.56  \n",
       "7079076                  0.89                 50.56  \n",
       "7080827                  0.89                 50.56  \n",
       "7081672                  0.89                 50.56  \n",
       "7084205                  0.89                 50.56  \n",
       "7097629                  0.89                 50.56  \n",
       "7170389                  0.89                 50.56  \n",
       "7170549                  0.89                 50.56  \n",
       "7171738                  0.89                 50.56  \n",
       "7172396                  0.89                 50.56  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check out the top 10 minumum sales per transaction, sorted by date\n",
    "df_cleaned.nsmallest(10,'Sale (Dollars)').sort_values(by='Date')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "# check out the transactions with 0 sale dollars/State Bottle Cost/State Bottle Retail, grouped by year_quarter\n",
    "# most of them happened in 2012 Q1\n",
    "# df_cleaned[df_cleaned['Sale (Dollars)']==0].sort_values(by='Date').groupby(['Year_Quarter']).count()\n",
    "# df_cleaned[df_cleaned['State Bottle Cost']==0].sort_values(by='Date').groupby(['Year_Quarter']).count()\n",
    "# df_cleaned[df_cleaned['State Bottle Retail']==0].sort_values(by='Date').groupby(['Year_Quarter']).count()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Rename Store Names\n",
    "Many store names are actually under the same brand (e.g., Hy-Vee Food Store and Hy-Vee Drug Store are both Hy-Vee chained stores. I'm going to rename these stores with its actually brand name and analyze data from there"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "store_names = df_cleaned['Store Name'].apply(lambda x: x.split('/')[0])\n",
    "store_names_length = store_names.apply(lambda x: len(x))\n",
    "store_names_shortened = store_names.apply(lambda x: x[:4])\n",
    "top_15_stores = set(store_names_shortened.value_counts().index.values[:15])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_cleaned['Shortened Store Name'] = store_names_shortened\n",
    "top_15_stores_df = df_cleaned[df_cleaned['Shortened Store Name'].isin(top_15_stores)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "top_15_stores_df_list = [pd.DataFrame()]*len(top_15_stores)\n",
    "\n",
    "for idx, store in enumerate(top_15_stores):\n",
    "    store_df = top_15_stores_df[top_15_stores_df['Shortened Store Name'] == store]\n",
    "    top_15_stores_df_list[idx] = store_df\n",
    "    store_df = None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # pickle the top_15_stores_df_list file for future use\n",
    "# with open('top_15_stores_df_list.pkl', 'wb') as f:\n",
    "#     pickle.dump(top_15_stores_df_list, f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # load the top 15 stores dataframe\n",
    "# top_15_stores_df_list = pickle.load(open('top_15_stores_df_list.pkl', 'rb'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fareway Stores\n",
      "The Party Pantry\n",
      "Liquor Barn\n",
      "Dahl's\n",
      "Kum & Go\n",
      "Hy-Vee\n",
      "Casey's General\n",
      "Target\n",
      "Super Saver\n",
      "Wal-Mart\n",
      "Smokin' Joe's\n",
      "Central City Liquor\n",
      "Walgreens\n",
      "Sam' Club\n",
      "Quik Shop Foods\n"
     ]
    }
   ],
   "source": [
    "# get the names of top 15 stores in Iowa for liquor transactions\n",
    "names = ['Casey\\'s General',\n",
    "         'Sam\\' Club',\n",
    "         'Target',\n",
    "         'The Party Pantry',\n",
    "         'Liquor Barn',\n",
    "         'Smokin\\' Joe\\'s',\n",
    "         'Dahl\\'s',\n",
    "         'Fareway Stores',\n",
    "         'Central City Liquor',\n",
    "         'Quik Shop Foods',\n",
    "         'Wal-Mart',\n",
    "         'Kum & Go',\n",
    "         'Super Saver',\n",
    "         'Walgreens',\n",
    "         'Hy-Vee']\n",
    "\n",
    "for store_df in top_15_stores_df_list:\n",
    "    print(store_df['Store Name'].values[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/ubuntu/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  after removing the cwd from sys.path.\n"
     ]
    }
   ],
   "source": [
    "# replace the names with the brand name\n",
    "# so the store names will be grouped from higher level\n",
    "for idx, name in enumerate(names):\n",
    "    top_15_stores_df_list[idx]['Store Name'] = name "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Invoice/Item Number</th>\n",
       "      <th>Date</th>\n",
       "      <th>Store Number</th>\n",
       "      <th>Store Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Store Location</th>\n",
       "      <th>County Number</th>\n",
       "      <th>County</th>\n",
       "      <th>Category</th>\n",
       "      <th>Category Name</th>\n",
       "      <th>Vendor Number</th>\n",
       "      <th>Vendor Name</th>\n",
       "      <th>Item Number</th>\n",
       "      <th>Item Description</th>\n",
       "      <th>Pack</th>\n",
       "      <th>Bottle Volume (ml)</th>\n",
       "      <th>State Bottle Cost</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th>Bottles Sold</th>\n",
       "      <th>Sale (Dollars)</th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Volume Sold (Gallons)</th>\n",
       "      <th>Year_Week</th>\n",
       "      <th>Year_Month</th>\n",
       "      <th>Year_Quarter</th>\n",
       "      <th>Year</th>\n",
       "      <th>Markup Per Bottle</th>\n",
       "      <th>Markup Per Transaction</th>\n",
       "      <th>Cost Per Transaction</th>\n",
       "      <th>Markup Rate Per Item</th>\n",
       "      <th>Shortened Store Name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>S03408000012</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3622</td>\n",
       "      <td>Wal-Mart</td>\n",
       "      <td>2600 HWY 71</td>\n",
       "      <td>SPIRIT LAKE</td>\n",
       "      <td>51360</td>\n",
       "      <td>POINT (-95.126535 43.416452)</td>\n",
       "      <td>30</td>\n",
       "      <td>dickinson</td>\n",
       "      <td>1012100</td>\n",
       "      <td>CANADIAN WHISKIES</td>\n",
       "      <td>65</td>\n",
       "      <td>Jim Beam Brands</td>\n",
       "      <td>15248</td>\n",
       "      <td>Windsor Canadian Pet</td>\n",
       "      <td>6</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>8.92</td>\n",
       "      <td>13.38</td>\n",
       "      <td>24.0</td>\n",
       "      <td>321.12</td>\n",
       "      <td>42.0</td>\n",
       "      <td>11.10</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>4.46</td>\n",
       "      <td>107.04</td>\n",
       "      <td>214.08</td>\n",
       "      <td>50.0</td>\n",
       "      <td>Wal-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>S03383700006</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3934</td>\n",
       "      <td>Wal-Mart</td>\n",
       "      <td>103 E CARLISLE</td>\n",
       "      <td>MAQUOKETA</td>\n",
       "      <td>52060</td>\n",
       "      <td>POINT (-90.66292 42.04869)</td>\n",
       "      <td>49</td>\n",
       "      <td>jackson</td>\n",
       "      <td>1081300</td>\n",
       "      <td>PEPPERMINT SCHNAPPS</td>\n",
       "      <td>434</td>\n",
       "      <td>Luxco-St Louis</td>\n",
       "      <td>81206</td>\n",
       "      <td>Paramount Peppermint Schnapps</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>3.70</td>\n",
       "      <td>5.55</td>\n",
       "      <td>12.0</td>\n",
       "      <td>66.60</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>1.85</td>\n",
       "      <td>22.20</td>\n",
       "      <td>44.40</td>\n",
       "      <td>50.0</td>\n",
       "      <td>Wal-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>161</th>\n",
       "      <td>S03383600017</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3886</td>\n",
       "      <td>Wal-Mart</td>\n",
       "      <td>101  115 ST</td>\n",
       "      <td>ANAMOSA</td>\n",
       "      <td>52205</td>\n",
       "      <td>POINT (-91.26496500000002 42.101677)</td>\n",
       "      <td>53</td>\n",
       "      <td>jones</td>\n",
       "      <td>1081390</td>\n",
       "      <td>IMPORTED SCHNAPPS</td>\n",
       "      <td>421</td>\n",
       "      <td>Sazerac Co., Inc.</td>\n",
       "      <td>69637</td>\n",
       "      <td>Dr. Mcgillicuddy's Cherry Schnapps</td>\n",
       "      <td>12</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>11.00</td>\n",
       "      <td>16.50</td>\n",
       "      <td>24.0</td>\n",
       "      <td>396.00</td>\n",
       "      <td>24.0</td>\n",
       "      <td>6.34</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>5.50</td>\n",
       "      <td>132.00</td>\n",
       "      <td>264.00</td>\n",
       "      <td>50.0</td>\n",
       "      <td>Wal-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>252</th>\n",
       "      <td>S03399400017</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3563</td>\n",
       "      <td>Wal-Mart</td>\n",
       "      <td>3003 NORTH HWY 61</td>\n",
       "      <td>MUSCATINE</td>\n",
       "      <td>52761</td>\n",
       "      <td>POINT (-91.025913 41.45529)</td>\n",
       "      <td>70</td>\n",
       "      <td>muscatine</td>\n",
       "      <td>1031200</td>\n",
       "      <td>VODKA FLAVORED</td>\n",
       "      <td>380</td>\n",
       "      <td>Phillips Beverage Company</td>\n",
       "      <td>41989</td>\n",
       "      <td>Uv Cake Vodka</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>6.22</td>\n",
       "      <td>9.33</td>\n",
       "      <td>24.0</td>\n",
       "      <td>223.92</td>\n",
       "      <td>18.0</td>\n",
       "      <td>4.76</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.11</td>\n",
       "      <td>74.64</td>\n",
       "      <td>149.28</td>\n",
       "      <td>50.0</td>\n",
       "      <td>Wal-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279</th>\n",
       "      <td>S03383600007</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>3886</td>\n",
       "      <td>Wal-Mart</td>\n",
       "      <td>101  115 ST</td>\n",
       "      <td>ANAMOSA</td>\n",
       "      <td>52205</td>\n",
       "      <td>POINT (-91.26496500000002 42.101677)</td>\n",
       "      <td>53</td>\n",
       "      <td>jones</td>\n",
       "      <td>1031080</td>\n",
       "      <td>VODKA 80 PROOF</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>38008</td>\n",
       "      <td>Smirnoff Vodka 80 Prf Pet</td>\n",
       "      <td>6</td>\n",
       "      <td>1750.0</td>\n",
       "      <td>13.98</td>\n",
       "      <td>20.97</td>\n",
       "      <td>6.0</td>\n",
       "      <td>125.82</td>\n",
       "      <td>10.5</td>\n",
       "      <td>2.77</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>6.99</td>\n",
       "      <td>41.94</td>\n",
       "      <td>83.88</td>\n",
       "      <td>50.0</td>\n",
       "      <td>Wal-</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Invoice/Item Number       Date  Store Number Store Name  \\\n",
       "63         S03408000012 2012-01-03          3622   Wal-Mart   \n",
       "90         S03383700006 2012-01-03          3934   Wal-Mart   \n",
       "161        S03383600017 2012-01-03          3886   Wal-Mart   \n",
       "252        S03399400017 2012-01-03          3563   Wal-Mart   \n",
       "279        S03383600007 2012-01-03          3886   Wal-Mart   \n",
       "\n",
       "               Address         City Zip Code  \\\n",
       "63         2600 HWY 71  SPIRIT LAKE    51360   \n",
       "90      103 E CARLISLE    MAQUOKETA    52060   \n",
       "161        101  115 ST      ANAMOSA    52205   \n",
       "252  3003 NORTH HWY 61    MUSCATINE    52761   \n",
       "279        101  115 ST      ANAMOSA    52205   \n",
       "\n",
       "                           Store Location County Number     County Category  \\\n",
       "63           POINT (-95.126535 43.416452)            30  dickinson  1012100   \n",
       "90             POINT (-90.66292 42.04869)            49    jackson  1081300   \n",
       "161  POINT (-91.26496500000002 42.101677)            53      jones  1081390   \n",
       "252           POINT (-91.025913 41.45529)            70  muscatine  1031200   \n",
       "279  POINT (-91.26496500000002 42.101677)            53      jones  1031080   \n",
       "\n",
       "           Category Name Vendor Number                Vendor Name Item Number  \\\n",
       "63     CANADIAN WHISKIES            65            Jim Beam Brands       15248   \n",
       "90   PEPPERMINT SCHNAPPS           434             Luxco-St Louis       81206   \n",
       "161    IMPORTED SCHNAPPS           421          Sazerac Co., Inc.       69637   \n",
       "252       VODKA FLAVORED           380  Phillips Beverage Company       41989   \n",
       "279       VODKA 80 PROOF           260            Diageo Americas       38008   \n",
       "\n",
       "                       Item Description  Pack  Bottle Volume (ml)  \\\n",
       "63                 Windsor Canadian Pet     6              1750.0   \n",
       "90        Paramount Peppermint Schnapps    12               750.0   \n",
       "161  Dr. Mcgillicuddy's Cherry Schnapps    12              1000.0   \n",
       "252                       Uv Cake Vodka    12               750.0   \n",
       "279           Smirnoff Vodka 80 Prf Pet     6              1750.0   \n",
       "\n",
       "     State Bottle Cost  State Bottle Retail  Bottles Sold  Sale (Dollars)  \\\n",
       "63                8.92                13.38          24.0          321.12   \n",
       "90                3.70                 5.55          12.0           66.60   \n",
       "161              11.00                16.50          24.0          396.00   \n",
       "252               6.22                 9.33          24.0          223.92   \n",
       "279              13.98                20.97           6.0          125.82   \n",
       "\n",
       "     Volume Sold (Liters)  Volume Sold (Gallons)              Year_Week  \\\n",
       "63                   42.0                  11.10  2012-01-02/2012-01-08   \n",
       "90                    9.0                   2.38  2012-01-02/2012-01-08   \n",
       "161                  24.0                   6.34  2012-01-02/2012-01-08   \n",
       "252                  18.0                   4.76  2012-01-02/2012-01-08   \n",
       "279                  10.5                   2.77  2012-01-02/2012-01-08   \n",
       "\n",
       "    Year_Month Year_Quarter  Year  Markup Per Bottle  Markup Per Transaction  \\\n",
       "63     2012-01       2012Q1  2012               4.46                  107.04   \n",
       "90     2012-01       2012Q1  2012               1.85                   22.20   \n",
       "161    2012-01       2012Q1  2012               5.50                  132.00   \n",
       "252    2012-01       2012Q1  2012               3.11                   74.64   \n",
       "279    2012-01       2012Q1  2012               6.99                   41.94   \n",
       "\n",
       "     Cost Per Transaction  Markup Rate Per Item Shortened Store Name  \n",
       "63                 214.08                  50.0                 Wal-  \n",
       "90                  44.40                  50.0                 Wal-  \n",
       "161                264.00                  50.0                 Wal-  \n",
       "252                149.28                  50.0                 Wal-  \n",
       "279                 83.88                  50.0                 Wal-  "
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# validate if the names have been changed successfully\n",
    "top_15_stores_df_list[10].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [],
   "source": [
    "# concatenate all top 10 store df lists together to form the master df for future analysis\n",
    "top_15_stores_df_master = pd.concat([top_15_stores_df_list[0],top_15_stores_df_list[1],top_15_stores_df_list[2],\n",
    "                                   top_15_stores_df_list[3],top_15_stores_df_list[4],top_15_stores_df_list[5],\n",
    "                                   top_15_stores_df_list[6],top_15_stores_df_list[7],top_15_stores_df_list[8],\n",
    "                                   top_15_stores_df_list[9],top_15_stores_df_list[10],top_15_stores_df_list[11],\n",
    "                                   top_15_stores_df_list[12], top_15_stores_df_list[13],top_15_stores_df_list[14]],ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pickle the master dataframe for top 15 stores for future analysis\n",
    "with open('top_15_stores_df_master.pkl', 'wb') as f:\n",
    "    pickle.dump(top_15_stores_df_master, f)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# I can just restart from here"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# load the master dataframe for top 10 stores for future analysis\n",
    "import pickle\n",
    "top_15_stores_df_master = pickle.load(open('top_15_stores_df_master.pkl', 'rb'))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Get The Most Frequent Liquor Category Names within Transactions of Top 15 Stores"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "VODKA 80 PROOF                      676189\n",
       "American Vodkas                     539343\n",
       "CANADIAN WHISKIES                   457296\n",
       "Canadian Whiskies                   303508\n",
       "STRAIGHT BOURBON WHISKIES           294298\n",
       "SPICED RUM                          276896\n",
       "VODKA FLAVORED                      273276\n",
       "TEQUILA                             226742\n",
       "BLENDED WHISKIES                    221052\n",
       "PUERTO RICO & VIRGIN ISLANDS RUM    220196\n",
       "IMPORTED VODKA                      209273\n",
       "Straight Bourbon Whiskies           194871\n",
       "American Flavored Vodka             189619\n",
       "Spiced Rum                          188081\n",
       "AMERICAN COCKTAILS                  180327\n",
       "WHISKEY LIQUEUR                     166599\n",
       "FLAVORED RUM                        146763\n",
       "Whiskey Liqueur                     144514\n",
       "AMERICAN DRY GINS                   137485\n",
       "IMPORTED VODKA - MISC               136961\n",
       "Name: Category Name, dtype: int64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# get the most frequent liquor category names\n",
    "# df['Category Name'].value_counts().argmax()\n",
    "df_liquor_freq = top_15_stores_df_master['Category Name'].value_counts()\n",
    "df_liquor_freq.nlargest(20)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Get The Most Profitable Liquor Item Names (with Max) within Transactions of Top 15 Stores\n",
    "Most profitable liquors are those with highest markup rates. Here I find the highest markup rate with corresponding liquor item names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pay attention that I only aggregate the max value here\n",
    "# as Johnathon suggested, I need to calculate sum of sales/ sum of markups/ sum of costs etc., \n",
    "# then calculate the markup rate at category level. I'll do that part later\n",
    "markup_rate_by_alcohol = np.round(top_15_stores_df_master.groupby(by = 'Item Description')['Markup Rate Per Item'].max(), 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "markup_rate_by_alcohol_list = []\n",
    "\n",
    "markup_rate_by_alcohol_keys = markup_rate_by_alcohol.index.values\n",
    "markup_rate_by_alcohol_values = markup_rate_by_alcohol.values\n",
    "\n",
    "for idx, key in enumerate(markup_rate_by_alcohol_keys):\n",
    "    key = markup_rate_by_alcohol_keys[idx] \n",
    "    value = markup_rate_by_alcohol_values[idx] \n",
    "    markup_rate_by_alcohol_list.append((key, value))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('Ole Smoky Blackberry Moonshine', 250.0),\n",
       " ('Dekuyper 03', 249.17),\n",
       " ('Country Gal', 172.75),\n",
       " ('Prairie Fire', 172.75),\n",
       " ('Wisconsin Club Brandy', 125.0),\n",
       " ('Wisconsin Club Gold Tequila', 125.0),\n",
       " ('Maya Horchata', 124.81),\n",
       " ('Blue Chair Bay Vanilla Rum', 100.14),\n",
       " ('Blue Chair Bay Banana Rum Cream', 100.12),\n",
       " ('Disaronno Amaretto Cavalli Mignon 3-50ml Pack', 100.0),\n",
       " ('Hot Rose Cinnamon Cream Liqueur', 90.45),\n",
       " ('Passion XO Sun', 85.87),\n",
       " ('Disaronno Amaretto', 83.33),\n",
       " ('Ole Smoky Original Corn Moonshine', 83.33),\n",
       " ('Ole Smoky Peach Moonshine', 83.33),\n",
       " ('Disaronno Amaretto Cavalli Wrap', 83.29),\n",
       " ('Whitetail Caramel Flavored Whiskey', 81.15),\n",
       " ('360 Concord Grape Vodka', 80.27),\n",
       " ('360 Double Chocolate Vodka', 80.27),\n",
       " ('360 Georgia Peach Vodka', 80.27),\n",
       " ('360 Huckleberry Vodka', 80.27),\n",
       " ('360 Madagascar Vanilla Vodka', 80.27),\n",
       " ('360 Mandarin Orange Vodka', 80.27),\n",
       " ('360 Sorrento Lemon Vodka', 80.27),\n",
       " ('360 Vodka', 80.27),\n",
       " ('Ole Smoky Lemon Drop Moonshine', 80.07),\n",
       " ('Ole Smoky Apple Pie w/Flask', 78.36),\n",
       " ('Ole Smoky Lemon Drop Moonshine w/Mason Jar & Pour Spout', 78.36),\n",
       " ('Dekuyper Mixologist Ginger', 77.15),\n",
       " ('Ole Smoky Apple Pie Moonshine', 76.47),\n",
       " ('Ole Smoky Cherry Moonshine', 76.47),\n",
       " ('Sauza Sparkling Lime Margarita', 76.46),\n",
       " ('Sauza Sparkling Mango Margarita', 76.46),\n",
       " ('Sauza Sparkling Wild Berry Margarita', 76.46),\n",
       " ('Prairie Organic Vodka', 75.04),\n",
       " (\"Burnett's Vodka 80 Prf PET\", 75.0),\n",
       " ('Kinky Blue', 75.0),\n",
       " ('Absolut Tune', 74.49),\n",
       " ('360 Buttered Popcorn', 73.78),\n",
       " ('360 Glazed Donut', 73.78),\n",
       " ('360 Red Raspberry', 73.78),\n",
       " ('Pinnacle Cinnabon', 73.23),\n",
       " ('Cabo Wabo Reposado', 72.28),\n",
       " ('Bacardi Classic Cocktails Mojito', 71.43),\n",
       " ('Bacardi Classic Cocktails Strawberry Daiquiri', 71.43),\n",
       " ('Laphroaig 10 Yr Single Malt Scotch', 71.42),\n",
       " ('Bella Limoncello', 71.34),\n",
       " ('Bella Orangecello', 71.34),\n",
       " (\"Burnett's Pineapple\", 70.75),\n",
       " (\"Russell's Reserve 10YR\", 69.86),\n",
       " ('Oddka Electricity', 69.69),\n",
       " ('Uv Grape Vodka', 69.63),\n",
       " (\"Russell's Reserve Rye 6YR\", 69.4),\n",
       " ('Kahlua Frozen Mudslide', 69.39),\n",
       " ('1800 Coconut', 69.05),\n",
       " ('1800 Reposado Tequila', 68.95),\n",
       " ('1800 Silver Tequila', 68.95),\n",
       " ('Triple Crown Blended Whiskey', 68.84),\n",
       " ('UV Cake Vodka', 68.84),\n",
       " ('UV Vodka PET', 68.84),\n",
       " ('Uv Blue (raspberry) Vodka', 68.84),\n",
       " ('Uv Red (cherry) Vodka', 68.84),\n",
       " ('Cabo Wabo Blanco', 67.73),\n",
       " ('Montego Bay Coconut Rum', 67.68),\n",
       " ('Bacardi Oakheart', 67.42),\n",
       " ('Forty Creek', 66.93),\n",
       " (\"Hook's Spiced Rum\", 66.84),\n",
       " ('Cutty Sark Scotch', 66.76),\n",
       " ('Kinky Liqueur Mini', 66.73),\n",
       " ('Stolichnaya Elit Vodka', 66.7),\n",
       " ('UV Candy Bar Mini', 66.49),\n",
       " ('Uv Cake Vodka', 66.49),\n",
       " ('Firestarter Vodka', 66.24),\n",
       " ('UV Chocolate Cake Mini', 66.21),\n",
       " ('Uv Blue Raspberry Vodka Mini', 66.21),\n",
       " ('Uv Cherry Red Vodka Mini', 66.21),\n",
       " ('UV Peach Mini', 66.13),\n",
       " ('UV Salty Watermelon Mini', 66.13),\n",
       " ('Bacardi 8 Rum', 65.79),\n",
       " ('Bacardi Arctic Grape Liqueur', 65.72),\n",
       " ('Bacardi Rock Coconut', 65.72),\n",
       " (\"Carolan's Irish Cream Liqueur\", 65.7),\n",
       " ('Hammer Sickle', 64.51),\n",
       " ('Grey Goose Cherry Noir', 64.35),\n",
       " (\"Grey Goose Vodka L'orange\", 64.35),\n",
       " ('Tequila Rose Liqueur', 63.71),\n",
       " ('Holstein', 63.68),\n",
       " ('Cazadores Anejo', 63.67),\n",
       " ('The Glenlivet Tasting Kit w/12YR 200ml, 15YR 200ml & 18YR 200ml', 63.66),\n",
       " ('Cazadores Reposado', 63.64),\n",
       " ('Chivas Regal 12yr', 63.61),\n",
       " ('Jose Cuervo Authentic Lime Margarita', 63.54),\n",
       " ('Bakon Vodka', 63.4),\n",
       " ('Forty Creek Cooper Pot', 63.1),\n",
       " ('1800 Anejo Tequila', 62.84),\n",
       " ('Hpnotiq', 62.71),\n",
       " ('Hpnotiq Harmonie', 62.71),\n",
       " ('Pama Pomegranate Liqueur', 62.71),\n",
       " ('Skyy Infusions Wild Strawberry', 62.55),\n",
       " ('Bacardi Classic Cocktails Pina Colada', 62.5),\n",
       " ('Bacardi Cocktails Mojito Light', 62.5),\n",
       " ('Bacardi Cocktails Pina Colada', 62.5),\n",
       " ('Bacardi Cocktails Strawberry Daiquiri Light', 62.5),\n",
       " ('Bird Dog Blackberry Whiskey', 62.5),\n",
       " ('Bird Dog Maple', 62.5),\n",
       " ('Bird Dog Peach Flavored Whiskey', 62.5),\n",
       " ('Calico Jack Whipped', 62.5),\n",
       " (\"Broker's London Dry Gin\", 62.18),\n",
       " ('Sailor Jerry Spiced Navy Rum', 61.76),\n",
       " ('Skyy Vodka', 61.64),\n",
       " ('Malibu Black', 61.63),\n",
       " ('Malibu Island Spiced', 61.63),\n",
       " ('Shellback Silver', 61.63),\n",
       " ('Shellback Spiced', 61.63),\n",
       " ('Kahlua Cinnamon Spice', 61.6),\n",
       " ('Kahlua Hazelnut', 61.6),\n",
       " ('Kahlua Peppermint Mocha', 61.6),\n",
       " ('Kahlua Pumpkin Spice', 61.6),\n",
       " ('Christian Bros Honey', 61.54),\n",
       " ('Kahlua Coffee Liqueur', 61.44),\n",
       " ('Kahlua French Vanilla Liqueur', 61.44),\n",
       " ('Kahlua Mocha Liqueur', 61.44),\n",
       " ('Christian Bros Peach', 61.4),\n",
       " ('Sweet Revenge', 61.14),\n",
       " ('Two Fingers Gold Tequila', 61.05),\n",
       " ('Paddy Bee Sting', 61.04),\n",
       " (\"Paddy Devil's Apple\", 61.04),\n",
       " ('Paddy Old Irish Whiskey', 61.04),\n",
       " ('Wild Turkey 81', 60.83),\n",
       " ('Malibu Blue Hawaiian Cocktail', 60.8),\n",
       " ('Malibu Peach Sparkler', 60.8),\n",
       " ('Malibu Pina Colada Light Cocktail', 60.8),\n",
       " ('Malibu Red', 60.8),\n",
       " ('Malibu Rum Sparkler', 60.8),\n",
       " ('New Amsterdam Peach Mini', 60.78),\n",
       " ('New Amsterdam Red Berry Mini', 60.78),\n",
       " ('New Amsterdam Vodka Mini', 60.78),\n",
       " ('Malibu Carribean Cosmo Light Cocktail in a Bag', 60.71),\n",
       " ('Stolichnaya Russian Vodka 80 Prf', 60.65),\n",
       " ('Kapali Coffee Liqueur', 60.59),\n",
       " ('Malibu Melon Margarita Cocktail', 60.57),\n",
       " ('Malibu Rum Punch Cocktail In A Bag', 60.57),\n",
       " ('Catdaddy Spiced Moonshine', 60.53),\n",
       " ('Midnight Moon Apple Pie', 60.53),\n",
       " ('Midnight Moon Blackberry', 60.53),\n",
       " ('Midnight Moon Blueberry', 60.53),\n",
       " ('Midnight Moon Cherry', 60.53),\n",
       " ('Midnight Moon Cranberry', 60.53),\n",
       " ('Midnight Moon Original', 60.53),\n",
       " ('Midnight Moon Raspberry', 60.53),\n",
       " ('Midnight Moon Strawberry', 60.53),\n",
       " ('Kahlua Especial', 60.52),\n",
       " ('Kahlua Midnight', 60.52),\n",
       " ('Frangelico Liqueur', 60.5),\n",
       " ('Korski Vodka', 60.5),\n",
       " ('X Rated Fusion Liqueur', 60.28),\n",
       " ('Dewars Highlander Honey', 60.19),\n",
       " ('Irish Mist Honey', 60.12),\n",
       " (\"Salvador's Margarita Pet\", 60.08),\n",
       " ('Calico Jack Cherry', 60.0),\n",
       " ('Calico Jack Coconut', 60.0),\n",
       " ('Calico Jack Tropical Punch', 60.0),\n",
       " ('Stoli Razberi (raspberry)', 59.86),\n",
       " ('Stoli Wild Cherri Vodka', 59.86),\n",
       " ('Stolichnaya Blueberi', 59.86),\n",
       " ('Stolichnaya Chocolat Razberi', 59.86),\n",
       " ('Stolichnaya Hot', 59.86),\n",
       " ('Tullamore Dew Irish Whisky', 59.69),\n",
       " ('Malibu Caribbean Cosmo Cocktail In Bag', 59.49),\n",
       " ('Malibu Tropical Mojito Cocktail In A Bag', 59.49),\n",
       " ('Malibu Tropical Sea Breeze Cocktail', 59.49),\n",
       " ('Dekuyper Buttershots Schnapps', 59.43),\n",
       " ('Dekuyper Buttershots Schnapps Traveler', 59.43),\n",
       " ('Dekuyper Cactus Juice Schnapps', 59.43),\n",
       " ('Dekuyper Cherry Pucker Schnapps', 59.43),\n",
       " ('Dekuyper Grape Pucker Schnapps', 59.43),\n",
       " ('Dekuyper Hot Damn!', 59.43),\n",
       " ('Dekuyper Hot Damn! Traveler', 59.43),\n",
       " ('Dekuyper Island Punch Pucker', 59.43),\n",
       " ('Dekuyper Luscious Peachtree Schnapps', 59.43),\n",
       " ('Dekuyper Luscious Pomegranate Pleasure Liq', 59.43),\n",
       " ('Dekuyper Luscious Razzmatazz', 59.43),\n",
       " ('Dekuyper Melon Liqueur', 59.43),\n",
       " ('Dekuyper Michigan Cherry Liqueur', 59.43),\n",
       " ('Dekuyper Peachtree Schnapps Traveler', 59.43),\n",
       " (\"Dekuyper Ragin' Root Beer Schnapps\", 59.43),\n",
       " ('Dekuyper Raspberry Pucker', 59.43),\n",
       " ('Dekuyper Sour Apple Pucker', 59.43),\n",
       " ('Dekuyper Sour Apple Pucker Traveler', 59.43),\n",
       " ('Dekuyper Strawberry Pucker', 59.43),\n",
       " ('Dekuyper Watermelon Pucker', 59.43),\n",
       " (\"McCormick's Irish Cream\", 59.37),\n",
       " (\"Fleischmann's Gin\", 59.27),\n",
       " ('Jim Beam', 59.26),\n",
       " ('Jim Beam Traveler', 59.26),\n",
       " ('Stoli Strasberri Vodka', 59.17),\n",
       " ('Stolichnaya Chocolat Kokonut', 59.17),\n",
       " ('Stolichnaya Salted Karamel', 59.17),\n",
       " ('Stolichnaya Sticki', 59.17),\n",
       " ('Passion XO Blue', 59.15),\n",
       " ('Passion XO Pink', 59.15),\n",
       " ('Skyy Infusions Citrus', 59.08),\n",
       " ('Skyy Infusions Georgia Peach', 59.08),\n",
       " ('Skyy Infusions Moscato Grape', 59.08),\n",
       " ('Skyy Infusions Pacific Blueberry', 59.08),\n",
       " ('Skyy Infusions Pineapple', 59.08),\n",
       " ('Skyy Infusions Texas Grapefruit', 59.08),\n",
       " ('Skyy Infusions Vanilla Bean', 59.08),\n",
       " ('Pendleton Canadian Whisky', 59.01),\n",
       " ('Kuhl Hippie Hooch Love Punch', 58.99),\n",
       " ('Kuhl Mango Lemonade', 58.99),\n",
       " (\"Ryan's Cream Liqueur\", 58.88),\n",
       " ('Avion Silver', 58.85),\n",
       " ('Dewars 12yr', 58.82),\n",
       " ('Tres Leches Cream Liqueur', 58.8),\n",
       " ('Skyy Infusions Coconut', 58.79),\n",
       " ('Ice Box Mudslide', 58.78),\n",
       " (\"Burnett's Blue Raspberry Vodka\", 58.76),\n",
       " ('Cruzan Black Cherry Rum', 58.76),\n",
       " ('Cruzan Coconut Rum', 58.76),\n",
       " ('Cruzan Mango Rum', 58.76),\n",
       " ('Cruzan Raspberry Rum', 58.76),\n",
       " ('Cruzan Strawberry Rum', 58.76),\n",
       " ('Cruzan Vanilla Rum', 58.76),\n",
       " ('Skyy Infusions Blood Orange', 58.75),\n",
       " ('Skyy Infusions Dragon Fruit', 58.75),\n",
       " ('Skyy Infusions Passion Fruit', 58.75),\n",
       " ('Southern Comfort Hurricane Rtp', 58.75),\n",
       " ('Cruzan Key Lime', 58.66),\n",
       " ('Cruzan Passion Fruit', 58.66),\n",
       " (\"Burnett's Cherry Vodka\", 58.64),\n",
       " (\"Burnett's Citrus\", 58.64),\n",
       " (\"Burnett's Fruit Punch\", 58.64),\n",
       " (\"Burnett's Grape Vodka\", 58.64),\n",
       " (\"Burnett's Limeade Vodka\", 58.64),\n",
       " (\"Burnett's Mango Pineapple\", 58.64),\n",
       " (\"Burnett's Strawberry Banana\", 58.64),\n",
       " (\"Burnett's Tropical Punch\", 58.64),\n",
       " (\"Burnett's Vodka 80 Prf\", 58.64),\n",
       " (\"Burnett's Watermelon\", 58.64),\n",
       " ('Burnetts Raspberry Vodka', 58.64),\n",
       " ('Bombay Sapphire East', 58.59),\n",
       " ('Bombay Sapphire Gin', 58.59),\n",
       " ('Cruzan Dark Rum', 58.59),\n",
       " ('Cruzan Light Rum', 58.59),\n",
       " (\"Burnett's Hot Cinnamon\", 58.51),\n",
       " (\"Burnett's Sugar Cookie\", 58.51),\n",
       " (\"Burnett's Whipped Cream Vodka\", 58.51),\n",
       " ('Phillips Black 100 Herbal Schnapps', 58.42),\n",
       " ('Phillips Hot 100 Cinnamon Schnapps', 58.42),\n",
       " ('Margaritaville Classic Lime Margarita', 58.4),\n",
       " ('Margaritaville Gold Tequila', 58.4),\n",
       " ('Margaritaville Last Mango Margarita', 58.4),\n",
       " ('Margaritaville Silver Tequila', 58.4),\n",
       " ('Margaritaville Skinny Island Punch', 58.4),\n",
       " ('Margaritaville Skinny Margarita', 58.4),\n",
       " ('Bacardi Party Drinks Bahama Mama', 58.36),\n",
       " ('Bacardi Party Drinks Hurricane', 58.36),\n",
       " ('Bacardi Party Drinks Rum Island Iced Tea', 58.36),\n",
       " ('Bacardi Party Drinks Zombie', 58.36),\n",
       " ('St. Remy Vsop Napoleon Brandy', 58.31),\n",
       " ('Aberlour 12 Year Single Malt Scotch', 58.27),\n",
       " ('Avion Reposado', 58.27),\n",
       " ('Effen Black Cherry Vodka', 58.26),\n",
       " ('Effen Vodka', 58.26),\n",
       " ('Pinnacle Vodka', 58.24),\n",
       " ('44 North Cherry', 58.2),\n",
       " ('44 North Huckleberry', 58.2),\n",
       " ('44 North Magic Valley', 58.2),\n",
       " ('Sinfire', 58.18),\n",
       " (\"Burnett's Maple Syrup\", 58.17),\n",
       " ('Boodles British Gin London Dry', 58.11),\n",
       " ('Macallan Fine Oak 10 Year', 58.07),\n",
       " ('1800 Silver w/1800 Coconut 50ml & Pineapple Juice', 58.05),\n",
       " (\"Burnett's Blackberry\", 58.03),\n",
       " ('Lexington', 58.02),\n",
       " ('Early Times 36 Mo Ky Str Bourbon Pet', 58.0),\n",
       " ('Bacardi Superior PET', 57.93),\n",
       " ('Russian Standard Original Vodka', 57.93),\n",
       " (\"Burnett's Candy Cane\", 57.89),\n",
       " (\"Burnett's Cherry Cola\", 57.89),\n",
       " (\"Burnett's Pumpkin Spice\", 57.89),\n",
       " (\"Burnett's Ruby Red Grapefruit\", 57.89),\n",
       " ('Fris Citrus', 57.89),\n",
       " ('Fris Orange', 57.89),\n",
       " ('Bacardi Gold Rum', 57.85),\n",
       " ('Bacardi Select Rum', 57.85),\n",
       " ('Bacardi Superior Rum', 57.85),\n",
       " ('Kraken Black Spiced Rum', 57.8),\n",
       " ('Glenlivet 12YR', 57.79),\n",
       " ('Christian Bros Brandy', 57.78),\n",
       " ('Canadian Ltd Whisky', 57.77),\n",
       " ('Early Times 36 Mo Ky Str Bourbon', 57.77),\n",
       " ('Bacardi Gold Rum Pet', 57.73),\n",
       " ('Bacardi Superior Rum Pet', 57.73),\n",
       " ('Fris Danish Vodka', 57.68),\n",
       " ('Phillips Root Beer Schnapps', 57.61),\n",
       " ('Skinnygirl Grapefruit Margarita', 57.5),\n",
       " ('Skinnygirl Mojito', 57.5),\n",
       " ('Avion Anejo', 57.45),\n",
       " ('Jack Daniels Single Barrel Why.', 57.41),\n",
       " ('Remy Martin Vs Cognac', 57.41),\n",
       " ('Milagro Silver Tequila', 57.38),\n",
       " ('Pinnacle Atomic Hot', 57.35),\n",
       " ('Pinnacle Cake Vodka', 57.35),\n",
       " ('Pinnacle Caramel Apple', 57.35),\n",
       " ('Pinnacle Cherry Whipped', 57.35),\n",
       " ('Pinnacle Chocolate Whipped', 57.35),\n",
       " ('Pinnacle Cookie Dough', 57.35),\n",
       " ('Pinnacle Cotton Vodka', 57.35),\n",
       " ('Pinnacle County Fair Cotton', 57.35),\n",
       " ('Pinnacle Grape', 57.35),\n",
       " ('Pinnacle Key Lime Whipped', 57.35),\n",
       " ('Pinnacle Marshmallow', 57.35),\n",
       " ('Pinnacle Orange Whipped', 57.35),\n",
       " ('Pinnacle Peach', 57.35),\n",
       " ('Pinnacle Peachberry Cobbler', 57.35),\n",
       " ('Pinnacle Pecan Pie', 57.35),\n",
       " ('Pinnacle Peppermint Bark', 57.35),\n",
       " ('Pinnacle Pineapple', 57.35),\n",
       " ('Pinnacle Pumpkin Pie', 57.35),\n",
       " ('Pinnacle Rainbow Sherbet', 57.35),\n",
       " ('Pinnacle Red Berry', 57.35),\n",
       " ('Pinnacle Red Liquorice', 57.35),\n",
       " ('Pinnacle Salted Caramel', 57.35),\n",
       " ('Pinnacle Strawberry Shortcake', 57.35),\n",
       " ('Pinnacle Strawberry-Kiwi Vodka', 57.35),\n",
       " ('Pinnacle Tropical Punch', 57.35),\n",
       " ('Pinnacle Whipped', 57.35),\n",
       " ('Skinnygirl Margarita', 57.35),\n",
       " ('Skinnygirl Pina Colada', 57.35),\n",
       " ('Skinnygirl White Cranberry Cosmo', 57.35),\n",
       " ('Skinnygirl White Peach Margarita', 57.35),\n",
       " (\"Two Jay's Iowa Corn Whiskey\", 57.33),\n",
       " ('Bacardi Dragonberry', 57.32),\n",
       " ('Bacardi Limon', 57.32),\n",
       " ('Canadian Club Whisky', 57.31),\n",
       " ('Sweet Carolina Sweet Tea Flavored Vodka', 57.29),\n",
       " ('Pinnacle Blackberry', 57.27),\n",
       " ('Pinnacle Cherry', 57.27),\n",
       " ('Pinnacle Citrus', 57.27),\n",
       " ('Pinnacle Coconut', 57.27),\n",
       " ('Pinnacle Cucumber', 57.27),\n",
       " ('Pinnacle Habanero', 57.27),\n",
       " ('Pinnacle King Cake', 57.27),\n",
       " ('Pinnacle Mimosa', 57.27),\n",
       " ('Pinnacle Raspberry', 57.27),\n",
       " ('Svedka Colada', 57.25),\n",
       " ('Svedka Traveler', 57.25),\n",
       " ('Blackheart Playboy Edition', 57.2),\n",
       " ('Blackheart Premium Spiced Rum', 57.2),\n",
       " ('Evan Williams Cherry Reserve', 57.2),\n",
       " ('Evan Williams Fire', 57.2),\n",
       " ('Evan Williams Honey', 57.2),\n",
       " ('Skinnygirl Sweet Rita', 57.17),\n",
       " ('Kahlua Tin', 57.14),\n",
       " ('Svedka Cherry Vodka', 57.1),\n",
       " ('Svedka Citron Vodka', 57.1),\n",
       " ('Svedka Clementine Vodka', 57.1),\n",
       " ('Svedka Grape Vodka', 57.1),\n",
       " ('Svedka Raspberry Vodka', 57.1),\n",
       " ('Svedka Vanilla Vodka', 57.1),\n",
       " ('Svedka Vodka', 57.1),\n",
       " ('Three Olives Vodka', 57.07),\n",
       " ('Kahlua Gingerbread', 57.05),\n",
       " ('Copa De Oro Mexican Coffee', 57.02),\n",
       " ('Ty Ku Premium Liqueur', 57.01),\n",
       " ('Ty Ku Super Premium Soju', 57.01),\n",
       " ('Famous Grouse Scotch', 56.93),\n",
       " ('Old Barrel', 56.9),\n",
       " ('Bacardi Black Razz', 56.89),\n",
       " ('Bacardi Pineapple Fusion', 56.89),\n",
       " ('Bacardi Wolf Berry', 56.89),\n",
       " ('Olmeca Altos Plata', 56.87),\n",
       " ('Wild Turkey 101', 56.87),\n",
       " ('Bacardi Dragon Berry', 56.75),\n",
       " ('Bacardi O', 56.75),\n",
       " ('Bacardi Peach Red', 56.75),\n",
       " ('Bacardi Razz', 56.75),\n",
       " ('Bacardi Torched Cherry', 56.75),\n",
       " ('Stolichnaya Premium Vodka 80 Proof (lv)', 56.69),\n",
       " ('Canadian Ltd Whisky Convenience Pack', 56.66),\n",
       " ('Courvoisier VS w/Flask', 56.66),\n",
       " ('Courvoisier Vs Cognac', 56.66),\n",
       " ('Desert Island Long Island Ice Tea Cocktail', 56.62),\n",
       " ('Remy Martin 1738 Accord Royal', 56.58),\n",
       " ('Pendleton Midnight', 56.49),\n",
       " ('El Mayor Blanco', 56.46),\n",
       " (\"Two Jay's Country Style Blended Why.\", 56.45),\n",
       " (\"Burnett's Gin London Dry\", 56.4),\n",
       " ('Hartley', 56.38),\n",
       " ('Hartley Brandy', 56.38),\n",
       " ('Grey Goose Vodka', 56.37),\n",
       " ('Original Gangster XO', 56.31),\n",
       " ('Mt. Gay Eclipse Rum', 56.25),\n",
       " ('Powers Irish Whiskey', 56.04),\n",
       " (\"Wiser's Rye\", 56.04),\n",
       " (\"Wiser's Spiced Vanilla\", 56.04),\n",
       " ('Chivas Regal 18 Year', 56.02),\n",
       " ('Phillips Blackberry Flav Brandy', 56.0),\n",
       " ('Sauza Blanco Silver', 55.98),\n",
       " ('Sauza Gold', 55.98),\n",
       " ('Tarantula Reposado', 55.94),\n",
       " ('Passport Scotch', 55.92),\n",
       " ('Southern Host Whiskey Liqueur', 55.89),\n",
       " ('Jose Cuervo Authentic Strawberry Margarita', 55.83),\n",
       " ('Sam Houston American Straight Whiskey', 55.77),\n",
       " ('1800 Ultimate Blueberry RTD', 55.76),\n",
       " ('1800 Ultimate Margarita', 55.76),\n",
       " ('Chivas Regal 12 Yr', 55.74),\n",
       " ('Evan Williams Str Bourbon', 55.69),\n",
       " ('Malibu Coconut Rum', 55.64),\n",
       " ('Malibu Island Melon', 55.64),\n",
       " ('Malibu Mango Rum', 55.64),\n",
       " ('Malibu Orange Float', 55.64),\n",
       " ('Malibu Passion Fruit Rum', 55.64),\n",
       " ('Malibu Pineapple Rum', 55.64),\n",
       " ('Malibu Sundae', 55.64),\n",
       " ('Malibu Sunshine', 55.64),\n",
       " ('Malibu Swirl', 55.64),\n",
       " ('Tarantula Plata 100', 55.62),\n",
       " ('Blackmaker Rootbeer', 55.58),\n",
       " ('Bacardi Gold Rum PET', 55.56),\n",
       " ('Double Cross', 55.56),\n",
       " ('Pendleton 1910', 55.56),\n",
       " ('Christian Bros Grand Reserve Vsop', 55.52),\n",
       " (\"Lauder's Scotch\", 55.51),\n",
       " (\"Lauder's Scotch Traveler\", 55.51),\n",
       " ('Evan Williams Black Label Traveler', 55.48),\n",
       " ('Smirnoff Sorbet Light Lemon', 55.48),\n",
       " ('Smirnoff Sorbet Light Mango Passion Fruit', 55.48),\n",
       " ('Smirnoff Sorbet Light Raspberry Pomegranate', 55.48),\n",
       " ('Malibu Cranberry Cherry', 55.41),\n",
       " ('Bombay Dry Gin', 55.4),\n",
       " ('Morrigan', 55.36),\n",
       " ('Black Velvet', 55.34),\n",
       " (\"Mc Gregor's Scotch\", 55.3),\n",
       " ('Knob Creek', 55.29),\n",
       " ('Wild Turkey American Honey', 55.26),\n",
       " ('El Jimador Reposado Tequila', 55.24),\n",
       " ('El Jimador Silver Tequila', 55.24),\n",
       " ('Jose Cuervo Especial Reposado Tequila', 55.22),\n",
       " ('Jose Cuervo Especial Silver', 55.22),\n",
       " ('Smirnoff Blueberry Vodka', 55.2),\n",
       " ('Smirnoff Cherry Vodka', 55.2),\n",
       " ('Smirnoff Citrus Vodka', 55.2),\n",
       " ('Smirnoff Coconut', 55.2),\n",
       " ('Smirnoff Cranberry Vodka', 55.2),\n",
       " ('Smirnoff Fluffed Marshmallow', 55.2),\n",
       " ('Smirnoff Grape Vodka', 55.2),\n",
       " ('Smirnoff Green Apple Vodka', 55.2),\n",
       " ('Smirnoff Iced Cake', 55.2),\n",
       " ('Smirnoff Kissed Caramel', 55.2),\n",
       " ('Smirnoff Lime Vodka', 55.2),\n",
       " ('Smirnoff Orange Vodka', 55.2),\n",
       " ('Smirnoff Passion Fruit Vodka', 55.2),\n",
       " ('Smirnoff Peach Vodka', 55.2),\n",
       " ('Smirnoff Pineapple Vodka', 55.2),\n",
       " ('Smirnoff Pomegranate Vodka', 55.2),\n",
       " ('Smirnoff Raspberry Vodka', 55.2),\n",
       " ('Smirnoff Strawberry Vodka', 55.2),\n",
       " ('Smirnoff Vanilla Vodka', 55.2),\n",
       " ('Smirnoff Vodka 80 Prf', 55.2),\n",
       " ('Smirnoff Vodka Traveller', 55.2),\n",
       " ('Smirnoff Watermelon Vodka', 55.2),\n",
       " ('Smirnoff Whipped Cream', 55.2),\n",
       " ('Jose Cuervo Golden Margarita', 55.16),\n",
       " ('Evan Williams Yr Str Bourbon', 55.14),\n",
       " ('Three Olives Marilyn Monroe Strawberry', 55.12),\n",
       " ('Azul Reposado', 55.1),\n",
       " ('Red Stag Honey Tea', 55.09),\n",
       " ('Red Stag Spiced', 55.09),\n",
       " ('Midori Melon Liqueur', 55.07),\n",
       " ('Glenfiddich 12yr Special Reserve', 55.04),\n",
       " ('Kessler Blend Whiskey', 55.04),\n",
       " ('Skol Vodka', 55.04),\n",
       " ('Red Stag By Jim Beam', 55.03),\n",
       " ('Red Stag Hardcore Cider', 55.03),\n",
       " ('Bacardi Mango Fusion', 55.01),\n",
       " ('Pinnacle Gin', 55.0),\n",
       " ('Seagrams 7 Crown Bl Whiskey', 54.97),\n",
       " ('Three Olives Tartz', 54.97),\n",
       " ('Paramount Creme De Menthe/green', 54.95),\n",
       " ('Evan Williams Traveler', 54.92),\n",
       " ('Three Olives \"dude\" Vodka', 54.92),\n",
       " ('Three Olives Berry Vodka', 54.92),\n",
       " ('Three Olives Bubble Vodka', 54.92),\n",
       " ('Three Olives Cake Flavored Vodka', 54.92),\n",
       " ('Three Olives Cherry Vodka', 54.92),\n",
       " ('Three Olives Chocolate Vodka', 54.92),\n",
       " ('Three Olives Grape Vodka', 54.92),\n",
       " ('Three Olives Loopy Flavored Vodka', 54.92),\n",
       " ('Three Olives Mango Flavored Vodka', 54.92),\n",
       " ('Three Olives Orange Vodka', 54.92),\n",
       " ('Three Olives Pomegranate Vodka', 54.92),\n",
       " ('Three Olives Purple Vodka', 54.92),\n",
       " ('Three Olives Rangtang', 54.92),\n",
       " ('Three Olives Raspberry Vodka', 54.92),\n",
       " ('Three Olives Smores', 54.92),\n",
       " ('Three Olives Supercola Flavored Vodka', 54.92),\n",
       " ('Three Olives Vanilla Vodka', 54.92),\n",
       " ('Three Olives Whipped Cream', 54.92),\n",
       " ('Christian Bros Brandy Traveler', 54.89),\n",
       " ('Phillips Lime Flavored Vodka', 54.73),\n",
       " ('Dewars White Label Scotch', 54.61),\n",
       " ('Mr. Boston Apricot Brandy', 54.61),\n",
       " ('Mr. Boston Blackberry Brandy', 54.61),\n",
       " ('Highland Park 12yr Single Malt Scotch', 54.59),\n",
       " ('2 Gingers', 54.56),\n",
       " ('2 Gingers w/2 Glasses', 54.56),\n",
       " ('El Jimador Anejo Tequila', 54.48),\n",
       " (\"Fleischmann's Royal Vodka\", 54.43),\n",
       " ('Gentleman Jack', 54.43),\n",
       " ('Glenlivet 15 Year French Oak', 54.42),\n",
       " ('Metaxa Ouzo', 54.42),\n",
       " ('Chambord Liqueur Royale De France', 54.4),\n",
       " ('Juarez Tequila Gold', 54.31),\n",
       " ('Juarez Tequila Silver', 54.31),\n",
       " ('Mc Guires Original Cream Liqueur', 54.31),\n",
       " ('Licor 43', 54.27),\n",
       " ('Licor 43 w/2 Cocktail Glasses', 54.27),\n",
       " (\"Chi-Chi's Gold Margarita\", 54.26),\n",
       " (\"Chi-Chi's Long Island Iced Tea\", 54.26),\n",
       " (\"Chi-Chi's Margarita W/tequila\", 54.26),\n",
       " (\"Chi-Chi's Mexican Mudslide\", 54.26),\n",
       " (\"Chi-Chi's Pina Colada W/rum\", 54.26),\n",
       " (\"Chi-Chi's Skinny Long Island Iced Tea\", 54.26),\n",
       " (\"Chi-Chi's Skinny Margarita\", 54.26),\n",
       " (\"Chi-Chi's Strawberry Margarita W/tequila\", 54.26),\n",
       " (\"Chi-Chi's White Russian\", 54.26),\n",
       " ('Cruzan Orange', 54.25),\n",
       " ('Pucker Vodka Citrus Squeeze', 54.23),\n",
       " ('Pucker Vodka Grape Gone Wild', 54.23),\n",
       " ('Pucker Vodka Lemonade Lust', 54.23),\n",
       " ('Pucker Vodka Raspberry Rave', 54.23),\n",
       " ('Pucker Vodka Sour Apple Sass', 54.23),\n",
       " ('Pucker Vodka Wild Cherry Tease', 54.23),\n",
       " ('B&b D.o.m.', 54.17),\n",
       " (\"Chi-Chi's Chocolate Malt\", 54.17),\n",
       " (\"Chi-Chi's Churro\", 54.17),\n",
       " (\"Chi-Chi's Orange Cream\", 54.17),\n",
       " (\"Chi-Chi's Pineapple Margarita\", 54.17),\n",
       " (\"Chi-Chi's Ruby Red Margarita\", 54.17),\n",
       " ('Grangala Triple Orange Liqueur', 54.13),\n",
       " ('Jim Beam w/ Barbecue Sauce', 54.12),\n",
       " ('McClelland Islay', 54.12),\n",
       " ('McClelland Speyside Scotch', 54.12),\n",
       " ('Mcclelland Highland', 54.12),\n",
       " ('Woodford Reserve Bourbon', 54.11),\n",
       " ('Black Velvet Cinnamon Rush', 54.08),\n",
       " ('Black Velvet Toasted Caramel', 54.08),\n",
       " ('Remy Martin Vsop (flask)', 54.08),\n",
       " ('Herradura Blanco Silver 6x6 Tequila', 54.07),\n",
       " ('Herradura Silver', 54.07),\n",
       " ('Old Forester Bourbon', 54.05),\n",
       " ('Black Velvet Traveler', 54.04),\n",
       " ('Cruzan Blueberry Lemonade', 54.03),\n",
       " ('Cruzan Peach', 54.03),\n",
       " ('Beefeater Gin', 53.94),\n",
       " ('Drambuie Liqueur', 53.93),\n",
       " ('Black Velvet Reserve', 53.92),\n",
       " ('Appleton Signature Blend', 53.9),\n",
       " ('Evan Williams Vintage', 53.81),\n",
       " ('Johnnie Walker Red', 53.77),\n",
       " (\"Fleischmann's Royal Vodka 80 Prf\", 53.74),\n",
       " ('Glenlivet 16yr Nadurra', 53.69),\n",
       " ('Crown Royal', 53.67),\n",
       " ('Crown Royal Maple', 53.67),\n",
       " ('Absolut Unique', 53.66),\n",
       " ('Absolut Apeach', 53.65),\n",
       " ('Absolut Berri Acai', 53.65),\n",
       " ('Absolut Cherrykran', 53.65),\n",
       " ('Absolut Citron (lemon Vodka)', 53.65),\n",
       " ('Absolut Grapevine', 53.65),\n",
       " ('Absolut Kurant', 53.65),\n",
       " ('Absolut Mandrin', 53.65),\n",
       " ('Absolut Mango Vodka', 53.65),\n",
       " ('Absolut Orient Apple', 53.65),\n",
       " ('Absolut Pears', 53.65),\n",
       " ('Absolut Peppar', 53.65),\n",
       " ('Absolut Raspberri', 53.65),\n",
       " ('Absolut Ruby Red', 53.65),\n",
       " ('Absolut Swedish Vodka 80 Prf', 53.65),\n",
       " ('Absolut Vanilia', 53.65),\n",
       " ('Absolut Wild Tea', 53.65),\n",
       " ('Smirnoff Vodka 80 Prf Pet', 53.63),\n",
       " ('Glenlivet 12 Yr Malt Scotch', 53.6),\n",
       " ('Jose Cuervo Tradicional Reposado Tequila', 53.6),\n",
       " ('The Glenlivet w/50ml 15YR & 18YR', 53.6),\n",
       " ('Absolut Hibiskus', 53.56),\n",
       " ('Absolut Chicago', 53.54),\n",
       " ('Absolut Cilantro', 53.54),\n",
       " ('Absolut Texas', 53.54),\n",
       " ('Phillips Long Island Iced Tea', 53.52),\n",
       " ('Phillips White Rum', 53.33),\n",
       " ('Phillips Gin', 53.29),\n",
       " ('Smirnoff Amaretto', 53.29),\n",
       " ('Smirnoff Cinna-Sugar Twist', 53.29),\n",
       " ('Smirnoff Wild Honey', 53.29),\n",
       " ('Lucid Absinthe', 53.28),\n",
       " ('Three Olives w/Cholula', 53.27),\n",
       " ('Jose Cuervo Authentic Grapefruit Tangerine Margarita', 53.25),\n",
       " ('Jose Cuervo Authentic Light Margarita Lime', 53.25),\n",
       " ('Jose Cuervo Authentic Pomegranate Margarita', 53.25),\n",
       " ('Jose Cuervo Authentic Watermelon Margarita', 53.25),\n",
       " ('Jose Cuervo Light Wild Berry Margarita', 53.25),\n",
       " ('Jose Cuervo Mango Margarita', 53.25),\n",
       " ('Quadro Russian Vodka', 53.25),\n",
       " ('Gold Rush Liqueur', 53.2),\n",
       " ('Jameson', 53.03),\n",
       " ('Captain Morgan Original Spiced', 52.97),\n",
       " ('Captain Morgan Original Spiced Rum Pet', 52.97),\n",
       " ('Ten High', 52.97),\n",
       " ('Captain Morgan Spiced Barrel', 52.96),\n",
       " ('Captain Morgan Spiced Rum', 52.96),\n",
       " ('Grey Goose La Poire Vodka', 52.89),\n",
       " ('Grey Goose Le Citron', 52.89),\n",
       " ('Grey Goose Le Melon', 52.89),\n",
       " ('Jameson Irish Whiskey Tin', 52.85),\n",
       " ('Firewater Cinnamon Schnapps', 52.83),\n",
       " ('Ice 101, Peppermint Schnapps', 52.83),\n",
       " ('Mr. Boston Five Star Brandy Veq', 52.76),\n",
       " ('Absolut Vodka 100 Premium', 52.75),\n",
       " ('Ice Hole Butterscotch Schnapps', 52.65),\n",
       " ('Ice Hole Cherry Schnapps', 52.65),\n",
       " ('Ice Hole Mint Schnapps', 52.65),\n",
       " ('Ice Hole Plum Schnapps', 52.65),\n",
       " ('Trader Vics Private Selection Spiced Rum', 52.63),\n",
       " (\"Maker's Mark\", 52.5),\n",
       " ('Cabrito Blanco', 52.48),\n",
       " ('Cabrito Reposado', 52.48),\n",
       " ('UV Vodka', 52.48),\n",
       " ('Beefeater w/Yeoman Pourer', 52.41),\n",
       " ('Ursus Green Apple Vodka', 52.39),\n",
       " ('Ursus Vodka', 52.39),\n",
       " ('Midnight Moon Cinnamon', 52.38),\n",
       " ('Macallan 12yr Scotch Mini', 52.35),\n",
       " (\"Lauder's\", 52.34),\n",
       " ('Smirnoff Melon Vodka', 52.31),\n",
       " ('Chivas Regal w/2 Glasses', 52.14),\n",
       " ('Tanqueray Gin', 52.09),\n",
       " ('UV Peach', 52.07),\n",
       " ('UV Salty Watermelon', 52.07),\n",
       " ('Hornitos Gold', 52.02),\n",
       " ('Hornitos Plata', 52.02),\n",
       " (\"Bailey's Hazelnut Irish Cream\", 52.0),\n",
       " (\"Bailey's Vanilla Cinnamon\", 52.0),\n",
       " ('UV Candy Bar', 52.0),\n",
       " ('UV Chocolate Cake', 52.0),\n",
       " ('UV Ruby Red Grapefruit', 52.0),\n",
       " ('UV Salty Caramel Apple', 52.0),\n",
       " ('UV Sriracha', 52.0),\n",
       " ('UV Sugar Crush', 52.0),\n",
       " ('UV Whipped', 52.0),\n",
       " ('Uv Blue Raspberry Vodka Traveller', 52.0),\n",
       " ('Uv Citruv (citrus) Vodka', 52.0),\n",
       " ('Uv Coconut Vodka', 52.0),\n",
       " ('Uv Green (apple) Vodka', 52.0),\n",
       " ('Uv Ivory (vanilla) Vodka', 52.0),\n",
       " ('Uv Orange Vodka', 52.0),\n",
       " ('Uv Pink Lemonade Vodka', 52.0),\n",
       " ('Uv Vodka', 52.0),\n",
       " (\"Bailey's Coffee Irish Cream\", 51.92),\n",
       " (\"Bailey's Mint Chocolate Irish Cream\", 51.92),\n",
       " (\"Bailey's Original Irish Cream\", 51.92),\n",
       " (\"Bailey's Salted Caramel\", 51.92),\n",
       " ('Remy Martin Vsop Cognac', 51.89),\n",
       " ('Smirnoff Vanilla', 51.85),\n",
       " ('UV Espresso Vodka', 51.84),\n",
       " ('Glenfiddich 15 Yr Solera Reserva', 51.57),\n",
       " ('Captain Morgan Spiced Rum Pet', 51.49),\n",
       " ('Bushmills Irish Whiskey', 51.43),\n",
       " ('Milagro Tequila Sbr Silver', 51.15),\n",
       " ('Jose Cuervo Especial Max Pack', 51.12),\n",
       " ('Bacardi Black Razz Miniature', 50.91),\n",
       " ('Chopin Vodka', 50.87),\n",
       " ('Johnnie Walker Black', 50.58),\n",
       " ('99 Bananas', 50.56),\n",
       " ('Barton Gin', 50.56),\n",
       " ('Barton Light Rum', 50.56),\n",
       " ('Canadian LTD', 50.56),\n",
       " ('Canadian Ltd', 50.56),\n",
       " ('Fireball Cinnamon', 50.56),\n",
       " ('Fireball Cinnamon Whisky', 50.56),\n",
       " ('Platinum 7x Vodka', 50.56),\n",
       " ('Seagrams Extra Dry Gin', 50.52),\n",
       " ('E & J Vs Grand Amber Brandy', 50.51),\n",
       " ('Jim Beam Apple', 50.48),\n",
       " ('Jim Beam Honey', 50.48),\n",
       " ('Jim Beam Kentucky Fire', 50.48),\n",
       " ('Barton Vodka', 50.44),\n",
       " (\"Five O'Clock Vodka\", 50.44),\n",
       " (\"Five O'clock Vodka\", 50.44),\n",
       " ('McCormick Apple Vodka', 50.44),\n",
       " ('McCormick Peach Vodka', 50.44),\n",
       " ('Mccormick Vodka', 50.44),\n",
       " ('Nikolai Vodka', 50.44),\n",
       " (\"Beam's 8 Star Bl Whiskey\", 50.43),\n",
       " ('Hawkeye Vodka', 50.43),\n",
       " ('Jose Cuervo Especial Silver Mini', 50.43),\n",
       " ('Parrot Bay Pina Colada', 50.42),\n",
       " ('Parrot Bay Tropical Rum Punch', 50.42),\n",
       " ('Jim Beam Peach', 50.4),\n",
       " ('Jim Beam Vanilla', 50.4),\n",
       " ('Southern Comfort', 50.4),\n",
       " ('Five Star', 50.38),\n",
       " ('E & J Peach Brandy', 50.34),\n",
       " ('Jack Daniels Black Label', 50.33),\n",
       " ('Popov Vodka 80 Prf', 50.33),\n",
       " (\"Coulson's Vodka PET\", 50.3),\n",
       " ('Malibu 50ml Counter Unit', 50.3),\n",
       " ('Pennsylvania Dutch Egg Nog', 50.3),\n",
       " ('Jagermeister Liqueur', 50.29),\n",
       " ('Phillips Vodka', 50.29),\n",
       " ('Phillips Vodka Ez Pack', 50.29),\n",
       " ('Popov 80prf', 50.29),\n",
       " ('Blue Ox Vodka', 50.28),\n",
       " ('Paul Masson Grande Amber Brandy', 50.28),\n",
       " ('Absolut w/4-50mls', 50.27),\n",
       " ('E & J Vs Brandy', 50.27),\n",
       " ('Juarez Gold', 50.27),\n",
       " ('Juarez Gold Tequila', 50.27),\n",
       " ('Arrow Gin', 50.25),\n",
       " (\"Arrow Mcdale's Butterscotch Schnapps\", 50.25),\n",
       " ('Arrow Peach Schnapps', 50.25),\n",
       " ('Arrow Raspberry Schnapps', 50.25),\n",
       " ('Arrow Spearmint Schnapps', 50.25),\n",
       " (\"Five O'Clock Gin\", 50.25),\n",
       " (\"Five O'clock Gin\", 50.25),\n",
       " ('New Amsterdam 80prf', 50.25),\n",
       " ('New Amsterdam Apple', 50.25),\n",
       " ('New Amsterdam Gin', 50.25),\n",
       " ('New Amsterdam Grapefruit', 50.25),\n",
       " ('New Amsterdam Mango', 50.25),\n",
       " ('New Amsterdam Peach', 50.25),\n",
       " ('New Amsterdam Pineapple', 50.25),\n",
       " ('New Amsterdam Raspberry', 50.25),\n",
       " ('New Amsterdam Red Berry', 50.25),\n",
       " ('Paramount Butterscotch Schnapps', 50.25),\n",
       " ('Paramount Gin', 50.25),\n",
       " ('Paramount Peach Schnapps', 50.25),\n",
       " ('Paramount Strawberry Schnapps', 50.25),\n",
       " ('Seagrams 7 Crown', 50.25),\n",
       " ('Caliber Vodka', 50.24),\n",
       " ('Cold Spell Mint Mini', 50.24),\n",
       " ('E & J Vsop Superior Reserve', 50.24),\n",
       " ('Dekuyper Triple Sec', 50.23),\n",
       " ('Juarez Triple Sec', 50.23),\n",
       " ('Montezuma Triple Sec', 50.23),\n",
       " ('Mr. Boston Triple Sec', 50.23),\n",
       " ('Arrow Peppermint Schnapps', 50.22),\n",
       " ('Paramount Creme De Almond', 50.22),\n",
       " ('Paramount Creme De Cacao White', 50.22),\n",
       " ('Paramount Creme De Cacao/dark', 50.22),\n",
       " ('Paramount Creme De Cacao/white', 50.22),\n",
       " ('Paramount Peppermint Schnapps', 50.22),\n",
       " ('Shady Fruit Real Ruby Red Grapefruit Mini', 50.21),\n",
       " ('Shady Fruit Real Valencia Orange Mini', 50.21),\n",
       " ('Southern Comfort Mini', 50.21),\n",
       " ('E & J VSOP', 50.2),\n",
       " ('New Amsterdam', 50.2),\n",
       " ('New Amsterdam Apple Vodka', 50.2),\n",
       " ('Paramount Rock & Rye', 50.2),\n",
       " ('Paramount Sloe Gin', 50.2),\n",
       " (\"Allen's Coffee Brandy\", 50.19),\n",
       " ('Hennessy VS', 50.19),\n",
       " ('Grand Macnish', 50.18),\n",
       " ('Kah Anejo Mini', 50.18),\n",
       " ('Absolut Citron', 50.17),\n",
       " ('Absolut Swedish Vodka 80prf', 50.17),\n",
       " ('Canadian Mist Whisky', 50.17),\n",
       " ('Conciere Amaretto', 50.17),\n",
       " ('Malibu Counter Unit', 50.17),\n",
       " ('Tortilla Triple Sec', 50.17),\n",
       " ('Trave Amaretto', 50.17),\n",
       " ('Windsor Canadian', 50.17),\n",
       " ('Windsor Canadian Supreme Whisky', 50.17),\n",
       " ('Alize Gold Passion', 50.16),\n",
       " ('Bols Triple Sec 30prf', 50.16),\n",
       " ('Caliber Gin', 50.16),\n",
       " ('Dekuyper Peachtree Schnapps', 50.16),\n",
       " ('Paul Masson Peach Grande Amber Brandy', 50.16),\n",
       " ('Tortilla Gold Tequila', 50.16),\n",
       " ('Tortilla White Tequila', 50.16),\n",
       " ('Amaretto E Dolce', 50.15),\n",
       " ('Bacardi Multi-Flavor Mini 6 Pack', 50.15),\n",
       " ('Barton Vodka PET', 50.15),\n",
       " ('Barton Vodka Pet', 50.15),\n",
       " ('Caliber Citrus Vodka', 50.15),\n",
       " ('Fireball', 50.15),\n",
       " ('Fireball Cinnamon Whiskey', 50.15),\n",
       " (\"Five O'Clock Vodka PET\", 50.15),\n",
       " (\"Five O'clock PET Vodka\", 50.15),\n",
       " ('Hawkeye Blend Whiskey', 50.15),\n",
       " ('Hawkeye Gin', 50.15),\n",
       " ('Hiram Walker Triple Sec 30prf', 50.15),\n",
       " ('Paramount Amaretto', 50.15),\n",
       " ('Paramount Apricot Flavored Brandy', 50.15),\n",
       " ('Paramount Blackberry Brandy', 50.15),\n",
       " ('Paramount Dragon Fruit Vodka', 50.15),\n",
       " ('Paramount Gin Traveler', 50.15),\n",
       " ('Paramount Triple Sec', 50.15),\n",
       " (\"Trader Vic's Mai Tai\", 50.15),\n",
       " ('Wisconsin Club Vodka', 50.15),\n",
       " ('Balvenie Trio Pack(12/14/17)', 50.14),\n",
       " ('Blue Ox Vodka PET', 50.14),\n",
       " ('Club Cocktails Brass Monkey', 50.14),\n",
       " ('Courvoisier Vs Coganc', 50.14),\n",
       " ('E & J Apple', 50.14),\n",
       " ('E & J Apple Brandy', 50.14),\n",
       " ('E & J Peach', 50.14),\n",
       " ('E & J VS', 50.14),\n",
       " ('Jack Daniels Old #7 Black Lbl', 50.14),\n",
       " ('Jim Beam 100ml Tri-Pack', 50.14),\n",
       " ('Jinro Chamisul Classic Soju', 50.14),\n",
       " ('Jinro Chamisul Soju', 50.14),\n",
       " ('Kahlua Sampler Pack', 50.14),\n",
       " ('Lady Bligh Spiced Rum Mini', 50.14),\n",
       " ('Maui Blue Hawaiian Schnapps', 50.14),\n",
       " ('Maui Tropical Schnapps', 50.14),\n",
       " ('Mr. Boston Egg Nog', 50.14),\n",
       " (\"Old St. Nick''s Egg Nog\", 50.14),\n",
       " ('Paramount Apricot Brandy', 50.14),\n",
       " ('Paramount Cherry Brandy', 50.14),\n",
       " ('Purple Passion 4 Pack', 50.14),\n",
       " ('Row Vodka Mini', 50.14),\n",
       " (\"Salvador's Margarita 4pak\", 50.14),\n",
       " (\"Salvador's Strawberry Margarita 200ml-4Pack\", 50.14),\n",
       " ('Salvadors Margarita 4pk', 50.14),\n",
       " (\"Shaker's Original American Vodka\", 50.14),\n",
       " (\"Shaker's Rye Vodka\", 50.14),\n",
       " ('Sobieski Espresso', 50.14),\n",
       " ('Sunny Brook Blend Whiskey', 50.14),\n",
       " ('Titos Handmade Vodka', 50.14),\n",
       " ('UV Blue Raspberry', 50.14),\n",
       " ('Uv Blue Raspberry Lemonade Pet', 50.14),\n",
       " ('Uv Pink Lemonade Cocktail Pet', 50.14),\n",
       " ('Absolut Mini Bar', 50.13),\n",
       " ('Absolut Mini Trial Pack', 50.13),\n",
       " ('Arrow Sloe Gin', 50.13),\n",
       " ('Barton Rum Light', 50.13),\n",
       " ('Bols Triple Sec', 50.13),\n",
       " ('Don Q Limon', 50.13),\n",
       " ('Everclear 151', 50.13),\n",
       " ('Hawkeye Vodka 80 Prf Mini', 50.13),\n",
       " ('Hiram Walker Black Raspberry', 50.13),\n",
       " ('Hiram Walker Caramel Apple', 50.13),\n",
       " ('Hiram Walker Pomegranate Schnapps', 50.13),\n",
       " ('Hiram Walker Pumpkin Spice', 50.13),\n",
       " ('Martell Vs Cognac', 50.13),\n",
       " ('Mr Boston Vodka', 50.13),\n",
       " ('Mr. Boston Riva', 50.13),\n",
       " ('Mr. Boston Riva Vodka', 50.13),\n",
       " ('Mr. Boston Vodka', 50.13),\n",
       " ('Paramount Blue Curacao', 50.13),\n",
       " ('Paramount Long Island Iced Tea', 50.13),\n",
       " ('Paramount Peppermint Schnapps Traveler', 50.13),\n",
       " ('Purple Passion', 50.13),\n",
       " ('Stoli Variety Mini Bar', 50.13),\n",
       " ('Wisconsin Club', 50.13),\n",
       " ('Wisconsin Club Gin', 50.13),\n",
       " ('American Harvest Organic Spirit', 50.12),\n",
       " ('Bacardi Mango Fusion Mini', 50.12),\n",
       " ('Barton Long Island Iced Tea', 50.12),\n",
       " (\"Burnett's Blue Raspberry Vodka Mini\", 50.12),\n",
       " (\"Burnett's Blueberry Vodka\", 50.12),\n",
       " (\"Burnett's Citrus Vodka Mini\", 50.12),\n",
       " (\"Burnett's Mango Pineapple Mini\", 50.12),\n",
       " (\"Burnett's Peach Vodka Miniature\", 50.12),\n",
       " (\"Burnett's Pink Lemonade Vodka Mini\", 50.12),\n",
       " (\"Burnett's Ruby Red Grapefruit Mini\", 50.12),\n",
       " (\"Burnett's Sugar Cookie Mini\", 50.12),\n",
       " (\"Burnett's Tropical Fruit Vodka Mini\", 50.12),\n",
       " (\"Burnett's Vodka Miniature\", 50.12),\n",
       " (\"Burnett's Whipped Cream Vodka Mini\", 50.12),\n",
       " ('Burnetts Appleberry Mini', 50.12),\n",
       " ('Burnetts Cherry Limeade Mini', 50.12),\n",
       " ('Burnetts Pink Lemonade Mini', 50.12),\n",
       " ('Canadian Reserve Whisky', 50.12),\n",
       " ('Cinerator Mini', 50.12),\n",
       " ('Cold Spell Mint Whiskey Mini', 50.12),\n",
       " ('Crown Royal Regal Apple', 50.12),\n",
       " ('Deep Eddy Lemon Mini', 50.12),\n",
       " ('Deep Eddy Orange Mini', 50.12),\n",
       " ('Deep Eddy Ruby Red Mini', 50.12),\n",
       " ('Dekuyper Apricot Brandy', 50.12),\n",
       " ('Dekuyper Blackberry Brandy', 50.12),\n",
       " ('Evan Williams Cherry Mini', 50.12),\n",
       " ('Evan Williams Cinnamon Reserve Mini', 50.12),\n",
       " ('Evan Williams Fire Mini', 50.12),\n",
       " ('Evan Williams Honey Mini', 50.12),\n",
       " (\"Gordon's Gin Minis\", 50.12),\n",
       " ('Hawkeye Vodka Mini', 50.12),\n",
       " ('Hennessy Vs Cognac', 50.12),\n",
       " (\"Jack Daniel's Tennessee Honey Mini\", 50.12),\n",
       " ('Jack Daniels Old #7 Black Label', 50.12),\n",
       " ('Jack Daniels Old #7 Black Lbl Mini', 50.12),\n",
       " ('Kah Blanco Mini', 50.12),\n",
       " ('Kentucky Tavern', 50.12),\n",
       " ('McCormick Gin', 50.12),\n",
       " ('McCormick Vodka', 50.12),\n",
       " ('Mccormick Rum Silver', 50.12),\n",
       " ('Mccormick Vodka PET', 50.12),\n",
       " ('Mothers Schnapps Butterscotch', 50.12),\n",
       " ('Mr Boston Apricot Brandy', 50.12),\n",
       " ('Mr Boston Blackberry Brandy', 50.12),\n",
       " ('Old Crow', 50.12),\n",
       " ('Old Crow Traveler', 50.12),\n",
       " ('Paramount Gold Rum', 50.12),\n",
       " ('Paramount Vodka', 50.12),\n",
       " ('Paramount White Rum', 50.12),\n",
       " ('Paramount White Rum Traveler', 50.12),\n",
       " ('Rich & Rare Canadian Whisky', 50.12),\n",
       " ('Ron Viejo De Caldas', 50.12),\n",
       " ('Skinnygirl Margarita Mini', 50.12),\n",
       " (\"Two Jay's Grappa\", 50.12),\n",
       " ('Wild Turkey 101 Mini', 50.12),\n",
       " ('Wisconsin Club Spiced Rum', 50.12),\n",
       " ('Wisconsin Club White Rum', 50.12),\n",
       " ('Arrow Peppermint Schnapps Mini', 50.11),\n",
       " ('Bols Triple Sec 30', 50.11),\n",
       " (\"Burnett's Citrus Vodka\", 50.11),\n",
       " (\"Burnett's Mango\", 50.11),\n",
       " (\"Burnett's Orange Cream Vodka\", 50.11),\n",
       " (\"Burnett's Peach Vodka\", 50.11),\n",
       " (\"Burnett's Pear\", 50.11),\n",
       " (\"Burnett's Pineapple Vodka\", 50.11),\n",
       " (\"Burnett's Pink Lemonade\", 50.11),\n",
       " (\"Burnett's Pomegranate\", 50.11),\n",
       " (\"Burnett's Sour Apple\", 50.11),\n",
       " (\"Burnett's Strawberry\", 50.11),\n",
       " ('Canadian Hunter Whisky DNO', 50.11),\n",
       " ('Christian Bros Holiday Nog', 50.11),\n",
       " ('Christian Brothers Holiday Nog', 50.11),\n",
       " ('Conciere Blended Whiskey', 50.11),\n",
       " ('Crown Royal Canadian Whisky', 50.11),\n",
       " ('Crystal Head Vodka Mini', 50.11),\n",
       " ('Dubouchett Blackberry Brandy', 50.11),\n",
       " ('Dubouchett Polish Blackberry Brandy', 50.11),\n",
       " ('Evan Williams Egg Nog', 50.11),\n",
       " ('Ezra Brooks Bourbon Cream Mini', 50.11),\n",
       " (\"Five O'Clock Rum\", 50.11),\n",
       " (\"Five O'clock\", 50.11),\n",
       " (\"Gilbey's Gin London Dry\", 50.11),\n",
       " (\"Gilbey's Gin London Dry Traveler\", 50.11),\n",
       " ('Grays Peak Vodka Mini', 50.11),\n",
       " ('Grey Goose', 50.11),\n",
       " ('Hawkeye Blended Whiskey', 50.11),\n",
       " ('Heaven Hill Old Style Green 90', 50.11),\n",
       " ('Hiram Walker Apricot Brandy', 50.11),\n",
       " ('Hiram Walker Blackberry Brandy', 50.11),\n",
       " ('Hiram Walker Mango Schnapps', 50.11),\n",
       " ('Hiram Walker Orange Curacao', 50.11),\n",
       " ('Hiram Walker Orange Curaco', 50.11),\n",
       " ('Iowa Coffee Company Liqueur', 50.11),\n",
       " ('J. W. Dant Scotch', 50.11),\n",
       " ('Jeremiah Weed Peach Sweet Tea', 50.11),\n",
       " ('Jeremiah Weed Sweet Tea Vodka', 50.11),\n",
       " ('Juarez Gold Dss', 50.11),\n",
       " ('Kentucky Gentleman Bourbon', 50.11),\n",
       " (\"Lauder''s Scotch Mini\", 50.11),\n",
       " ('Lord Calvert Spiced Peach Whisky Mini', 50.11),\n",
       " ('Margaritaville Coconut Jamaican Rum', 50.11),\n",
       " ('Margaritaville Dark Jamaican Rum', 50.11),\n",
       " ('Margaritaville Spiced Jamaican Rum', 50.11),\n",
       " ('McCormick Vodka Mini', 50.11),\n",
       " ('Paramount Anisette', 50.11),\n",
       " ('Paramount Creme De Menthe/white', 50.11),\n",
       " ('Paramount Creme de Menthe White', 50.11),\n",
       " ('Paramount Creme de Menthe White DISCO', 50.11),\n",
       " ('Phillips Apricot Flav Brandy', 50.11),\n",
       " ('Remy Martin V', 50.11),\n",
       " ('Rondiaz Mini', 50.11),\n",
       " ('Rondiaz Rum Spiced Black Cherry Mini', 50.11),\n",
       " ('Rondiaz Rum White Mini', 50.11),\n",
       " ('Rondiaz Spiced Apple Mini', 50.11),\n",
       " ('Smirnoff 100prf', 50.11),\n",
       " ('Smirnoff 80prf', 50.11),\n",
       " ('Smirnoff Citrus', 50.11),\n",
       " ('Smirnoff Green Apple', 50.11),\n",
       " ('Smirnoff Orange', 50.11),\n",
       " ('Smirnoff Raspberry', 50.11),\n",
       " ('Smirnoff Strawberry', 50.11),\n",
       " ('Smirnoff Watermelon', 50.11),\n",
       " ('Svedka', 50.11),\n",
       " ('Tortilla Gold Dss', 50.11),\n",
       " ('Tortilla Silver Dss', 50.11),\n",
       " ('Windmill Rye Whiskey', 50.11),\n",
       " ('Windsor Canadian PET', 50.11),\n",
       " ('Windsor Canadian Traveler', 50.11),\n",
       " ('360 Mandarin Orange Vodka Mini', 50.1),\n",
       " ('360 Sorrento Lemon Vodka Mini', 50.1),\n",
       " ('Amaretto Di Amore Minis', 50.1),\n",
       " ('Arrow Apricot Flav Brandy', 50.1),\n",
       " ('Arrow Blackberry Flav Brandy', 50.1),\n",
       " ('Arrow Ginger Flav Brandy', 50.1),\n",
       " ('Arrow Wild Cherry Flav Brandy', 50.1),\n",
       " ('Bird Dog Blackberry Lemonade', 50.1),\n",
       " ('Bird Dog Blackberry Lemonade RTD', 50.1),\n",
       " ('Bird Dog Ruby Red Grapefruit Margarita', 50.1),\n",
       " ...]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Here I only get the category name, but potentially I need to get the item description, like which brand\n",
    "# this is good for presentation visualization\n",
    "sorted(markup_rate_by_alcohol_list, key = lambda x:x[1], reverse = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# sorted(markup_rate_by_alcohol, reverse = True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Get The Most Profitable Liquor Category Names (at Category Level) within Transactions of Top 15 Stores\n",
    "In this part, I need to aggregate all transactions at Category level, then sum up all the markup/cost to calculate the markup rate at the category level. So we can see how the markup rate ranks across different categories in a fair way."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Invoice/Item Number</th>\n",
       "      <th>Date</th>\n",
       "      <th>Store Number</th>\n",
       "      <th>Store Name</th>\n",
       "      <th>Address</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Store Location</th>\n",
       "      <th>County Number</th>\n",
       "      <th>County</th>\n",
       "      <th>Category</th>\n",
       "      <th>Category Name</th>\n",
       "      <th>Vendor Number</th>\n",
       "      <th>Vendor Name</th>\n",
       "      <th>Item Number</th>\n",
       "      <th>Item Description</th>\n",
       "      <th>Pack</th>\n",
       "      <th>Bottle Volume (ml)</th>\n",
       "      <th>State Bottle Cost</th>\n",
       "      <th>State Bottle Retail</th>\n",
       "      <th>Bottles Sold</th>\n",
       "      <th>Sale (Dollars)</th>\n",
       "      <th>Volume Sold (Liters)</th>\n",
       "      <th>Volume Sold (Gallons)</th>\n",
       "      <th>Year_Week</th>\n",
       "      <th>Year_Month</th>\n",
       "      <th>Year_Quarter</th>\n",
       "      <th>Year</th>\n",
       "      <th>Markup Per Bottle</th>\n",
       "      <th>Markup Per Transaction</th>\n",
       "      <th>Cost Per Transaction</th>\n",
       "      <th>Markup Rate Per Item</th>\n",
       "      <th>Shortened Store Name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>S03392200005</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4578</td>\n",
       "      <td>Casey's General</td>\n",
       "      <td>201 S 4TH ST</td>\n",
       "      <td>FARMINGTON</td>\n",
       "      <td>52626</td>\n",
       "      <td>POINT (-91.740069 40.639743)</td>\n",
       "      <td>89</td>\n",
       "      <td>van buren</td>\n",
       "      <td>1011100</td>\n",
       "      <td>BLENDED WHISKIES</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>25606</td>\n",
       "      <td>Seagrams 7 Crown Bl Whiskey</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>6.14</td>\n",
       "      <td>9.21</td>\n",
       "      <td>12.0</td>\n",
       "      <td>110.52</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.07</td>\n",
       "      <td>36.84</td>\n",
       "      <td>73.68</td>\n",
       "      <td>50.00</td>\n",
       "      <td>Case</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>S03390100006</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4571</td>\n",
       "      <td>Casey's General</td>\n",
       "      <td>100, CHERRY ST</td>\n",
       "      <td>ALLISON</td>\n",
       "      <td>50602</td>\n",
       "      <td>POINT (-92.790457 42.745202)</td>\n",
       "      <td>12</td>\n",
       "      <td>butler</td>\n",
       "      <td>1011300</td>\n",
       "      <td>TENNESSEE WHISKIES</td>\n",
       "      <td>85</td>\n",
       "      <td>Brown-Forman Corporation</td>\n",
       "      <td>26826</td>\n",
       "      <td>Jack Daniels Old #7 Black Lbl</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>13.01</td>\n",
       "      <td>19.51</td>\n",
       "      <td>12.0</td>\n",
       "      <td>234.12</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>6.50</td>\n",
       "      <td>78.00</td>\n",
       "      <td>156.12</td>\n",
       "      <td>49.96</td>\n",
       "      <td>Case</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>S03388900003</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4540</td>\n",
       "      <td>Casey's General</td>\n",
       "      <td>1104 N RIVERVIEW ST</td>\n",
       "      <td>BELLEVUE</td>\n",
       "      <td>52031</td>\n",
       "      <td>POINT (-90.427844 42.268432)</td>\n",
       "      <td>49</td>\n",
       "      <td>jackson</td>\n",
       "      <td>1062200</td>\n",
       "      <td>PUERTO RICO &amp; VIRGIN ISLANDS RUM</td>\n",
       "      <td>35</td>\n",
       "      <td>Bacardi U.S.A., Inc.</td>\n",
       "      <td>43126</td>\n",
       "      <td>Bacardi Superior Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>7.53</td>\n",
       "      <td>11.30</td>\n",
       "      <td>12.0</td>\n",
       "      <td>135.60</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.77</td>\n",
       "      <td>45.24</td>\n",
       "      <td>90.36</td>\n",
       "      <td>50.07</td>\n",
       "      <td>Case</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>S03338000002</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4590</td>\n",
       "      <td>Casey's General</td>\n",
       "      <td>601, MAIN ST</td>\n",
       "      <td>CEDAR FALLS</td>\n",
       "      <td>50613</td>\n",
       "      <td>POINT (-92.445512 42.532963)</td>\n",
       "      <td>7</td>\n",
       "      <td>black hawk</td>\n",
       "      <td>1062300</td>\n",
       "      <td>FLAVORED RUM</td>\n",
       "      <td>370</td>\n",
       "      <td>Pernod Ricard USA/Austin Nichols</td>\n",
       "      <td>42716</td>\n",
       "      <td>Malibu Coconut Rum</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>6.90</td>\n",
       "      <td>10.35</td>\n",
       "      <td>12.0</td>\n",
       "      <td>124.20</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.45</td>\n",
       "      <td>41.40</td>\n",
       "      <td>82.80</td>\n",
       "      <td>50.00</td>\n",
       "      <td>Case</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>S03398300010</td>\n",
       "      <td>2012-01-03</td>\n",
       "      <td>4543</td>\n",
       "      <td>Casey's General</td>\n",
       "      <td>1100 EAGLE VIEW DR</td>\n",
       "      <td>MARION</td>\n",
       "      <td>52302</td>\n",
       "      <td>POINT (-91.553462 42.037621)</td>\n",
       "      <td>57</td>\n",
       "      <td>linn</td>\n",
       "      <td>1011100</td>\n",
       "      <td>BLENDED WHISKIES</td>\n",
       "      <td>260</td>\n",
       "      <td>Diageo Americas</td>\n",
       "      <td>25606</td>\n",
       "      <td>Seagrams 7 Crown Bl Whiskey</td>\n",
       "      <td>12</td>\n",
       "      <td>750.0</td>\n",
       "      <td>6.14</td>\n",
       "      <td>9.21</td>\n",
       "      <td>6.0</td>\n",
       "      <td>55.26</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1.19</td>\n",
       "      <td>2012-01-02/2012-01-08</td>\n",
       "      <td>2012-01</td>\n",
       "      <td>2012Q1</td>\n",
       "      <td>2012</td>\n",
       "      <td>3.07</td>\n",
       "      <td>18.42</td>\n",
       "      <td>36.84</td>\n",
       "      <td>50.00</td>\n",
       "      <td>Case</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Invoice/Item Number       Date  Store Number       Store Name  \\\n",
       "0        S03392200005 2012-01-03          4578  Casey's General   \n",
       "1        S03390100006 2012-01-03          4571  Casey's General   \n",
       "2        S03388900003 2012-01-03          4540  Casey's General   \n",
       "3        S03338000002 2012-01-03          4590  Casey's General   \n",
       "4        S03398300010 2012-01-03          4543  Casey's General   \n",
       "\n",
       "               Address         City Zip Code                Store Location  \\\n",
       "0         201 S 4TH ST   FARMINGTON    52626  POINT (-91.740069 40.639743)   \n",
       "1       100, CHERRY ST      ALLISON    50602  POINT (-92.790457 42.745202)   \n",
       "2  1104 N RIVERVIEW ST     BELLEVUE    52031  POINT (-90.427844 42.268432)   \n",
       "3         601, MAIN ST  CEDAR FALLS    50613  POINT (-92.445512 42.532963)   \n",
       "4   1100 EAGLE VIEW DR       MARION    52302  POINT (-91.553462 42.037621)   \n",
       "\n",
       "  County Number      County Category                     Category Name  \\\n",
       "0            89   van buren  1011100                  BLENDED WHISKIES   \n",
       "1            12      butler  1011300                TENNESSEE WHISKIES   \n",
       "2            49     jackson  1062200  PUERTO RICO & VIRGIN ISLANDS RUM   \n",
       "3             7  black hawk  1062300                      FLAVORED RUM   \n",
       "4            57        linn  1011100                  BLENDED WHISKIES   \n",
       "\n",
       "  Vendor Number                       Vendor Name Item Number  \\\n",
       "0           260                   Diageo Americas       25606   \n",
       "1            85          Brown-Forman Corporation       26826   \n",
       "2            35              Bacardi U.S.A., Inc.       43126   \n",
       "3           370  Pernod Ricard USA/Austin Nichols       42716   \n",
       "4           260                   Diageo Americas       25606   \n",
       "\n",
       "                Item Description  Pack  Bottle Volume (ml)  State Bottle Cost  \\\n",
       "0    Seagrams 7 Crown Bl Whiskey    12               750.0               6.14   \n",
       "1  Jack Daniels Old #7 Black Lbl    12               750.0              13.01   \n",
       "2           Bacardi Superior Rum    12               750.0               7.53   \n",
       "3             Malibu Coconut Rum    12               750.0               6.90   \n",
       "4    Seagrams 7 Crown Bl Whiskey    12               750.0               6.14   \n",
       "\n",
       "   State Bottle Retail  Bottles Sold  Sale (Dollars)  Volume Sold (Liters)  \\\n",
       "0                 9.21          12.0          110.52                   9.0   \n",
       "1                19.51          12.0          234.12                   9.0   \n",
       "2                11.30          12.0          135.60                   9.0   \n",
       "3                10.35          12.0          124.20                   9.0   \n",
       "4                 9.21           6.0           55.26                   4.5   \n",
       "\n",
       "   Volume Sold (Gallons)              Year_Week Year_Month Year_Quarter  Year  \\\n",
       "0                   2.38  2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "1                   2.38  2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "2                   2.38  2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "3                   2.38  2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "4                   1.19  2012-01-02/2012-01-08    2012-01       2012Q1  2012   \n",
       "\n",
       "   Markup Per Bottle  Markup Per Transaction  Cost Per Transaction  \\\n",
       "0               3.07                   36.84                 73.68   \n",
       "1               6.50                   78.00                156.12   \n",
       "2               3.77                   45.24                 90.36   \n",
       "3               3.45                   41.40                 82.80   \n",
       "4               3.07                   18.42                 36.84   \n",
       "\n",
       "   Markup Rate Per Item Shortened Store Name  \n",
       "0                 50.00                 Case  \n",
       "1                 49.96                 Case  \n",
       "2                 50.07                 Case  \n",
       "3                 50.00                 Case  \n",
       "4                 50.00                 Case  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "top_15_stores_df_master.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Markup Sum Per Category</th>\n",
       "      <th>Cost Sum Per Category</th>\n",
       "      <th>Markup Rate Per Category</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Category Name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>BARBADOS RUM</th>\n",
       "      <td>1.963394e+05</td>\n",
       "      <td>3.827781e+05</td>\n",
       "      <td>0.512933</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CANADIAN WHISKIES</th>\n",
       "      <td>3.048818e+07</td>\n",
       "      <td>5.977943e+07</td>\n",
       "      <td>0.510011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AMERICAN COCKTAILS</th>\n",
       "      <td>5.586111e+06</td>\n",
       "      <td>1.096828e+07</td>\n",
       "      <td>0.509297</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IMPORTED AMARETTO</th>\n",
       "      <td>3.751023e+05</td>\n",
       "      <td>7.377251e+05</td>\n",
       "      <td>0.508458</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>VODKA FLAVORED</th>\n",
       "      <td>8.076453e+06</td>\n",
       "      <td>1.590139e+07</td>\n",
       "      <td>0.507908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>COFFEE LIQUEURS</th>\n",
       "      <td>1.807509e+06</td>\n",
       "      <td>3.564177e+06</td>\n",
       "      <td>0.507132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROOT BEER SCHNAPPS</th>\n",
       "      <td>1.345662e+05</td>\n",
       "      <td>2.654411e+05</td>\n",
       "      <td>0.506953</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PUERTO RICO &amp; VIRGIN ISLANDS RUM</th>\n",
       "      <td>8.363053e+06</td>\n",
       "      <td>1.651862e+07</td>\n",
       "      <td>0.506280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>STRAWBERRY SCHNAPPS</th>\n",
       "      <td>1.077392e+05</td>\n",
       "      <td>2.131052e+05</td>\n",
       "      <td>0.505568</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FLAVORED RUM</th>\n",
       "      <td>5.553428e+06</td>\n",
       "      <td>1.099300e+07</td>\n",
       "      <td>0.505179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bottled in Bond Bourbon</th>\n",
       "      <td>5.349613e+04</td>\n",
       "      <td>1.069919e+05</td>\n",
       "      <td>0.500002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Iowa Distillery Whiskies</th>\n",
       "      <td>2.519824e+04</td>\n",
       "      <td>5.039647e+04</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>American Distilled Spirits Specialty</th>\n",
       "      <td>2.402650e+03</td>\n",
       "      <td>4.805300e+03</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SCHNAPPS - IMPORTED</th>\n",
       "      <td>2.276160e+03</td>\n",
       "      <td>4.552320e+03</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AMERICAN SLOE GINS</th>\n",
       "      <td>4.109479e+04</td>\n",
       "      <td>8.219196e+04</td>\n",
       "      <td>0.499986</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROCK &amp; RYE</th>\n",
       "      <td>1.968206e+04</td>\n",
       "      <td>3.937480e+04</td>\n",
       "      <td>0.499864</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WHITE CREME DE MENTHE</th>\n",
       "      <td>1.491669e+04</td>\n",
       "      <td>2.984162e+04</td>\n",
       "      <td>0.499862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CREME DE ALMOND</th>\n",
       "      <td>7.839310e+03</td>\n",
       "      <td>1.568508e+04</td>\n",
       "      <td>0.499794</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TRIPLE SEC</th>\n",
       "      <td>6.419650e+05</td>\n",
       "      <td>1.284620e+06</td>\n",
       "      <td>0.499732</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HIGH PROOF BEER - AMERICAN</th>\n",
       "      <td>1.012280e+03</td>\n",
       "      <td>2.595440e+03</td>\n",
       "      <td>0.390023</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>129 rows  3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      Markup Sum Per Category  \\\n",
       "Category Name                                                   \n",
       "BARBADOS RUM                                     1.963394e+05   \n",
       "CANADIAN WHISKIES                                3.048818e+07   \n",
       "AMERICAN COCKTAILS                               5.586111e+06   \n",
       "IMPORTED AMARETTO                                3.751023e+05   \n",
       "VODKA FLAVORED                                   8.076453e+06   \n",
       "COFFEE LIQUEURS                                  1.807509e+06   \n",
       "ROOT BEER SCHNAPPS                               1.345662e+05   \n",
       "PUERTO RICO & VIRGIN ISLANDS RUM                 8.363053e+06   \n",
       "STRAWBERRY SCHNAPPS                              1.077392e+05   \n",
       "FLAVORED RUM                                     5.553428e+06   \n",
       "...                                                       ...   \n",
       "Bottled in Bond Bourbon                          5.349613e+04   \n",
       "Iowa Distillery Whiskies                         2.519824e+04   \n",
       "American Distilled Spirits Specialty             2.402650e+03   \n",
       "SCHNAPPS - IMPORTED                              2.276160e+03   \n",
       "AMERICAN SLOE GINS                               4.109479e+04   \n",
       "ROCK & RYE                                       1.968206e+04   \n",
       "WHITE CREME DE MENTHE                            1.491669e+04   \n",
       "CREME DE ALMOND                                  7.839310e+03   \n",
       "TRIPLE SEC                                       6.419650e+05   \n",
       "HIGH PROOF BEER - AMERICAN                       1.012280e+03   \n",
       "\n",
       "                                      Cost Sum Per Category  \\\n",
       "Category Name                                                 \n",
       "BARBADOS RUM                                   3.827781e+05   \n",
       "CANADIAN WHISKIES                              5.977943e+07   \n",
       "AMERICAN COCKTAILS                             1.096828e+07   \n",
       "IMPORTED AMARETTO                              7.377251e+05   \n",
       "VODKA FLAVORED                                 1.590139e+07   \n",
       "COFFEE LIQUEURS                                3.564177e+06   \n",
       "ROOT BEER SCHNAPPS                             2.654411e+05   \n",
       "PUERTO RICO & VIRGIN ISLANDS RUM               1.651862e+07   \n",
       "STRAWBERRY SCHNAPPS                            2.131052e+05   \n",
       "FLAVORED RUM                                   1.099300e+07   \n",
       "...                                                     ...   \n",
       "Bottled in Bond Bourbon                        1.069919e+05   \n",
       "Iowa Distillery Whiskies                       5.039647e+04   \n",
       "American Distilled Spirits Specialty           4.805300e+03   \n",
       "SCHNAPPS - IMPORTED                            4.552320e+03   \n",
       "AMERICAN SLOE GINS                             8.219196e+04   \n",
       "ROCK & RYE                                     3.937480e+04   \n",
       "WHITE CREME DE MENTHE                          2.984162e+04   \n",
       "CREME DE ALMOND                                1.568508e+04   \n",
       "TRIPLE SEC                                     1.284620e+06   \n",
       "HIGH PROOF BEER - AMERICAN                     2.595440e+03   \n",
       "\n",
       "                                      Markup Rate Per Category  \n",
       "Category Name                                                   \n",
       "BARBADOS RUM                                          0.512933  \n",
       "CANADIAN WHISKIES                                     0.510011  \n",
       "AMERICAN COCKTAILS                                    0.509297  \n",
       "IMPORTED AMARETTO                                     0.508458  \n",
       "VODKA FLAVORED                                        0.507908  \n",
       "COFFEE LIQUEURS                                       0.507132  \n",
       "ROOT BEER SCHNAPPS                                    0.506953  \n",
       "PUERTO RICO & VIRGIN ISLANDS RUM                      0.506280  \n",
       "STRAWBERRY SCHNAPPS                                   0.505568  \n",
       "FLAVORED RUM                                          0.505179  \n",
       "...                                                        ...  \n",
       "Bottled in Bond Bourbon                               0.500002  \n",
       "Iowa Distillery Whiskies                              0.500000  \n",
       "American Distilled Spirits Specialty                  0.500000  \n",
       "SCHNAPPS - IMPORTED                                   0.500000  \n",
       "AMERICAN SLOE GINS                                    0.499986  \n",
       "ROCK & RYE                                            0.499864  \n",
       "WHITE CREME DE MENTHE                                 0.499862  \n",
       "CREME DE ALMOND                                       0.499794  \n",
       "TRIPLE SEC                                            0.499732  \n",
       "HIGH PROOF BEER - AMERICAN                            0.390023  \n",
       "\n",
       "[129 rows x 3 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# so from the results we can see that the top categories with highest markup rates (at category level)\n",
    "# are barbados rum, american cocktails, vodka flavored, imported amaretto, root beer schnapps, strawberry schnapps,\n",
    "# flavored rum, puerto rico&virgin islands rum, canadian whiskies\n",
    "df_markup = top_15_stores_df_master.groupby(['Category Name']).agg({'Markup Per Transaction':'sum','Cost Per Transaction':'sum'})\n",
    "df_markup = df_markup.rename(columns={'Markup Per Transaction': 'Markup Sum Per Category', 'Cost Per Transaction': 'Cost Sum Per Category'})\n",
    "df_markup['Markup Rate Per Category'] = df_markup['Markup Sum Per Category']/df_markup['Cost Sum Per Category']\n",
    "df_markup.sort_values(by='Markup Rate Per Category', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
